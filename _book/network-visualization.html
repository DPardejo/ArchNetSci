<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 6 Network Visualization | Online Companion to Archaeological Network Science by Brughmans and Peeples</title>
  <meta name="description" content="<p>This bookdown document accompanies the Cambridge Manuals in Archaeology book
<em>Archaeological Network Science</em> by Tom Brughmans and Matthew A. Peeples.</p>" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 6 Network Visualization | Online Companion to Archaeological Network Science by Brughmans and Peeples" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://archnetworks.net" />
  
  <meta property="og:description" content="<p>This bookdown document accompanies the Cambridge Manuals in Archaeology book
<em>Archaeological Network Science</em> by Tom Brughmans and Matthew A. Peeples.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 6 Network Visualization | Online Companion to Archaeological Network Science by Brughmans and Peeples" />
  
  <meta name="twitter:description" content="<p>This bookdown document accompanies the Cambridge Manuals in Archaeology book
<em>Archaeological Network Science</em> by Tom Brughmans and Matthew A. Peeples.</p>" />
  

<meta name="author" content="Matthew A. Peeples and Tom Brughmans" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="quantifying-uncertainty.html"/>
<link rel="next" href="spatial-networks.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/d3-4.5.0/d3.min.js"></script>
<script src="libs/forceNetwork-binding-0.4/forceNetwork.js"></script>
<link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet" />
<script src="libs/vis-9.1.0/vis-network.min.js"></script>
<script src="libs/visNetwork-binding-2.1.0/visNetwork.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Archaeological Network Science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome</a></li>
<li class="chapter" data-level="2" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>2</b> Getting Started</a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started.html"><a href="getting-started.html#datasets"><i class="fa fa-check"></i><b>2.1</b> Datasets</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="getting-started.html"><a href="getting-started.html#Everything"><i class="fa fa-check"></i><b>2.1.1</b> Just Give Me Everything</a></li>
<li class="chapter" data-level="2.1.2" data-path="getting-started.html"><a href="getting-started.html#roman-road-networks"><i class="fa fa-check"></i><b>2.1.2</b> Roman Road Networks</a></li>
<li class="chapter" data-level="2.1.3" data-path="getting-started.html"><a href="getting-started.html#southwest-social-networks-project-ceramic-similarity-networks"><i class="fa fa-check"></i><b>2.1.3</b> Southwest Social Networks Project Ceramic Similarity Networks</a></li>
<li class="chapter" data-level="2.1.4" data-path="getting-started.html"><a href="getting-started.html#cibola-region-technological-similarity-network"><i class="fa fa-check"></i><b>2.1.4</b> Cibola Region Technological Similarity Network</a></li>
<li class="chapter" data-level="2.1.5" data-path="getting-started.html"><a href="getting-started.html#himalayan-visibility-networks"><i class="fa fa-check"></i><b>2.1.5</b> Himalayan Visibility Networks</a></li>
<li class="chapter" data-level="2.1.6" data-path="getting-started.html"><a href="getting-started.html#archaeological-publication-networks"><i class="fa fa-check"></i><b>2.1.6</b> Archaeological Publication Networks</a></li>
<li class="chapter" data-level="2.1.7" data-path="getting-started.html"><a href="getting-started.html#iron-age-sites-in-southern-spain"><i class="fa fa-check"></i><b>2.1.7</b> Iron Age Sites in Southern Spain</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="getting-started.html"><a href="getting-started.html#importing-data-in-r"><i class="fa fa-check"></i><b>2.2</b> Importing Data in R</a></li>
<li class="chapter" data-level="2.3" data-path="getting-started.html"><a href="getting-started.html#installing-r-packages"><i class="fa fa-check"></i><b>2.3</b> Installing R Packages</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started.html"><a href="getting-started.html#suggested-workspace-setup"><i class="fa fa-check"></i><b>2.4</b> Suggested Workspace Setup</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="NetworkData.html"><a href="NetworkData.html"><i class="fa fa-check"></i><b>3</b> Network Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="NetworkData.html"><a href="NetworkData.html#network-data-formats"><i class="fa fa-check"></i><b>3.1</b> Network Data Formats</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="NetworkData.html"><a href="NetworkData.html#Edgelist"><i class="fa fa-check"></i><b>3.1.1</b> Edge List</a></li>
<li class="chapter" data-level="3.1.2" data-path="NetworkData.html"><a href="NetworkData.html#adjacency-list"><i class="fa fa-check"></i><b>3.1.2</b> Adjacency List</a></li>
<li class="chapter" data-level="3.1.3" data-path="NetworkData.html"><a href="NetworkData.html#adjacency-matrix"><i class="fa fa-check"></i><b>3.1.3</b> Adjacency Matrix</a></li>
<li class="chapter" data-level="3.1.4" data-path="NetworkData.html"><a href="NetworkData.html#incidence-matrix"><i class="fa fa-check"></i><b>3.1.4</b> Incidence Matrix</a></li>
<li class="chapter" data-level="3.1.5" data-path="NetworkData.html"><a href="NetworkData.html#node-and-edge-information"><i class="fa fa-check"></i><b>3.1.5</b> Node and Edge Information</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="NetworkData.html"><a href="NetworkData.html#types-of-networks"><i class="fa fa-check"></i><b>3.2</b> Types of Networks</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="NetworkData.html"><a href="NetworkData.html#simple-networks"><i class="fa fa-check"></i><b>3.2.1</b> Simple Networks</a></li>
<li class="chapter" data-level="3.2.2" data-path="NetworkData.html"><a href="NetworkData.html#directed-networks"><i class="fa fa-check"></i><b>3.2.2</b> Directed Networks</a></li>
<li class="chapter" data-level="3.2.3" data-path="NetworkData.html"><a href="NetworkData.html#signed-categorized-and-valued-networks"><i class="fa fa-check"></i><b>3.2.3</b> Signed, Categorized, and Valued Networks</a></li>
<li class="chapter" data-level="3.2.4" data-path="NetworkData.html"><a href="NetworkData.html#two-mode-networks-and-affiliation-networks"><i class="fa fa-check"></i><b>3.2.4</b> Two-mode Networks and Affiliation Networks</a></li>
<li class="chapter" data-level="3.2.5" data-path="NetworkData.html"><a href="NetworkData.html#similarity-networks"><i class="fa fa-check"></i><b>3.2.5</b> Similarity Networks</a></li>
<li class="chapter" data-level="3.2.6" data-path="NetworkData.html"><a href="NetworkData.html#ego-networks"><i class="fa fa-check"></i><b>3.2.6</b> Ego Networks</a></li>
<li class="chapter" data-level="3.2.7" data-path="NetworkData.html"><a href="NetworkData.html#multilayer-networks"><i class="fa fa-check"></i><b>3.2.7</b> Multilayer Networks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html"><i class="fa fa-check"></i><b>4</b> Exploratory Network Analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#example-network-objects"><i class="fa fa-check"></i><b>4.1</b> Example Network Objects</a></li>
<li class="chapter" data-level="4.2" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#CalcMetric"><i class="fa fa-check"></i><b>4.2</b> Calculating Network Metrics in R</a></li>
<li class="chapter" data-level="4.3" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#centrality"><i class="fa fa-check"></i><b>4.3</b> Centrality</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#degree-centrality"><i class="fa fa-check"></i><b>4.3.1</b> Degree Centrality</a></li>
<li class="chapter" data-level="4.3.2" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#betweenness-centrality"><i class="fa fa-check"></i><b>4.3.2</b> Betweenness Centrality</a></li>
<li class="chapter" data-level="4.3.3" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#eigenvector-centrality"><i class="fa fa-check"></i><b>4.3.3</b> Eigenvector Centrality</a></li>
<li class="chapter" data-level="4.3.4" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#page-rank-centrality"><i class="fa fa-check"></i><b>4.3.4</b> Page Rank Centrality</a></li>
<li class="chapter" data-level="4.3.5" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#closeness-centrality"><i class="fa fa-check"></i><b>4.3.5</b> Closeness Centrality</a></li>
<li class="chapter" data-level="4.3.6" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#hubs-and-authorities"><i class="fa fa-check"></i><b>4.3.6</b> Hubs and Authorities</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#triads-and-clustering"><i class="fa fa-check"></i><b>4.4</b> Triads and clustering</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#triads"><i class="fa fa-check"></i><b>4.4.1</b> Triads</a></li>
<li class="chapter" data-level="4.4.2" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#transitivity-and-clustering"><i class="fa fa-check"></i><b>4.4.2</b> Transitivity and Clustering</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#walks-paths-and-distance"><i class="fa fa-check"></i><b>4.5</b> Walks, Paths, and Distance</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#distance"><i class="fa fa-check"></i><b>4.5.1</b> Distance</a></li>
<li class="chapter" data-level="4.5.2" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#shortest-paths"><i class="fa fa-check"></i><b>4.5.2</b> Shortest Paths</a></li>
<li class="chapter" data-level="4.5.3" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#diameter"><i class="fa fa-check"></i><b>4.5.3</b> Diameter</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#components-and-bridges"><i class="fa fa-check"></i><b>4.6</b> Components and Bridges</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#identifying-components"><i class="fa fa-check"></i><b>4.6.1</b> Identifying Components</a></li>
<li class="chapter" data-level="4.6.2" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#cutpoints"><i class="fa fa-check"></i><b>4.6.2</b> Cutpoints</a></li>
<li class="chapter" data-level="4.6.3" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#bridges"><i class="fa fa-check"></i><b>4.6.3</b> Bridges</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#cliques-and-communities"><i class="fa fa-check"></i><b>4.7</b> Cliques and Communities</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#cliques"><i class="fa fa-check"></i><b>4.7.1</b> Cliques</a></li>
<li class="chapter" data-level="4.7.2" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#k-cores"><i class="fa fa-check"></i><b>4.7.2</b> K-cores</a></li>
<li class="chapter" data-level="4.7.3" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#cluster-detection-algorithms"><i class="fa fa-check"></i><b>4.7.3</b> Cluster Detection Algorithms</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#case-study"><i class="fa fa-check"></i><b>4.8</b> Case Study</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="quantifying-uncertainty.html"><a href="quantifying-uncertainty.html"><i class="fa fa-check"></i><b>5</b> Quantifying Uncertainty</a>
<ul>
<li class="chapter" data-level="5.1" data-path="quantifying-uncertainty.html"><a href="quantifying-uncertainty.html#a-general-approach-to-uncertainty"><i class="fa fa-check"></i><b>5.1</b> A General Approach to Uncertainty</a></li>
<li class="chapter" data-level="5.2" data-path="quantifying-uncertainty.html"><a href="quantifying-uncertainty.html#missing-at-random"><i class="fa fa-check"></i><b>5.2</b> Missing at Random</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="quantifying-uncertainty.html"><a href="quantifying-uncertainty.html#nodes-missing-at-random"><i class="fa fa-check"></i><b>5.2.1</b> Nodes Missing at Random</a></li>
<li class="chapter" data-level="5.2.2" data-path="quantifying-uncertainty.html"><a href="quantifying-uncertainty.html#edges-missing-at-random"><i class="fa fa-check"></i><b>5.2.2</b> Edges Missing at Random</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="quantifying-uncertainty.html"><a href="quantifying-uncertainty.html#assessing-indivdiual-nodesedges"><i class="fa fa-check"></i><b>5.3</b> Assessing Indivdiual Nodes/Edges</a></li>
<li class="chapter" data-level="5.4" data-path="quantifying-uncertainty.html"><a href="quantifying-uncertainty.html#missing-due-to-biased-sampling"><i class="fa fa-check"></i><b>5.4</b> Missing Due to Biased Sampling</a></li>
<li class="chapter" data-level="5.5" data-path="quantifying-uncertainty.html"><a href="quantifying-uncertainty.html#edge-probability-modeling"><i class="fa fa-check"></i><b>5.5</b> Edge Probability Modeling</a></li>
<li class="chapter" data-level="5.6" data-path="quantifying-uncertainty.html"><a href="quantifying-uncertainty.html#small-or-variable-sample-size"><i class="fa fa-check"></i><b>5.6</b> Small or Variable Sample Size</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="network-visualization.html"><a href="network-visualization.html"><i class="fa fa-check"></i><b>6</b> Network Visualization</a>
<ul>
<li class="chapter" data-level="6.1" data-path="network-visualization.html"><a href="network-visualization.html#datasets-and-r-setup"><i class="fa fa-check"></i><b>6.1</b> Datasets and R Setup</a></li>
<li class="chapter" data-level="6.2" data-path="network-visualization.html"><a href="network-visualization.html#visualizing-networks-in-r"><i class="fa fa-check"></i><b>6.2</b> Visualizing Networks in R</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="network-visualization.html"><a href="network-visualization.html#networkstatnet"><i class="fa fa-check"></i><b>6.2.1</b> network/statnet</a></li>
<li class="chapter" data-level="6.2.2" data-path="network-visualization.html"><a href="network-visualization.html#igraph"><i class="fa fa-check"></i><b>6.2.2</b> igraph</a></li>
<li class="chapter" data-level="6.2.3" data-path="network-visualization.html"><a href="network-visualization.html#ggraph"><i class="fa fa-check"></i><b>6.2.3</b> ggraph</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="network-visualization.html"><a href="network-visualization.html#network-visualization-options"><i class="fa fa-check"></i><b>6.3</b> Network Visualization Options</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="network-visualization.html"><a href="network-visualization.html#graph-layout"><i class="fa fa-check"></i><b>6.3.1</b> Graph Layout</a></li>
<li class="chapter" data-level="6.3.2" data-path="network-visualization.html"><a href="network-visualization.html#node-and-edge-options"><i class="fa fa-check"></i><b>6.3.2</b> Node and Edge Options</a></li>
<li class="chapter" data-level="6.3.3" data-path="network-visualization.html"><a href="network-visualization.html#label-options"><i class="fa fa-check"></i><b>6.3.3</b> Label Options</a></li>
<li class="chapter" data-level="6.3.4" data-path="network-visualization.html"><a href="network-visualization.html#be-kind-to-the-color-blind"><i class="fa fa-check"></i><b>6.3.4</b> Be Kind to the Color Blind</a></li>
<li class="chapter" data-level="6.3.5" data-path="network-visualization.html"><a href="network-visualization.html#communities-and-groups"><i class="fa fa-check"></i><b>6.3.5</b> Communities and Groups</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="network-visualization.html"><a href="network-visualization.html#replicating-the-book-figures"><i class="fa fa-check"></i><b>6.4</b> Replicating the Book Figures</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_1"><i class="fa fa-check"></i><b>6.4.1</b> Figure 6.1: Manual Layout</a></li>
<li class="chapter" data-level="6.4.2" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_2"><i class="fa fa-check"></i><b>6.4.2</b> Figure 6.2: Examples of Common Network Plot Formats</a></li>
<li class="chapter" data-level="6.4.3" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_3"><i class="fa fa-check"></i><b>6.4.3</b> Figure 6.3: Examples of Rare Network Plot Formats</a></li>
<li class="chapter" data-level="6.4.4" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_4"><i class="fa fa-check"></i><b>6.4.4</b> Figure 6.4: Simple Network with Clusters</a></li>
<li class="chapter" data-level="6.4.5" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_5"><i class="fa fa-check"></i><b>6.4.5</b> Figure 6.5: Interactive Layout</a></li>
<li class="chapter" data-level="6.4.6" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_6"><i class="fa fa-check"></i><b>6.4.6</b> Figure 6.6: Absolute Geographic Layout</a></li>
<li class="chapter" data-level="6.4.7" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_7"><i class="fa fa-check"></i><b>6.4.7</b> Figure 6.7: Distorted Geographic Layout</a></li>
<li class="chapter" data-level="6.4.8" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_8"><i class="fa fa-check"></i><b>6.4.8</b> Figure 6.8: Graph Layout Algorithms</a></li>
<li class="chapter" data-level="6.4.9" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_9"><i class="fa fa-check"></i><b>6.4.9</b> Figure 6.9: Heirarchical Graph Layouts</a></li>
<li class="chapter" data-level="6.4.10" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_10"><i class="fa fa-check"></i><b>6.4.10</b> Figure 6.10: Be kind to the color blind</a></li>
<li class="chapter" data-level="6.4.11" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_11"><i class="fa fa-check"></i><b>6.4.11</b> Figure 6.11: Node Symbol and Color Schemes</a></li>
<li class="chapter" data-level="6.4.12" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_12"><i class="fa fa-check"></i><b>6.4.12</b> Figure 6.12: Image for Node</a></li>
<li class="chapter" data-level="6.4.13" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_13"><i class="fa fa-check"></i><b>6.4.13</b> Figure 6.13: Images for Nodes</a></li>
<li class="chapter" data-level="6.4.14" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_14"><i class="fa fa-check"></i><b>6.4.14</b> Figure 6.14: Edge Thickness and Color</a></li>
<li class="chapter" data-level="6.4.15" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_15"><i class="fa fa-check"></i><b>6.4.15</b> Figure 6.15: Edge Direction</a></li>
<li class="chapter" data-level="6.4.16" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_16"><i class="fa fa-check"></i><b>6.4.16</b> Figure 6.16: Edge Binarization</a></li>
<li class="chapter" data-level="6.4.17" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_17"><i class="fa fa-check"></i><b>6.4.17</b> Figure 6.17: Edge Bundling</a></li>
<li class="chapter" data-level="6.4.18" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_18"><i class="fa fa-check"></i><b>6.4.18</b> Figure 6.18: Group-in-a-box</a></li>
<li class="chapter" data-level="6.4.19" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_19"><i class="fa fa-check"></i><b>6.4.19</b> Figure 6.19: Weighted Adjacency Matrix</a></li>
<li class="chapter" data-level="6.4.20" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_20"><i class="fa fa-check"></i><b>6.4.20</b> Figure 6.20: Nodetrix Diagram</a></li>
<li class="chapter" data-level="6.4.21" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_21"><i class="fa fa-check"></i><b>6.4.21</b> Figure 6.21: The Filmstrip Approach</a></li>
<li class="chapter" data-level="6.4.22" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_22"><i class="fa fa-check"></i><b>6.4.22</b> Figure 6.22: Similtaneous Display</a></li>
<li class="chapter" data-level="6.4.23" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_23"><i class="fa fa-check"></i><b>6.4.23</b> Figure 6:23: Timelines and Time Prisms</a></li>
<li class="chapter" data-level="6.4.24" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_24"><i class="fa fa-check"></i><b>6.4.24</b> Figure 6.24: Animation</a></li>
<li class="chapter" data-level="6.4.25" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_25"><i class="fa fa-check"></i><b>6.4.25</b> Figure 6.25: Interactive Networks</a></li>
<li class="chapter" data-level="6.4.26" data-path="network-visualization.html"><a href="network-visualization.html#figure-6.26-swsn-example-1"><i class="fa fa-check"></i><b>6.4.26</b> Figure 6.26: SWSN Example 1</a></li>
<li class="chapter" data-level="6.4.27" data-path="network-visualization.html"><a href="network-visualization.html#figure-6.27-swsn-example-2"><i class="fa fa-check"></i><b>6.4.27</b> Figure 6.27: SWSN Example 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="spatial-networks.html"><a href="spatial-networks.html"><i class="fa fa-check"></i><b>7</b> Spatial Networks</a>
<ul>
<li class="chapter" data-level="7.1" data-path="spatial-networks.html"><a href="spatial-networks.html#dataset-and-setup"><i class="fa fa-check"></i><b>7.1</b> Dataset and Setup</a></li>
<li class="chapter" data-level="7.2" data-path="spatial-networks.html"><a href="spatial-networks.html#planar-networks-and-trees"><i class="fa fa-check"></i><b>7.2</b> Planar Networks and Trees</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="spatial-networks.html"><a href="spatial-networks.html#evaluating-planarity"><i class="fa fa-check"></i><b>7.2.1</b> Evaluating Planarity</a></li>
<li class="chapter" data-level="7.2.2" data-path="spatial-networks.html"><a href="spatial-networks.html#defining-trees"><i class="fa fa-check"></i><b>7.2.2</b> Defining Trees</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="spatial-networks.html"><a href="spatial-networks.html#spatial-network-models"><i class="fa fa-check"></i><b>7.3</b> Spatial Network Models</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="spatial-networks.html"><a href="spatial-networks.html#relative-neighborhood-networks"><i class="fa fa-check"></i><b>7.3.1</b> Relative Neighborhood Networks</a></li>
<li class="chapter" data-level="7.3.2" data-path="spatial-networks.html"><a href="spatial-networks.html#gabriel-graphs"><i class="fa fa-check"></i><b>7.3.2</b> Gabriel Graphs</a></li>
<li class="chapter" data-level="7.3.3" data-path="spatial-networks.html"><a href="spatial-networks.html#beta-skeletons"><i class="fa fa-check"></i><b>7.3.3</b> Beta Skeletons</a></li>
<li class="chapter" data-level="7.3.4" data-path="spatial-networks.html"><a href="spatial-networks.html#minimum-spanning-trees"><i class="fa fa-check"></i><b>7.3.4</b> Minimum Spanning Trees</a></li>
<li class="chapter" data-level="7.3.5" data-path="spatial-networks.html"><a href="spatial-networks.html#delaunay-triangulation"><i class="fa fa-check"></i><b>7.3.5</b> Delaunay Triangulation</a></li>
<li class="chapter" data-level="7.3.6" data-path="spatial-networks.html"><a href="spatial-networks.html#k-nearest-neighbors"><i class="fa fa-check"></i><b>7.3.6</b> K-nearest Neighbors</a></li>
<li class="chapter" data-level="7.3.7" data-path="spatial-networks.html"><a href="spatial-networks.html#maximum-distance-networks"><i class="fa fa-check"></i><b>7.3.7</b> Maximum Distance Networks</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="spatial-networks.html"><a href="spatial-networks.html#case-studies"><i class="fa fa-check"></i><b>7.4</b> Case Studies</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="spatial-networks.html"><a href="spatial-networks.html#proximity-of-iron-age-sites-in-southern-spain"><i class="fa fa-check"></i><b>7.4.1</b> Proximity of Iron Age sites in Southern Spain</a></li>
<li class="chapter" data-level="7.4.2" data-path="spatial-networks.html"><a href="spatial-networks.html#networks-in-space-in-the-u.s.-southwest"><i class="fa fa-check"></i><b>7.4.2</b> Networks in Space in the U.S. Southwest</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-and-r-packages.html"><a href="references-and-r-packages.html"><i class="fa fa-check"></i>References and R Packages</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Online Companion to <em>Archaeological Network Science</em> by Brughmans and Peeples</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="network-visualization" class="section level1" number="6">
<h1><span class="header-section-number">Section 6</span> Network Visualization</h1>
<p>This section follows along with Brughmans and Peeples (2022) chapter 6 to illustrate the wide variety of techniques which can be used for network visualization. We begin with some general examples of network plotting and then demonstrate how to replicate all of the specific examples that appear in the book. For most of the examples below we rely on R but in a few cases we use other software and provide additional details and data formats.</p>
<p>There are already some excellent resources online for learning how to create beautiful and informative network visuals. We recommend the excellent online materials produced by Dr. Katherine Ognyanova <a href="https://kateto.net/">available on her website</a> and her <a href="https://kateto.net/network-visualization">Static and dynamic network visualization with R</a> workshop materials in particular. Many of the examples here and in the book take inspiration from her work. In addition to this, the <a href="https://www.r-graph-gallery.com/">R Graph Gallery</a> website created by <a href="https://github.com/holtzy">Holtz Yan</a> provides numerous excellent examples of plots in R using the ggplot2 and ggraph packages among many others. If you are new to R, it will probably be helpful for you to read a bit about basic graphic functions (including in the tutorials listed here) before getting started.</p>
<div id="datasets-and-r-setup" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Datasets and R Setup</h2>
<p>In order to make it as easy as possible for users to replicate specific visuals from the book and the other examples in this tutorial we have tried to make the examples as modular as possible. This means that we provide calls to initialize the required libraries for each plot within each relevant chunk of code (so that you can more easily tell what package does what) and we also provide links to download the data required to replicate each figure in the description of that figure below. The datasets we use here include both .csv and other format files as well as .Rdata files that contain sets of specific R objects formatted as required for individual chunks of code.</p>
<p>If you plan on working through this entire tutorial and would like to download all of the associated data at once <a href="All_data.zip">you can download this zip file</a>. Simply extract this zip folder into your R working directory and the examples below will then work. Note that all of the examples below are setup such that the data should be contained in a sub-folder of your working directory called “data” (note that directories and file names are case sensitive).</p>
</div>
<div id="visualizing-networks-in-r" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Visualizing Networks in R</h2>
<p>There are many tools available for creating network visualizations in R including functions built directly into the igraph and statnet packages. Before we get into the details, we first briefly illustrate the primary network plotting options for igraph statnet and a visualization package called ggraph. We start here by initializing our required libraries and reading in an adjacency matrix and creating network objects in both the igraph and network/statnet format. These will be the basis for all examples in this section.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="network-visualization.html#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb225-2"><a href="network-visualization.html#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statnet)</span>
<span id="cb225-3"><a href="network-visualization.html#cb225-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb225-4"><a href="network-visualization.html#cb225-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(intergraph)</span>
<span id="cb225-5"><a href="network-visualization.html#cb225-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-6"><a href="network-visualization.html#cb225-6" aria-hidden="true" tabindex="-1"></a>Cibola <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">&quot;data/Cibola_adj.csv&quot;</span>, <span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">row.names=</span><span class="dv">1</span>)</span>
<span id="cb225-7"><a href="network-visualization.html#cb225-7" aria-hidden="true" tabindex="-1"></a>Cibola_attr <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">&quot;data/Cibola_attr.csv&quot;</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb225-8"><a href="network-visualization.html#cb225-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-9"><a href="network-visualization.html#cb225-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create network in igraph format</span></span>
<span id="cb225-10"><a href="network-visualization.html#cb225-10" aria-hidden="true" tabindex="-1"></a>Cibola_i <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">graph_from_adjacency_matrix</span>(<span class="fu">as.matrix</span>(Cibola), <span class="at">mode=</span><span class="st">&quot;undirected&quot;</span>)</span>
<span id="cb225-11"><a href="network-visualization.html#cb225-11" aria-hidden="true" tabindex="-1"></a>Cibola_i</span></code></pre></div>
<pre><code>## IGRAPH d7dcf8c UN-- 31 167 -- 
## + attr: name (v/c)
## + edges from d7dcf8c (vertex names):
##  [1] Apache.Creek--Casa.Malpais          Apache.Creek--Coyote.Creek         
##  [3] Apache.Creek--Hooper.Ranch          Apache.Creek--Horse.Camp.Mill      
##  [5] Apache.Creek--Hubble.Corner         Apache.Creek--Mineral.Creek.Pueblo 
##  [7] Apache.Creek--Rudd.Creek.Ruin       Apache.Creek--Techado.Springs      
##  [9] Apache.Creek--Tri.R.Pueblo          Apache.Creek--UG481                
## [11] Apache.Creek--UG494                 Atsinna     --Cienega              
## [13] Atsinna     --Los.Gigantes          Atsinna     --Mirabal              
## [15] Atsinna     --Ojo.Bonito            Atsinna     --Pueblo.de.los.Muertos
## + ... omitted several edges</code></pre>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="network-visualization.html#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create network object in statnet/network format</span></span>
<span id="cb227-2"><a href="network-visualization.html#cb227-2" aria-hidden="true" tabindex="-1"></a>Cibola_n <span class="ot">&lt;-</span> <span class="fu">asNetwork</span>(Cibola_i)</span>
<span id="cb227-3"><a href="network-visualization.html#cb227-3" aria-hidden="true" tabindex="-1"></a>Cibola_n</span></code></pre></div>
<pre><code>##  Network attributes:
##   vertices = 31 
##   directed = FALSE 
##   hyper = FALSE 
##   loops = FALSE 
##   multiple = FALSE 
##   bipartite = FALSE 
##   total edges= 167 
##     missing edges= 0 
##     non-missing edges= 167 
## 
##  Vertex attribute names: 
##     vertex.names 
## 
## No edge attributes</code></pre>
<div id="networkstatnet" class="section level3" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> network/statnet</h3>
<p>All you need to do to plot a network/statnet network object is to simply type plot(nameofnetwork). By default, this creates a network plot where all nodes and edges are shown the same color and weight using the Fruchterman-Reingold graph layout by default. There are, however, many options that can be altered for this basic plot. In order to see the details you can type ?plot.network at the console for the associated document.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="network-visualization.html#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">6332</span>)</span>
<span id="cb229-2"><a href="network-visualization.html#cb229-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Cibola_n)</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig_net_simple-1.png" width="672" /></p>
<p>In order to change the color of nodes, the layout, symbols, or any other features, you can add arguments as detailed in the help document. These arguments can include calls to other functions, mathematical expressions, or even additional data in other attribute files. For example in the following plot, we calculate degree centrality directly within the plot call and then divide the result by 10 to ensure that the nodes are a reasonable size in the plot. We use the “vertex.cex” argument to set node size based on the results of that expression. Further we change the layout using the “mode” argument to produce a network graph using the Kamada-Kawai layout. We change the color of the nodes so that they represent the “Region” variable in the associated attribute file using the “vertex.col” argument and and set change all edge colors using the “edge.col” argument. Finally, we use “displayisolates=FALSE” to indicate that we do not want the single isolated node to be plotted. These are but a few of the many options.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="network-visualization.html#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">436</span>)</span>
<span id="cb230-2"><a href="network-visualization.html#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Cibola_n, <span class="at">vertex.cex=</span>sna<span class="sc">::</span><span class="fu">degree</span>(Cibola_n)<span class="sc">/</span><span class="dv">10</span>, <span class="at">mode=</span><span class="st">&quot;kamadakawai&quot;</span>, </span>
<span id="cb230-3"><a href="network-visualization.html#cb230-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.col=</span><span class="fu">as.factor</span>(Cibola_attr<span class="sc">$</span>Region), <span class="at">edge.col=</span><span class="st">&quot;darkgray&quot;</span>, <span class="at">displayisolates=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig_network_net-1.png" width="672" /></p>
</div>
<div id="igraph" class="section level3" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> igraph</h3>
<p>The igraph package also has a built in plotting function called plot.igraph. To call this you again just need to type plot(yournetworkhere) and provide an igraph object (R can tell what kind of object you have if you simply type plot). The default igraph plot again uses a Fruchterman-Reingold layout just like statnet/network but by default each node is labeled.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="network-visualization.html#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">435</span>)</span>
<span id="cb231-2"><a href="network-visualization.html#cb231-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Cibola_i)</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig_igraph_simple-1.png" width="672" /></p>
<p>Let’s take a look at a few of the options we can alter to change this plot. There are again many options to explore here and the help documents for igraph.plotting describe them in detail (type ?igraph.plotting at the console for more). If you want to explore igraph further, we suggest you check the <a href="https://kateto.net/network-visualization">Network Visualization</a> tutorial linked above which provides a discussion of the wide variety of options.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="network-visualization.html#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3463</span>)</span>
<span id="cb232-2"><a href="network-visualization.html#cb232-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Cibola_i, <span class="at">vertex.size=</span>igraph<span class="sc">::</span><span class="fu">eigen_centrality</span>(Cibola_i)<span class="sc">$</span>vector<span class="sc">*</span><span class="dv">20</span>, <span class="at">layout=</span>layout_with_kk,</span>
<span id="cb232-3"><a href="network-visualization.html#cb232-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.color=</span><span class="fu">as.factor</span>(Cibola_attr<span class="sc">$</span>Great.Kiva), <span class="at">edge.color=</span><span class="st">&quot;darkblue&quot;</span>, <span class="at">vertex.frame.color=</span><span class="st">&quot;red&quot;</span>, <span class="at">vertex.label=</span><span class="cn">NA</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig_igraph-1.png" width="672" /></p>
</div>
<div id="ggraph" class="section level3" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> ggraph</h3>
<p>The ggraph package provides a powerful set of tools for plotting and visualizing network data in R. The format used for this package is a bit different from what we saw above and instead relies on the ggplot2 style of plots where a plot type is called and modifications are made with sets of lines with additional arguments separated by “+”. Although this takes a bit of getting used to we have found that the ggplot format is often more intuitive for making complex graphics once you understand the basics.</p>
<p>Essentially, the way the ggraph call works is you start with a ggraph function call which includes the network object and the layout information. You then provide lines specifying the edges “geom_edge_link” and nodes “geom_node_point” features and so on. Conveniently the ggraph function call will take either an igraph or a network/statnet object so you do not need to convert.</p>
<p>Here is an example. Here we first the call for the igraph network object “Cibola_i” and specify the Fruchterman-Reingold layout using layout=“fr”. Next, we call the “geom_edge_link” and specify edge colors. The “geom_node_point” call then specifies many attributes of the nodes including the fill color, outline color, transparency (alpha), shape, and size using the igraph::degree function). The “scale_size” call then tells the plot to scale the node size specified in the previous line to range between 1 and 4. Finally “theme_graph” is a basic call to the ggraph theme that tells the plot to make the background white and to remove the margins around the edge of the plot. Let’s see how this looks.</p>
<p>In the next section we go over the most common options in ggraph in detail.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="network-visualization.html#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4368</span>)</span>
<span id="cb233-2"><a href="network-visualization.html#cb233-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(Cibola_i, <span class="at">layout=</span><span class="st">&quot;fr&quot;</span>) <span class="sc">+</span> <span class="co"># Specify network to use and layout</span></span>
<span id="cb233-3"><a href="network-visualization.html#cb233-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">color=</span><span class="st">&quot;darkgray&quot;</span>) <span class="sc">+</span> <span class="co"># Specify edge features</span></span>
<span id="cb233-4"><a href="network-visualization.html#cb233-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="at">fill=</span><span class="st">&quot;blue&quot;</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">shape =</span> <span class="dv">22</span>, <span class="at">size =</span> igraph<span class="sc">::</span><span class="fu">degree</span>(Cibola_i)) <span class="sc">+</span> <span class="co"># Specify node features</span></span>
<span id="cb233-5"><a href="network-visualization.html#cb233-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)) <span class="sc">+</span> <span class="co"># Set the upper and lower limit of the &quot;size&quot; variable</span></span>
<span id="cb233-6"><a href="network-visualization.html#cb233-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>() <span class="co"># Set the theme &quot;theme_graph&quot; is the default theme for networks</span></span></code></pre></div>
<p><img src="_main_files/figure-html/Fig_ggraph-1.png" width="672" /></p>
<p>There are many options for the ggraph package and we recommend exploring the help document (?ggraph) as well as the <a href="https://www.data-imaginist.com/tags/visualization">Data Imaginist</a> ggraph tutorial online for more. Most of the examples below will use the ggraph format.</p>
</div>
</div>
<div id="network-visualization-options" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Network Visualization Options</h2>
<p>In this section we illustrate some of the most useful graphical options for visualizing networks, focusing in particular on the ggraph format. In most cases there are similar options available in the plotting functions for both statnet and igraph. Where relevant we reference specific figures from the book and this tutorial and the code for all of the figures produced in R is presented in the next session. For all of the examples in this section we will use the <a href="data/Peeples2018.Rdata">Cibola technological similarity data (click here to download)</a>. First we call the required packages and import the data.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="network-visualization.html#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb234-2"><a href="network-visualization.html#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statnet)</span>
<span id="cb234-3"><a href="network-visualization.html#cb234-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(intergraph)</span>
<span id="cb234-4"><a href="network-visualization.html#cb234-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb234-5"><a href="network-visualization.html#cb234-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-6"><a href="network-visualization.html#cb234-6" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/Peeples2018.Rdata&quot;</span>)</span>
<span id="cb234-7"><a href="network-visualization.html#cb234-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-8"><a href="network-visualization.html#cb234-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create igraph object for plots below</span></span>
<span id="cb234-9"><a href="network-visualization.html#cb234-9" aria-hidden="true" tabindex="-1"></a>net <span class="ot">&lt;-</span> <span class="fu">asIgraph</span>(BRnet)</span></code></pre></div>
<div id="graph-layout" class="section level3" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Graph Layout</h3>
<p>Graph layout simply refers to the placement and organization in 2-dimensional or 3-dimensional space of nodes and edges in a network.</p>
<div id="manual-or-user-defined-layouts" class="section level4" number="6.3.1.1">
<h4><span class="header-section-number">6.3.1.1</span> Manual or User Defined Layouts</h4>
<p>There are a few options for manually defining node placement and graph layout in R and the easiest is to simply provide x and y coordinates directly. In this example, we plot the Cibola technological similarity network with a set of x and y coordinates that group sites in the same region in a grid configuration. For another example of this approach see <a href="network-visualization.html#Figure_6_1">Figure 6.1 below</a>. For an example of how you can interactively define a layout see <a href="network-visualization.html#Figure_6_5">Figure 6.5</a></p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="network-visualization.html#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co"># site_info - site location and attribute data</span></span>
<span id="cb235-2"><a href="network-visualization.html#cb235-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-3"><a href="network-visualization.html#cb235-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create xy coordinates grouped by region</span></span>
<span id="cb235-4"><a href="network-visualization.html#cb235-4" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="fl">1.2</span>,<span class="dv">3</span>,<span class="fl">3.2</span>,<span class="dv">2</span>,<span class="fl">1.4</span>,<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="dv">2</span>,<span class="fl">2.2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="fl">2.2</span>,<span class="dv">1</span>,</span>
<span id="cb235-5"><a href="network-visualization.html#cb235-5" aria-hidden="true" tabindex="-1"></a>             <span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="fl">3.2</span>,<span class="dv">3</span>,<span class="fl">1.2</span>,<span class="dv">3</span>,<span class="fl">3.4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="fl">3.2</span>,<span class="fl">3.2</span>,<span class="dv">3</span>,<span class="fl">1.4</span>,<span class="dv">3</span>,<span class="fl">2.2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="fl">3.2</span>,<span class="fl">3.4</span>,</span>
<span id="cb235-6"><a href="network-visualization.html#cb235-6" aria-hidden="true" tabindex="-1"></a>             <span class="fl">2.2</span>,<span class="fl">1.2</span>,<span class="fl">3.4</span>,<span class="fl">3.2</span>,<span class="fl">3.2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="fl">3.4</span>,<span class="fl">3.4</span>,<span class="fl">3.4</span>,<span class="fl">2.2</span>,<span class="dv">3</span>,<span class="fl">2.2</span>,<span class="fl">3.2</span>,<span class="fl">2.2</span>,<span class="fl">3.4</span>,</span>
<span id="cb235-7"><a href="network-visualization.html#cb235-7" aria-hidden="true" tabindex="-1"></a>             <span class="dv">1</span>,<span class="fl">1.4</span>,<span class="dv">3</span>,<span class="fl">2.4</span>), <span class="at">nrow=</span><span class="dv">31</span>, <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb235-8"><a href="network-visualization.html#cb235-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-9"><a href="network-visualization.html#cb235-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot using &quot;manual&quot; layout and specify xy coordinates</span></span>
<span id="cb235-10"><a href="network-visualization.html#cb235-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(net, <span class="at">layout=</span><span class="st">&quot;manual&quot;</span>,</span>
<span id="cb235-11"><a href="network-visualization.html#cb235-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span>xy[,<span class="dv">1</span>], <span class="at">y=</span>xy[,<span class="dv">2</span>]) <span class="sc">+</span></span>
<span id="cb235-12"><a href="network-visualization.html#cb235-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">edge_color=</span><span class="st">&quot;gray&quot;</span>) <span class="sc">+</span></span>
<span id="cb235-13"><a href="network-visualization.html#cb235-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> <span class="dv">4</span>,<span class="at">col=</span>site_info<span class="sc">$</span>Region), <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb235-14"><a href="network-visualization.html#cb235-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/manual_layout-1.png" width="480" /></p>
</div>
<div id="geographic-layouts" class="section level4" number="6.3.1.2">
<h4><span class="header-section-number">6.3.1.2</span> Geographic Layouts</h4>
<p>Plotting networks using a a geographic layout is essentially the same as plotting with a manual layout except that you specify geographic coordinates instead of other coordinates. See <a href="network-visualization.html#Figure_6_2">Figure 6.2</a> for another example.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="network-visualization.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(net, <span class="at">layout=</span><span class="st">&quot;manual&quot;</span>,</span>
<span id="cb236-2"><a href="network-visualization.html#cb236-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span>site_info<span class="sc">$</span>x, <span class="at">y=</span>site_info<span class="sc">$</span>y) <span class="sc">+</span></span>
<span id="cb236-3"><a href="network-visualization.html#cb236-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">edge_color=</span><span class="st">&quot;gray&quot;</span>) <span class="sc">+</span></span>
<span id="cb236-4"><a href="network-visualization.html#cb236-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size=</span><span class="dv">4</span>, <span class="at">col=</span>site_info<span class="sc">$</span>Region), <span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb236-5"><a href="network-visualization.html#cb236-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/map1-1.png" width="480" /></p>
<p>When working with geographic data, it is also sometimes useful to plot directly on top of some sort of base map. There are many options for this but one of the most convenient is to use the “sf” and “ggmap” packages to directly download the relevant base map layer and plot directly on top of it. This first requires converting points to latitude and longitude in decimal degrees if they are not already in that format. See the details on the <a href="https://r-spatial.github.io/sf/">sf package</a> and <a href="https://github.com/dkahle/ggmap">ggmap package</a> for more details. In addition to this example <a href="network-visualization.html#Figure_6_7">Figure 6.7 in the book</a> provides another example.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="network-visualization.html#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb237-2"><a href="network-visualization.html#cb237-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggmap)</span>
<span id="cb237-3"><a href="network-visualization.html#cb237-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4"><a href="network-visualization.html#cb237-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert attribute location data to sf coordinates and change map projection</span></span>
<span id="cb237-5"><a href="network-visualization.html#cb237-5" aria-hidden="true" tabindex="-1"></a>locations_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(site_info, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>), <span class="at">crs =</span> <span class="dv">26912</span>)</span>
<span id="cb237-6"><a href="network-visualization.html#cb237-6" aria-hidden="true" tabindex="-1"></a>loc_trans <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(locations_sf,<span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb237-7"><a href="network-visualization.html#cb237-7" aria-hidden="true" tabindex="-1"></a>coord1 <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">st_geometry</span>(loc_trans)) <span class="sc">%&gt;%</span> </span>
<span id="cb237-8"><a href="network-visualization.html#cb237-8" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">&quot;lon&quot;</span>,<span class="st">&quot;lat&quot;</span>))</span>
<span id="cb237-9"><a href="network-visualization.html#cb237-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-10"><a href="network-visualization.html#cb237-10" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(coord1)</span>
<span id="cb237-11"><a href="network-visualization.html#cb237-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(xy) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;x&#39;</span>,<span class="st">&#39;y&#39;</span>)</span>
<span id="cb237-12"><a href="network-visualization.html#cb237-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-13"><a href="network-visualization.html#cb237-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get basemap &quot;terrain-background&quot; data for map in black and white </span></span>
<span id="cb237-14"><a href="network-visualization.html#cb237-14" aria-hidden="true" tabindex="-1"></a><span class="co"># the bbox argument is used to specify the corners of the box to be used and</span></span>
<span id="cb237-15"><a href="network-visualization.html#cb237-15" aria-hidden="true" tabindex="-1"></a><span class="co"># zoom determines the detail. </span></span>
<span id="cb237-16"><a href="network-visualization.html#cb237-16" aria-hidden="true" tabindex="-1"></a>base_cibola <span class="ot">&lt;-</span> <span class="fu">get_stamenmap</span>(<span class="at">bbox=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">110.2</span>,<span class="fl">33.4</span>,<span class="sc">-</span><span class="fl">107.8</span>,<span class="fl">35.3</span>),<span class="at">zoom=</span><span class="dv">10</span>,<span class="at">maptype=</span><span class="st">&quot;terrain-background&quot;</span>,<span class="at">color=</span><span class="st">&quot;bw&quot;</span>)</span>
<span id="cb237-17"><a href="network-visualization.html#cb237-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-18"><a href="network-visualization.html#cb237-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract edgelist from network object</span></span>
<span id="cb237-19"><a href="network-visualization.html#cb237-19" aria-hidden="true" tabindex="-1"></a>edgelist <span class="ot">&lt;-</span> <span class="fu">get.edgelist</span>(net)</span>
<span id="cb237-20"><a href="network-visualization.html#cb237-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-21"><a href="network-visualization.html#cb237-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataframe of beginning and ending points of edges</span></span>
<span id="cb237-22"><a href="network-visualization.html#cb237-22" aria-hidden="true" tabindex="-1"></a>edges <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(xy[edgelist[,<span class="dv">1</span>],], xy[edgelist[,<span class="dv">2</span>],])</span>
<span id="cb237-23"><a href="network-visualization.html#cb237-23" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(edges) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X1&quot;</span>,<span class="st">&quot;Y1&quot;</span>,<span class="st">&quot;X2&quot;</span>,<span class="st">&quot;Y2&quot;</span>)</span>
<span id="cb237-24"><a href="network-visualization.html#cb237-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-25"><a href="network-visualization.html#cb237-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot original data on map</span></span>
<span id="cb237-26"><a href="network-visualization.html#cb237-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ggmap</span>(base_cibola,<span class="at">darken=</span><span class="fl">0.35</span>) <span class="sc">+</span></span>
<span id="cb237-27"><a href="network-visualization.html#cb237-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> edges, <span class="fu">aes</span>(<span class="at">x=</span>X1, <span class="at">y=</span>Y1, <span class="at">xend=</span>X2, <span class="at">yend=</span>Y2), <span class="at">col=</span><span class="st">&#39;white&#39;</span>, <span class="at">alpha=</span><span class="fl">0.8</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb237-28"><a href="network-visualization.html#cb237-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> xy,<span class="fu">aes</span>(x,y, <span class="at">col=</span>site_info<span class="sc">$</span>Region), <span class="at">alpha=</span><span class="fl">0.8</span>, <span class="at">size=</span><span class="dv">5</span>, <span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb237-29"><a href="network-visualization.html#cb237-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/geo_layout-1.png" width="768" /></p>
</div>
<div id="shape-based-and-algorithmic-layouts" class="section level4" number="6.3.1.3">
<h4><span class="header-section-number">6.3.1.3</span> Shape-Based and Algorithmic Layouts</h4>
<p>There are a wide variety of shape-based and algorithmic layouts available for use in R. In most cases, all it takes to change layouts is to simply modify a single line the ggraph call to specify our desired layout. The ggraph package can use any of the igraph layouts as well as many that are built directly into the package. See ?ggraph for more details and to see the options. Here we show a few examples. Note that we leave the figures calls the same except for the argument layout=“yourlayout” in each ggraph call and the ggtitle name. For the layouts that involve randomization, we use the “set.seed()” function to make sure they will always plot the same. See the discussion of <a href="network-visualization.html#Figure_6_8">Figure 6.8</a> below for more details. Beyond this <a href="network-visualization.html#Figure_6_9">Figure 6.9</a> provides additional options that can be used for hierarchical network data.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="network-visualization.html#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="co"># circular layout</span></span>
<span id="cb238-2"><a href="network-visualization.html#cb238-2" aria-hidden="true" tabindex="-1"></a>circ_net <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(net, <span class="at">layout=</span><span class="st">&quot;circle&quot;</span>) <span class="sc">+</span></span>
<span id="cb238-3"><a href="network-visualization.html#cb238-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">edge_color=</span><span class="st">&quot;gray&quot;</span>) <span class="sc">+</span></span>
<span id="cb238-4"><a href="network-visualization.html#cb238-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size=</span><span class="dv">4</span>, <span class="at">col=</span>site_info<span class="sc">$</span>Region), <span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb238-5"><a href="network-visualization.html#cb238-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Circle&quot;</span>) <span class="sc">+</span></span>
<span id="cb238-6"><a href="network-visualization.html#cb238-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span>
<span id="cb238-7"><a href="network-visualization.html#cb238-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-8"><a href="network-visualization.html#cb238-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Fruchcterman-Reingold layout</span></span>
<span id="cb238-9"><a href="network-visualization.html#cb238-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4366</span>)</span>
<span id="cb238-10"><a href="network-visualization.html#cb238-10" aria-hidden="true" tabindex="-1"></a>fr_net <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(net, <span class="at">layout=</span><span class="st">&quot;fr&quot;</span>) <span class="sc">+</span></span>
<span id="cb238-11"><a href="network-visualization.html#cb238-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">edge_color=</span><span class="st">&quot;gray&quot;</span>) <span class="sc">+</span></span>
<span id="cb238-12"><a href="network-visualization.html#cb238-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size=</span><span class="dv">4</span>, <span class="at">col=</span>site_info<span class="sc">$</span>Region), <span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb238-13"><a href="network-visualization.html#cb238-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Fruchterman-Reingold&quot;</span>) <span class="sc">+</span></span>
<span id="cb238-14"><a href="network-visualization.html#cb238-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span>
<span id="cb238-15"><a href="network-visualization.html#cb238-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-16"><a href="network-visualization.html#cb238-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Davidsons and Harels annealing algorithm layout</span></span>
<span id="cb238-17"><a href="network-visualization.html#cb238-17" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3467</span>)</span>
<span id="cb238-18"><a href="network-visualization.html#cb238-18" aria-hidden="true" tabindex="-1"></a>dh_net <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(net, <span class="at">layout=</span><span class="st">&quot;dh&quot;</span>) <span class="sc">+</span></span>
<span id="cb238-19"><a href="network-visualization.html#cb238-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">edge_color=</span><span class="st">&quot;gray&quot;</span>) <span class="sc">+</span></span>
<span id="cb238-20"><a href="network-visualization.html#cb238-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size=</span><span class="dv">4</span>, <span class="at">col=</span>site_info<span class="sc">$</span>Region), <span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb238-21"><a href="network-visualization.html#cb238-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Davidson-Harel&quot;</span>) <span class="sc">+</span></span>
<span id="cb238-22"><a href="network-visualization.html#cb238-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span>
<span id="cb238-23"><a href="network-visualization.html#cb238-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-24"><a href="network-visualization.html#cb238-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb238-25"><a href="network-visualization.html#cb238-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(circ_net, fr_net, dh_net, <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/layouts-1.png" width="1344" /></p>
</div>
</div>
<div id="node-and-edge-options" class="section level3" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Node and Edge Options</h3>
<p>There are many options for altering color and symbol for nodes and edges within R. In this section we very briefly discuss some of the most common options. For more details see the discussion of <a href="network-visualization.html#Figure_6_10">figures 6.10 through 6.16</a> below.</p>
<div id="nodes" class="section level4" number="6.3.2.1">
<h4><span class="header-section-number">6.3.2.1</span> Nodes</h4>
<p>In ggraph changing node options mostly consists of changing options within the “geom_node_point” call within the ggraph figure call. As we have already seen it is possible to set color for all nodes or by some variable, to change the size of points, and we can also scale points by some metric like centrality. Indeed, it is even possible to make the call to the centrality function in question directly within the figure code.</p>
<p>When selecting point shapes you can use any of the shapes available in base R using pch point codes. Here are all of the available options:</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="network-visualization.html#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb239-2"><a href="network-visualization.html#cb239-2" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">show_point_shapes</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/pch_points-1.png" width="672" /></p>
<p>There are many options for selecting colors for nodes and edges. These can be assigned using standard color names or can be assigned using rgb or hex codes. It is also possible to use standard palettes in packages like RColorBrewer or scales to specify categorical or continuous color schemes. This is often done using either the “scale_fill_brewer” or “scale_color_brewer” calls from RColorBrewer. Here are a couple of examples. In these examples, colors are grouped by site region, node size is scaled to degree centrality, and node and edge color and shape are specified in each call. Note the “alpha” command which controls the transparency of the relevant part of the plot. The scale_size call specifies the maximum and minimum size of points in the plot.</p>
<p>The <a href="https://www.r-graph-gallery.com/38-rcolorbrewers-palettes.html">R Graph Gallery</a> has a good overview of the available color palettes in RColorBrewer and when the can be used.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="network-visualization.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb240-2"><a href="network-visualization.html#cb240-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-3"><a href="network-visualization.html#cb240-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">347</span>)</span>
<span id="cb240-4"><a href="network-visualization.html#cb240-4" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(net, <span class="at">layout =</span> <span class="st">&quot;kk&quot;</span>) <span class="sc">+</span></span>
<span id="cb240-5"><a href="network-visualization.html#cb240-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">edge_color=</span><span class="st">&quot;gray&quot;</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb240-6"><a href="network-visualization.html#cb240-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> site_info<span class="sc">$</span>Region), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> igraph<span class="sc">::</span><span class="fu">degree</span>(net), <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb240-7"><a href="network-visualization.html#cb240-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb240-8"><a href="network-visualization.html#cb240-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="sc">+</span></span>
<span id="cb240-9"><a href="network-visualization.html#cb240-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()<span class="sc">+</span></span>
<span id="cb240-10"><a href="network-visualization.html#cb240-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb240-11"><a href="network-visualization.html#cb240-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-12"><a href="network-visualization.html#cb240-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">347</span>)</span>
<span id="cb240-13"><a href="network-visualization.html#cb240-13" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(net, <span class="at">layout =</span> <span class="st">&quot;kk&quot;</span>) <span class="sc">+</span></span>
<span id="cb240-14"><a href="network-visualization.html#cb240-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">edge_color=</span><span class="st">&quot;blue&quot;</span>, <span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb240-15"><a href="network-visualization.html#cb240-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> site_info<span class="sc">$</span>Region), <span class="at">shape =</span> <span class="dv">15</span>, <span class="at">size =</span> igraph<span class="sc">::</span><span class="fu">degree</span>(net), <span class="at">alpha=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb240-16"><a href="network-visualization.html#cb240-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb240-17"><a href="network-visualization.html#cb240-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>) <span class="sc">+</span></span>
<span id="cb240-18"><a href="network-visualization.html#cb240-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()<span class="sc">+</span></span>
<span id="cb240-19"><a href="network-visualization.html#cb240-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb240-20"><a href="network-visualization.html#cb240-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-21"><a href="network-visualization.html#cb240-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(g1, g2, <span class="at">nrow=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/color_brewer-1.png" width="1152" /></p>
<p>There are also a number of more advanced methods for displaying nodes including displaying figures or other data visualizations in the place of nodes or using images for nodes. There are examples of each of these in the book and code outlining how to create such visuals in the discussions of <a href="network-visualization.html#Figure_6_3">Figure 6.3</a> and <a href="network-visualization.html#Figure_6_12">Figure 6.12</a> below.</p>
</div>
<div id="edges" class="section level4" number="6.3.2.2">
<h4><span class="header-section-number">6.3.2.2</span> Edges</h4>
<p>Edges can be modified in terms of color, line type, thickness and many other features just like nodes and this is typically done using the “geom_edge_link” call within ggraph. Let’s take a look at a couple of additional examples. In this case we’re going to use a weighted network object in the original <a href="data/Peeples2018.Rdata">Peeples2018.Rdata</a> file to show how we can vary edges in relation to edge attributes like weight.</p>
<p>In the example here we plot both the line thickness and transparency using the edge weights associated with the network object. We also are using the “scale_edge_color_viridis” to specify a continuous edge color scheme. For more details see ?scale_edge_colour</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="network-visualization.html#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(intergraph)</span>
<span id="cb241-2"><a href="network-visualization.html#cb241-2" aria-hidden="true" tabindex="-1"></a>net2 <span class="ot">&lt;-</span> <span class="fu">asIgraph</span>(BRnet_w)</span>
<span id="cb241-3"><a href="network-visualization.html#cb241-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-4"><a href="network-visualization.html#cb241-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">436</span>)</span>
<span id="cb241-5"><a href="network-visualization.html#cb241-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(net2, <span class="st">&quot;stress&quot;</span>) <span class="sc">+</span></span>
<span id="cb241-6"><a href="network-visualization.html#cb241-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width =</span> weight, <span class="at">alpha=</span> weight, <span class="at">col=</span>weight)) <span class="sc">+</span></span>
<span id="cb241-7"><a href="network-visualization.html#cb241-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_color_viridis</span>() <span class="sc">+</span></span>
<span id="cb241-8"><a href="network-visualization.html#cb241-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb241-9"><a href="network-visualization.html#cb241-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="at">size=</span><span class="dv">4</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb241-10"><a href="network-visualization.html#cb241-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">edge_color=</span><span class="st">&quot;Edge Weight Color Scale&quot;</span>) <span class="sc">+</span></span>
<span id="cb241-11"><a href="network-visualization.html#cb241-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/edge_options1-1.png" width="672" /></p>
<p>Another feature of edges that is often important in visualizations is the presence or absence and type of arrows. Arrows can be modified in ggraph using the “arrow” argument within a “geom_edge_link” call. The most relevant options are the length of the arrow (which determines size), the “type” argument which specifies an open or closed arrow, and the spacing of the arrow which can be set by the “end_cap” and “start_cap” respectively which define the gap between the arrow point and the node. These values can all be set using absolute measurements as shown in the example below. Since this is an undirected network we use the argument “ends=‘first’” to simulated a directed network so that arrowheads will only be drawn the first time an edge appears in the edge list. See ?arrow for more details on options.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="network-visualization.html#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">436</span>)</span>
<span id="cb242-2"><a href="network-visualization.html#cb242-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(net, <span class="st">&quot;stress&quot;</span>) <span class="sc">+</span></span>
<span id="cb242-3"><a href="network-visualization.html#cb242-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">&#39;mm&#39;</span>), <span class="at">ends=</span><span class="st">&quot;first&quot;</span>, <span class="at">type=</span><span class="st">&quot;closed&quot;</span>),</span>
<span id="cb242-4"><a href="network-visualization.html#cb242-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">end_cap =</span> <span class="fu">circle</span>(<span class="dv">0</span>, <span class="st">&#39;mm&#39;</span>), <span class="at">start_cap =</span> <span class="fu">circle</span>(<span class="dv">3</span>, <span class="st">&#39;mm&#39;</span>), </span>
<span id="cb242-5"><a href="network-visualization.html#cb242-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">edge_colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb242-6"><a href="network-visualization.html#cb242-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="at">size=</span><span class="dv">4</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb242-7"><a href="network-visualization.html#cb242-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/edge_options2-1.png" width="672" /></p>
<p>Another common consideration with edges is the shape of the edges themselves. So far we have used examples where the edges are all straight lines, but it is also possible to draw them as arcs or so that they fan out from nodes so that multiple connections are visible. In general, all you need to do to change this option is to use another command in the “geom_edge_” family of commands. For example, in the following chunk of code we produce a network with arcs rather than straight lines. In this case the argument “strength” controls the amount of bend in the lines.</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="network-visualization.html#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">436</span>)</span>
<span id="cb243-2"><a href="network-visualization.html#cb243-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(net, <span class="st">&quot;kk&quot;</span>) <span class="sc">+</span></span>
<span id="cb243-3"><a href="network-visualization.html#cb243-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_arc</span>(<span class="at">edge_colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">strength=</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb243-4"><a href="network-visualization.html#cb243-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="at">size=</span><span class="dv">4</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb243-5"><a href="network-visualization.html#cb243-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/edge_arc-1.png" width="672" /></p>
<p>It is also possible to not show edges at all but instead just a gradient scale representing the density of edges using the “geom_edge_density” call. This could be useful in very large and complex networks.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="network-visualization.html#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">436</span>)</span>
<span id="cb244-2"><a href="network-visualization.html#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(net2, <span class="st">&quot;kk&quot;</span>) <span class="sc">+</span></span>
<span id="cb244-3"><a href="network-visualization.html#cb244-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_density</span>() <span class="sc">+</span></span>
<span id="cb244-4"><a href="network-visualization.html#cb244-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="at">size=</span><span class="dv">4</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb244-5"><a href="network-visualization.html#cb244-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/edge_density-1.png" width="672" /></p>
</div>
</div>
<div id="label-options" class="section level3" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> Label Options</h3>
<p>In many cases you may want to label either the nodes, edges, or other features of a network. This is relatively easy to do in ggraph with the “geom_node_text()” command. This will place labels as specified on each node. If you use the “repel = TRUE” argument it will repel the names slightly from the node to make them more readable. As shown in the example for <a href="network-visualization.html#Figure_6_4">Figure 6.4</a> it is also possible to filter labels to label only certain nodes.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="network-visualization.html#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first set a node attribute called name based on site names</span></span>
<span id="cb245-2"><a href="network-visualization.html#cb245-2" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(net2)<span class="sc">$</span>name <span class="ot">&lt;-</span> <span class="fu">get.vertex.attribute</span>(BRnet_w, <span class="at">attr=</span><span class="st">&quot;vertex.names&quot;</span>)</span>
<span id="cb245-3"><a href="network-visualization.html#cb245-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-4"><a href="network-visualization.html#cb245-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">436</span>)</span>
<span id="cb245-5"><a href="network-visualization.html#cb245-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(net2, <span class="st">&quot;fr&quot;</span>) <span class="sc">+</span></span>
<span id="cb245-6"><a href="network-visualization.html#cb245-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>() <span class="sc">+</span></span>
<span id="cb245-7"><a href="network-visualization.html#cb245-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="at">size=</span><span class="dv">4</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb245-8"><a href="network-visualization.html#cb245-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name), <span class="at">size=</span><span class="dv">3</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb245-9"><a href="network-visualization.html#cb245-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/node_label-1.png" width="672" /></p>
<p>It is also possible to label edges by adding an argument directly into the “geom_link_” command. In practice, this really only works with very small networks. In the next chunk of code, we create a small network and demonstrate this function.</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="network-visualization.html#cb246-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">graph</span>( <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>,</span>
<span id="cb246-2"><a href="network-visualization.html#cb246-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>,</span>
<span id="cb246-3"><a href="network-visualization.html#cb246-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;A&quot;</span>, <span class="st">&quot;C&quot;</span>,</span>
<span id="cb246-4"><a href="network-visualization.html#cb246-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>,</span>
<span id="cb246-5"><a href="network-visualization.html#cb246-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;C&quot;</span>,<span class="st">&quot;B&quot;</span>,</span>
<span id="cb246-6"><a href="network-visualization.html#cb246-6" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;D&quot;</span>,<span class="st">&quot;C&quot;</span>))</span>
<span id="cb246-7"><a href="network-visualization.html#cb246-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-8"><a href="network-visualization.html#cb246-8" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(g)<span class="sc">$</span>weight <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">4</span>,<span class="dv">2</span>)</span>
<span id="cb246-9"><a href="network-visualization.html#cb246-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-10"><a href="network-visualization.html#cb246-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4351</span>)</span>
<span id="cb246-11"><a href="network-visualization.html#cb246-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(g, <span class="at">layout=</span><span class="st">&#39;stress&#39;</span>) <span class="sc">+</span></span>
<span id="cb246-12"><a href="network-visualization.html#cb246-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_fan</span>(<span class="fu">aes</span>(<span class="at">label=</span>weight)) <span class="sc">+</span></span>
<span id="cb246-13"><a href="network-visualization.html#cb246-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="at">size=</span><span class="dv">20</span>, <span class="at">col=</span><span class="st">&#39;lightblue&#39;</span>) <span class="sc">+</span></span>
<span id="cb246-14"><a href="network-visualization.html#cb246-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="at">label=</span><span class="fu">V</span>(g)<span class="sc">$</span>name) <span class="sc">+</span></span>
<span id="cb246-15"><a href="network-visualization.html#cb246-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/edge_label-1.png" width="672" /></p>
</div>
<div id="be-kind-to-the-color-blind" class="section level3" number="6.3.4">
<h3><span class="header-section-number">6.3.4</span> Be Kind to the Color Blind</h3>
<p>When selecting your color schemes, it is important to consider the impact of a particular color scheme on color blind readers. There is an excellent set of R scripts on GitHub in a package called <a href="https://github.com/clauswilke/colorblindr">colorblindr</a> which can help you do just that. I have slightly modified the code from the colorblindr package and created a script called <a href="data/colorblindr.R">colorblindr.R</a> which you can download and use to test out your network. Simply run the code in the script and then use the cvd_grid2() function on a ggplot or ggraph object to see simulated colors.</p>
<p>The chunk of code below loads the colorblindr.R script and then plots a figure using RColorBrewer color “Set2” in its original unmodified format and then as it might look to readers with some of the most common forms of color vision issues.</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="network-visualization.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(colorspace)</span>
<span id="cb247-2"><a href="network-visualization.html#cb247-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;data/colorblindr.R&quot;</span>)</span>
<span id="cb247-3"><a href="network-visualization.html#cb247-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cvd_grid2</span>(g1)</span></code></pre></div>
<p><img src="_main_files/figure-html/colorblind-1.png" width="960" /></p>
</div>
<div id="communities-and-groups" class="section level3" number="6.3.5">
<h3><span class="header-section-number">6.3.5</span> Communities and Groups</h3>
<p>Showing communities or other groups in network visualizations can be as simple as color coding nodes or edges as we have seen in many examples here. It is sometimes also useful to highlight groups by creating a convex hull or circle around the relevant points. This can be done in ggraph using the “geom_mark_hull” command within the ggforce package.</p>
<p>The following chunk of code provides a simple example using the Louvain clustering algorithm.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="network-visualization.html#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb248-2"><a href="network-visualization.html#cb248-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-3"><a href="network-visualization.html#cb248-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define clusters</span></span>
<span id="cb248-4"><a href="network-visualization.html#cb248-4" aria-hidden="true" tabindex="-1"></a>grp <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">cluster_louvain</span>(net2)<span class="sc">$</span>membership)</span>
<span id="cb248-5"><a href="network-visualization.html#cb248-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-6"><a href="network-visualization.html#cb248-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4343</span>)</span>
<span id="cb248-7"><a href="network-visualization.html#cb248-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(net2, <span class="at">layout =</span> <span class="st">&quot;fr&quot;</span>) <span class="sc">+</span></span>
<span id="cb248-8"><a href="network-visualization.html#cb248-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link0</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb248-9"><a href="network-visualization.html#cb248-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> grp), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">alpha=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb248-10"><a href="network-visualization.html#cb248-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create hull around points within group and label</span></span>
<span id="cb248-11"><a href="network-visualization.html#cb248-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mark_hull</span>(</span>
<span id="cb248-12"><a href="network-visualization.html#cb248-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(x, y, <span class="at">group =</span> grp, <span class="at">fill =</span> grp, <span class="at">label=</span>grp),</span>
<span id="cb248-13"><a href="network-visualization.html#cb248-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">concavity =</span> <span class="dv">4</span>,</span>
<span id="cb248-14"><a href="network-visualization.html#cb248-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">&quot;mm&quot;</span>),</span>
<span id="cb248-15"><a href="network-visualization.html#cb248-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">label.fontsize=</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb248-16"><a href="network-visualization.html#cb248-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="sc">+</span></span>
<span id="cb248-17"><a href="network-visualization.html#cb248-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/ggforce-1.png" width="768" /></p>
<p>The discussion of <a href="network-visualization.html#Figure_6_4">Figure 6.4</a> below provides another similar example. There are many more complicated ways of showing network groups provided by the examples covering figures from the book. For example, <a href="network-visualization.html#Figure_6_17">Figure 6.17</a> provides an example of the “group-in-a-box” technique using the NodeXL software package. <a href="network-visualization.html#Figure_6_18">Figure 6.18</a> illustrates the use of matrices as visualization tools and <a href="network-visualization.html#Figure_6_19">Figure 6.19</a> provides links to the Nodetrix hybrid visualization software.</p>
</div>
</div>
<div id="replicating-the-book-figures" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Replicating the Book Figures</h2>
<p>In this section we go through each figure in Chapter 6 of Brughmans and Peeples (2022) and detail how the final graph was created for all figures that were created using R. For those figures not created in R we describe what software and data were used and provide additional resources where available. We hope these examples will serve as inspiration for your own network visualization experiments. Some of these figures are relatively simple while others are quite complex. They are presented in the order they appear in the book.</p>
<div id="Figure_6_1" class="section level3" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> Figure 6.1: Manual Layout</h3>
<p>Figure 6.1. An example of an early hand drawn network graph (sociogram) published by Moreno (1932: 101). Moreno noted that the nodes at the top and bottom of the sociogram have the most connections and therefore represent the nodes of greatest importance. These specific “important” points are emphasized through both their size and their placement.</p>
<p>Note that the hand drawn version of this figure is presented in the book and this digital example is presented only for illustrative purposes. This shows how you can employ user defined layouts by directly supplying coordinates for the nodes in the plot. <a href="%22data/Moreno.csv%22">Download the Moreno data to follow along</a>.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="network-visualization.html#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb249-2"><a href="network-visualization.html#cb249-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb249-3"><a href="network-visualization.html#cb249-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-4"><a href="network-visualization.html#cb249-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in adjacency matrix of Moreno data and covert to network</span></span>
<span id="cb249-5"><a href="network-visualization.html#cb249-5" aria-hidden="true" tabindex="-1"></a>Moreno <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">read.csv</span>(<span class="st">&#39;data/Moreno.csv&#39;</span>,<span class="at">header=</span>T,<span class="at">row.names=</span><span class="dv">1</span>))</span>
<span id="cb249-6"><a href="network-visualization.html#cb249-6" aria-hidden="true" tabindex="-1"></a>g.Moreno <span class="ot">&lt;-</span> <span class="fu">graph_from_adjacency_matrix</span>(Moreno)</span>
<span id="cb249-7"><a href="network-visualization.html#cb249-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-8"><a href="network-visualization.html#cb249-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create xy coordinates associated with each node</span></span>
<span id="cb249-9"><a href="network-visualization.html#cb249-9" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">7</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="fl">2.5</span>,<span class="dv">6</span>,<span class="fl">2.5</span>,<span class="dv">4</span>,<span class="dv">1</span>),<span class="at">nrow=</span><span class="dv">9</span>,<span class="at">ncol=</span><span class="dv">2</span>,<span class="at">byrow=</span>T)</span>
<span id="cb249-10"><a href="network-visualization.html#cb249-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-11"><a href="network-visualization.html#cb249-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the network using layout = &quot;manual&quot; to place nodes using xy coordinates</span></span>
<span id="cb249-12"><a href="network-visualization.html#cb249-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(g.Moreno, <span class="at">layout =</span> <span class="st">&quot;manual&quot;</span>,</span>
<span id="cb249-13"><a href="network-visualization.html#cb249-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span>xy[,<span class="dv">1</span>], <span class="at">y=</span>xy[,<span class="dv">2</span>]) <span class="sc">+</span></span>
<span id="cb249-14"><a href="network-visualization.html#cb249-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>() <span class="sc">+</span></span>
<span id="cb249-15"><a href="network-visualization.html#cb249-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="at">fill=</span><span class="st">&#39;white&#39;</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> igraph<span class="sc">::</span><span class="fu">degree</span>(g.Moreno)) <span class="sc">+</span></span>
<span id="cb249-16"><a href="network-visualization.html#cb249-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb249-17"><a href="network-visualization.html#cb249-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig6_1-1.png" width="192" /></p>
</div>
<div id="Figure_6_2" class="section level3" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> Figure 6.2: Examples of Common Network Plot Formats</h3>
<p>Figure 6.2. These plots are all different visual representations of the same network data from Peeples’s (2018) data where edges are defined based on the technological similarities of cooking pots from each node which represent archaeological settlements.</p>
<p>The code below creates each of the individual figures and then compiles them into a single composite figure for plotting.</p>
<p>First read in the data (<a href="data/Peeples2018.Rdata">all data are combined in a single RData file here</a>).</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="network-visualization.html#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb250-2"><a href="network-visualization.html#cb250-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statnet)</span>
<span id="cb250-3"><a href="network-visualization.html#cb250-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(intergraph)</span>
<span id="cb250-4"><a href="network-visualization.html#cb250-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplotify)</span>
<span id="cb250-5"><a href="network-visualization.html#cb250-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb250-6"><a href="network-visualization.html#cb250-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb250-7"><a href="network-visualization.html#cb250-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-8"><a href="network-visualization.html#cb250-8" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file=</span><span class="st">&quot;data/Peeples2018.Rdata&quot;</span>)</span>
<span id="cb250-9"><a href="network-visualization.html#cb250-9" aria-hidden="true" tabindex="-1"></a><span class="do">## contains objects</span></span>
<span id="cb250-10"><a href="network-visualization.html#cb250-10" aria-hidden="true" tabindex="-1"></a><span class="co"># site_info - site locations and attributes</span></span>
<span id="cb250-11"><a href="network-visualization.html#cb250-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ceramicBR - raw Brainard-Robinson similarity among sites</span></span>
<span id="cb250-12"><a href="network-visualization.html#cb250-12" aria-hidden="true" tabindex="-1"></a><span class="co"># BRnet - binary network with similarity values &gt; 0.65 defined as edges in statnet/network format</span></span>
<span id="cb250-13"><a href="network-visualization.html#cb250-13" aria-hidden="true" tabindex="-1"></a><span class="co"># BRnet_w - weighted network with edges (&gt;0.65) given weight values based on BR similarity in statnet/network format</span></span>
<span id="cb250-14"><a href="network-visualization.html#cb250-14" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span></code></pre></div>
<p>Fig 6.2a - A simple network graph with nodes placed based on the Fruchterman-Reingold algorithm</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="network-visualization.html#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="do">## create simple graph with Fruchterman-Reingold layout</span></span>
<span id="cb251-2"><a href="network-visualization.html#cb251-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">423</span>)</span>
<span id="cb251-3"><a href="network-visualization.html#cb251-3" aria-hidden="true" tabindex="-1"></a>F6<span class="fl">.2</span>a <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(BRnet, <span class="st">&quot;fr&quot;</span>) <span class="sc">+</span></span>
<span id="cb251-4"><a href="network-visualization.html#cb251-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">edge_colour =</span> <span class="st">&quot;grey66&quot;</span>) <span class="sc">+</span></span>
<span id="cb251-5"><a href="network-visualization.html#cb251-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> <span class="dv">5</span>), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb251-6"><a href="network-visualization.html#cb251-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span>
<span id="cb251-7"><a href="network-visualization.html#cb251-7" aria-hidden="true" tabindex="-1"></a>F6<span class="fl">.2</span>a</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig6_2a-1.png" width="576" /></p>
<p>Fig 6.2b - Network graph nodes with placed based on the real geographic locations of settlements and are color coded based on sub-regions.</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="network-visualization.html#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="do">## create graph with layout determined by site location and nodes color coded by region</span></span>
<span id="cb252-2"><a href="network-visualization.html#cb252-2" aria-hidden="true" tabindex="-1"></a>F6<span class="fl">.2</span>b <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(BRnet, <span class="st">&quot;manual&quot;</span>,</span>
<span id="cb252-3"><a href="network-visualization.html#cb252-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> site_info<span class="sc">$</span>x,</span>
<span id="cb252-4"><a href="network-visualization.html#cb252-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> site_info<span class="sc">$</span>y) <span class="sc">+</span></span>
<span id="cb252-5"><a href="network-visualization.html#cb252-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">edge_colour =</span> <span class="st">&quot;grey66&quot;</span>) <span class="sc">+</span></span>
<span id="cb252-6"><a href="network-visualization.html#cb252-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> <span class="dv">2</span>,<span class="at">col=</span>site_info<span class="sc">$</span>Region), <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb252-7"><a href="network-visualization.html#cb252-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span>
<span id="cb252-8"><a href="network-visualization.html#cb252-8" aria-hidden="true" tabindex="-1"></a>F6<span class="fl">.2</span>b</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig6_2b-1.png" width="576" /></p>
<p>Fig 6.2c - A graph designed to show how many different kinds of information can be combined in a single network plot. In this network graph node placement is defined by the stress majorization algorithm (see below), with nodes color coded based on region, with different symbols for different kinds of public architectural features found at those sites, and with nodes scaled based on betweenness centrality scores. The line weight of each edge is used to indicate relative tie-strength.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="network-visualization.html#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create vectors of attributes and betweenness centrality and plot network</span></span>
<span id="cb253-2"><a href="network-visualization.html#cb253-2" aria-hidden="true" tabindex="-1"></a><span class="co"># with nodes color coded by region, sized by betweenness, with symbols representing</span></span>
<span id="cb253-3"><a href="network-visualization.html#cb253-3" aria-hidden="true" tabindex="-1"></a><span class="co"># public architectural features, and with edges weighted by BR similarity</span></span>
<span id="cb253-4"><a href="network-visualization.html#cb253-4" aria-hidden="true" tabindex="-1"></a>col1 <span class="ot">&lt;-</span> <span class="fu">as.factor</span>((site_info<span class="sc">$</span>Great.Kiva))</span>
<span id="cb253-5"><a href="network-visualization.html#cb253-5" aria-hidden="true" tabindex="-1"></a>col2 <span class="ot">&lt;-</span> <span class="fu">as.factor</span>((site_info<span class="sc">$</span>Region))</span>
<span id="cb253-6"><a href="network-visualization.html#cb253-6" aria-hidden="true" tabindex="-1"></a>bw <span class="ot">&lt;-</span> sna<span class="sc">::</span><span class="fu">betweenness</span>(BRnet_w)</span>
<span id="cb253-7"><a href="network-visualization.html#cb253-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-8"><a href="network-visualization.html#cb253-8" aria-hidden="true" tabindex="-1"></a>F6<span class="fl">.2</span>c <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(BRnet_w, <span class="st">&quot;stress&quot;</span>) <span class="sc">+</span></span>
<span id="cb253-9"><a href="network-visualization.html#cb253-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width =</span> weight, <span class="at">alpha=</span>weight), <span class="at">edge_colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb253-10"><a href="network-visualization.html#cb253-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb253-11"><a href="network-visualization.html#cb253-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> bw, <span class="at">shape=</span> col1, <span class="at">fill=</span>col1, <span class="at">col=</span>site_info<span class="sc">$</span>Region), <span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb253-12"><a href="network-visualization.html#cb253-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>() <span class="sc">+</span></span>
<span id="cb253-13"><a href="network-visualization.html#cb253-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">12</span>)) <span class="sc">+</span></span>
<span id="cb253-14"><a href="network-visualization.html#cb253-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span>
<span id="cb253-15"><a href="network-visualization.html#cb253-15" aria-hidden="true" tabindex="-1"></a>F6<span class="fl">.2</span>c</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig6_2c-1.png" width="576" /></p>
<p>Fig. 6.2d - This network graph is laid out using the Kamada-Kawai force directed algorithm with nodes color coded based on communities detected using the Louvain community detection algorithm. Each community is also indicated by a circle highlighting the relevant nodes. Edges within communities are shown in black and edges between communities are shown in red.</p>
<p>In this plot we use the “as.ggplot” function to convert a traditional igraph plot to a ggraph plot to illustrate how this can be done.</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="network-visualization.html#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert network object to igraph object and calculate Louvain cluster membership plot and convert to grob </span></span>
<span id="cb254-2"><a href="network-visualization.html#cb254-2" aria-hidden="true" tabindex="-1"></a><span class="co"># to combine in ggplot</span></span>
<span id="cb254-3"><a href="network-visualization.html#cb254-3" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">asIgraph</span>(BRnet_w)</span>
<span id="cb254-4"><a href="network-visualization.html#cb254-4" aria-hidden="true" tabindex="-1"></a>clst <span class="ot">&lt;-</span> <span class="fu">cluster_louvain</span>(g)</span>
<span id="cb254-5"><a href="network-visualization.html#cb254-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-6"><a href="network-visualization.html#cb254-6" aria-hidden="true" tabindex="-1"></a>F6<span class="fl">.2</span>d <span class="ot">&lt;-</span> <span class="fu">as.ggplot</span>(<span class="sc">~</span><span class="fu">plot</span>(clst, g, <span class="at">layout=</span>layout_with_kk, <span class="at">vertex.label=</span><span class="cn">NA</span>, <span class="at">vertex.size=</span><span class="dv">10</span>, <span class="at">col=</span><span class="fu">rainbow</span>(<span class="dv">4</span>)[clst<span class="sc">$</span>membership]))</span>
<span id="cb254-7"><a href="network-visualization.html#cb254-7" aria-hidden="true" tabindex="-1"></a>F6<span class="fl">.2</span>d</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig6_2d-1.png" width="576" /></p>
<p>Finally, we use the “ggarrange” function from the “ggpubr” package to combine all of these plots into a single composite plot.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="network-visualization.html#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all plots into a single figure using ggarrange</span></span>
<span id="cb255-2"><a href="network-visualization.html#cb255-2" aria-hidden="true" tabindex="-1"></a>figure_6_2 <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(F6<span class="fl">.2</span>a,F6<span class="fl">.2</span>b,F6<span class="fl">.2</span>c,F6<span class="fl">.2</span>d,<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>,<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&#39;(a)&#39;</span>,<span class="st">&#39;(b)&#39;</span>,<span class="st">&#39;(c)&#39;</span>,<span class="st">&#39;(d)&#39;</span>), <span class="at">font.label=</span><span class="fu">list</span>(<span class="at">size=</span><span class="dv">22</span>))</span>
<span id="cb255-3"><a href="network-visualization.html#cb255-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-4"><a href="network-visualization.html#cb255-4" aria-hidden="true" tabindex="-1"></a>figure_6_2</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig6_2_all-1.png" width="768" /></p>
</div>
<div id="Figure_6_3" class="section level3" number="6.4.3">
<h3><span class="header-section-number">6.4.3</span> Figure 6.3: Examples of Rare Network Plot Formats</h3>
<p>Figure 6.3. More visualizations using the Cibola technological similarity data.</p>
<p>Fig 6.3a - A weighted heat plot of the underlying similarity matrix with hierarchical clusters shown on each axis. This plot relies on a packages called “superheat” that produces plots formatted as we see here.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="network-visualization.html#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb256-2"><a href="network-visualization.html#cb256-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statnet)</span>
<span id="cb256-3"><a href="network-visualization.html#cb256-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(intergraph)</span>
<span id="cb256-4"><a href="network-visualization.html#cb256-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb256-5"><a href="network-visualization.html#cb256-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplotify)</span>
<span id="cb256-6"><a href="network-visualization.html#cb256-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(superheat)</span>
<span id="cb256-7"><a href="network-visualization.html#cb256-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-8"><a href="network-visualization.html#cb256-8" aria-hidden="true" tabindex="-1"></a>ceramicBRa <span class="ot">&lt;-</span> ceramicBR</span>
<span id="cb256-9"><a href="network-visualization.html#cb256-9" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(ceramicBRa) <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb256-10"><a href="network-visualization.html#cb256-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-11"><a href="network-visualization.html#cb256-11" aria-hidden="true" tabindex="-1"></a>F6<span class="fl">.3</span>a <span class="ot">&lt;-</span> <span class="fu">as.ggplot</span>(<span class="sc">~</span><span class="fu">superheat</span>(ceramicBRa, </span>
<span id="cb256-12"><a href="network-visualization.html#cb256-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.dendrogram =</span> T, </span>
<span id="cb256-13"><a href="network-visualization.html#cb256-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">col.dendrogram =</span> T,</span>
<span id="cb256-14"><a href="network-visualization.html#cb256-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">grid.hline.col =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb256-15"><a href="network-visualization.html#cb256-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">grid.vline.col =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb256-16"><a href="network-visualization.html#cb256-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend=</span>F,</span>
<span id="cb256-17"><a href="network-visualization.html#cb256-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">left.label.size=</span><span class="dv">0</span>,</span>
<span id="cb256-18"><a href="network-visualization.html#cb256-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">bottom.label.size=</span><span class="dv">0</span>))</span>
<span id="cb256-19"><a href="network-visualization.html#cb256-19" aria-hidden="true" tabindex="-1"></a>F6<span class="fl">.3</span>a</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig6_3a-1.png" width="576" /></p>
<p>Fig. 6.3b - An arcplot with within group ties shown above the plot and between group ties shown below.</p>
<p>For this plot, we read in a adjacency matrix that is ordered in the order we want it to show up in the final plot. <a href="data/Peeples_arcplot.csv">Download the file here</a> to follow along.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="network-visualization.html#cb257-1" aria-hidden="true" tabindex="-1"></a>arc_dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&#39;data/Peeples_arcplot.csv&#39;</span>,<span class="at">header=</span>T,<span class="at">row.names=</span><span class="dv">1</span>)</span>
<span id="cb257-2"><a href="network-visualization.html#cb257-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">graph_from_adjacency_matrix</span>(<span class="fu">as.matrix</span>(<span class="fu">t</span>(arc_dat)))</span>
<span id="cb257-3"><a href="network-visualization.html#cb257-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-4"><a href="network-visualization.html#cb257-4" aria-hidden="true" tabindex="-1"></a>grp <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co"># set groups for color</span></span>
<span id="cb257-5"><a href="network-visualization.html#cb257-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-6"><a href="network-visualization.html#cb257-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the graph</span></span>
<span id="cb257-7"><a href="network-visualization.html#cb257-7" aria-hidden="true" tabindex="-1"></a>F6<span class="fl">.3</span>b <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(g, <span class="at">layout=</span><span class="st">&quot;linear&quot;</span>) <span class="sc">+</span> </span>
<span id="cb257-8"><a href="network-visualization.html#cb257-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_arc</span>(<span class="at">edge_colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">edge_alpha=</span><span class="fl">0.2</span>, <span class="at">edge_width=</span><span class="fl">0.7</span>, <span class="at">fold=</span>F, <span class="at">strength=</span><span class="dv">1</span>, <span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb257-9"><a href="network-visualization.html#cb257-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size=</span>igraph<span class="sc">::</span><span class="fu">degree</span>(g), <span class="at">color=</span>grp, <span class="at">fill=</span>grp), <span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb257-10"><a href="network-visualization.html#cb257-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb257-11"><a href="network-visualization.html#cb257-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>() </span>
<span id="cb257-12"><a href="network-visualization.html#cb257-12" aria-hidden="true" tabindex="-1"></a>F6<span class="fl">.3</span>b</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig6_3b-1.png" width="576" /></p>
<p>Fig. 6.3c - Network plot with sites in geographic locations and edges bundled using the edge bundling hammer routine.</p>
<p>This function requires the “edgebundle” package be installed and uses the <a href="data/Peeples2018.Rdata">Cibola technological similarity data</a>.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="network-visualization.html#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(edgebundle)</span>
<span id="cb258-2"><a href="network-visualization.html#cb258-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/Peeples2018.Rdata&quot;</span>)</span>
<span id="cb258-3"><a href="network-visualization.html#cb258-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-4"><a href="network-visualization.html#cb258-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create attribute file with rquired data</span></span>
<span id="cb258-5"><a href="network-visualization.html#cb258-5" aria-hidden="true" tabindex="-1"></a>xy<span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(site_info[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb258-6"><a href="network-visualization.html#cb258-6" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">cbind</span>(xy,site_info<span class="sc">$</span>Region)</span>
<span id="cb258-7"><a href="network-visualization.html#cb258-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(xy) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;x&#39;</span>,<span class="st">&#39;y&#39;</span>,<span class="st">&#39;Region&#39;</span>)</span>
<span id="cb258-8"><a href="network-visualization.html#cb258-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-9"><a href="network-visualization.html#cb258-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Run hammer bundling routine </span></span>
<span id="cb258-10"><a href="network-visualization.html#cb258-10" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">asIgraph</span>(BRnet)</span>
<span id="cb258-11"><a href="network-visualization.html#cb258-11" aria-hidden="true" tabindex="-1"></a>hbundle <span class="ot">&lt;-</span> <span class="fu">edge_bundle_hammer</span>(g,xy,<span class="at">bw =</span> <span class="dv">5</span>, <span class="at">decay =</span> <span class="fl">0.3</span>)</span>
<span id="cb258-12"><a href="network-visualization.html#cb258-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb258-13"><a href="network-visualization.html#cb258-13" aria-hidden="true" tabindex="-1"></a>F6<span class="fl">.3</span>c <span class="ot">&lt;-</span>   <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb258-14"><a href="network-visualization.html#cb258-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(<span class="at">data =</span> hbundle,<span class="fu">aes</span>(x,y,<span class="at">group=</span>group),<span class="at">col=</span><span class="st">&quot;gray66&quot;</span>,<span class="at">size=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb258-15"><a href="network-visualization.html#cb258-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> xy,<span class="fu">aes</span>(x,y,<span class="at">col=</span>Region),<span class="at">size=</span><span class="dv">5</span>,<span class="at">alpha=</span><span class="fl">0.75</span>, <span class="at">show.legend=</span>F)<span class="sc">+</span></span>
<span id="cb258-16"><a href="network-visualization.html#cb258-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_void</span>()</span>
<span id="cb258-17"><a href="network-visualization.html#cb258-17" aria-hidden="true" tabindex="-1"></a>F6<span class="fl">.3</span>c</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig6_3c-1.png" width="576" /></p>
<p>Fig. 6.3d - Network graph where nodes are replaced by waffle plots that show relative frequencies of the most common ceramic technological clusters.</p>
<p>This is a somewhat complicated plot that requires a couple of specialized libraries and additional steps along the way. We provide comments in the code below to help you follow along. Essentially the routine creates a series of waffle plots and then uses them as annotation to replace the nodes in the final ggraph.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="network-visualization.html#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize libraries</span></span>
<span id="cb259-2"><a href="network-visualization.html#cb259-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggwaffle)</span>
<span id="cb259-3"><a href="network-visualization.html#cb259-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb259-4"><a href="network-visualization.html#cb259-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-5"><a href="network-visualization.html#cb259-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create igraph object from data imported above</span></span>
<span id="cb259-6"><a href="network-visualization.html#cb259-6" aria-hidden="true" tabindex="-1"></a>Cibola_adj <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">&quot;data/Cibola_adj.csv&quot;</span>, <span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">row.names=</span><span class="dv">1</span>)</span>
<span id="cb259-7"><a href="network-visualization.html#cb259-7" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">graph_from_adjacency_matrix</span>(<span class="fu">as.matrix</span>(Cibola_adj), <span class="at">mode=</span><span class="st">&quot;undirected&quot;</span>)</span>
<span id="cb259-8"><a href="network-visualization.html#cb259-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-9"><a href="network-visualization.html#cb259-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Import raw ceramic data and convert to proportions</span></span>
<span id="cb259-10"><a href="network-visualization.html#cb259-10" aria-hidden="true" tabindex="-1"></a>ceramic_clust <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">&quot;data/Cibola_clust.csv&quot;</span>, <span class="at">header=</span>T, <span class="at">row.names=</span><span class="dv">1</span>)</span>
<span id="cb259-11"><a href="network-visualization.html#cb259-11" aria-hidden="true" tabindex="-1"></a>ceramic.p <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(<span class="fu">as.matrix</span>(ceramic_clust), <span class="at">margin=</span><span class="dv">1</span>)</span>
<span id="cb259-12"><a href="network-visualization.html#cb259-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-13"><a href="network-visualization.html#cb259-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign vertex attributes to the network object g which represent columns in the ceramic.p table</span></span>
<span id="cb259-14"><a href="network-visualization.html#cb259-14" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>C1 <span class="ot">&lt;-</span> ceramic.p[,<span class="dv">1</span>]</span>
<span id="cb259-15"><a href="network-visualization.html#cb259-15" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>C2 <span class="ot">&lt;-</span> ceramic.p[,<span class="dv">2</span>]</span>
<span id="cb259-16"><a href="network-visualization.html#cb259-16" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>C3 <span class="ot">&lt;-</span> ceramic.p[,<span class="dv">3</span>]</span>
<span id="cb259-17"><a href="network-visualization.html#cb259-17" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>C4 <span class="ot">&lt;-</span> ceramic.p[,<span class="dv">4</span>]</span>
<span id="cb259-18"><a href="network-visualization.html#cb259-18" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>C5 <span class="ot">&lt;-</span> ceramic.p[,<span class="dv">5</span>]</span>
<span id="cb259-19"><a href="network-visualization.html#cb259-19" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>C6 <span class="ot">&lt;-</span> ceramic.p[,<span class="dv">6</span>]</span>
<span id="cb259-20"><a href="network-visualization.html#cb259-20" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>C7 <span class="ot">&lt;-</span> ceramic.p[,<span class="dv">7</span>]</span>
<span id="cb259-21"><a href="network-visualization.html#cb259-21" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>C8 <span class="ot">&lt;-</span> ceramic.p[,<span class="dv">8</span>]</span>
<span id="cb259-22"><a href="network-visualization.html#cb259-22" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>C9 <span class="ot">&lt;-</span> ceramic.p[,<span class="dv">9</span>]</span>
<span id="cb259-23"><a href="network-visualization.html#cb259-23" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>C10 <span class="ot">&lt;-</span> ceramic.p[,<span class="dv">10</span>]</span>
<span id="cb259-24"><a href="network-visualization.html#cb259-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb259-25"><a href="network-visualization.html#cb259-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Precompute the layout and assign coordinates as x and y in network g</span></span>
<span id="cb259-26"><a href="network-visualization.html#cb259-26" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">345434534</span>)</span>
<span id="cb259-27"><a href="network-visualization.html#cb259-27" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">layout_with_fr</span>(g)</span>
<span id="cb259-28"><a href="network-visualization.html#cb259-28" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>x <span class="ot">&lt;-</span> xy[, <span class="dv">1</span>]</span>
<span id="cb259-29"><a href="network-visualization.html#cb259-29" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>y <span class="ot">&lt;-</span> xy[, <span class="dv">2</span>]</span>
<span id="cb259-30"><a href="network-visualization.html#cb259-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-31"><a href="network-visualization.html#cb259-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame that contains the 4 most common categories in the ceramic table,</span></span>
<span id="cb259-32"><a href="network-visualization.html#cb259-32" aria-hidden="true" tabindex="-1"></a><span class="co"># the node id, and the proportion of that ceramic category at that node</span></span>
<span id="cb259-33"><a href="network-visualization.html#cb259-33" aria-hidden="true" tabindex="-1"></a>nodes_wide <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">as_data_frame</span>(g, <span class="st">&quot;vertices&quot;</span>)</span>
<span id="cb259-34"><a href="network-visualization.html#cb259-34" aria-hidden="true" tabindex="-1"></a>nodes_long <span class="ot">&lt;-</span> nodes_wide <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(C1<span class="sc">:</span>C4) <span class="sc">%&gt;%</span></span>
<span id="cb259-35"><a href="network-visualization.html#cb259-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(nodes_wide)) <span class="sc">%&gt;%</span></span>
<span id="cb259-36"><a href="network-visualization.html#cb259-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="st">&quot;attr&quot;</span>, <span class="st">&quot;value&quot;</span>, C1<span class="sc">:</span>C4)</span>
<span id="cb259-37"><a href="network-visualization.html#cb259-37" aria-hidden="true" tabindex="-1"></a>nodes_out <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb259-38"><a href="network-visualization.html#cb259-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(nodes_long)) {</span>
<span id="cb259-39"><a href="network-visualization.html#cb259-39" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">&quot;rbind&quot;</span>, <span class="fu">replicate</span>(<span class="fu">round</span>(nodes_long[j,]<span class="sc">$</span>value<span class="sc">*</span><span class="dv">50</span>,<span class="dv">0</span>), nodes_long[j,], <span class="at">simplify =</span> <span class="cn">FALSE</span>))</span>
<span id="cb259-40"><a href="network-visualization.html#cb259-40" aria-hidden="true" tabindex="-1"></a>  nodes_out <span class="ot">&lt;-</span> <span class="fu">rbind</span>(nodes_out,temp)</span>
<span id="cb259-41"><a href="network-visualization.html#cb259-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb259-42"><a href="network-visualization.html#cb259-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb259-43"><a href="network-visualization.html#cb259-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a list object for the call to each bar chart by node</span></span>
<span id="cb259-44"><a href="network-visualization.html#cb259-44" aria-hidden="true" tabindex="-1"></a>bar_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">vcount</span>(g), <span class="cf">function</span>(i) {</span>
<span id="cb259-45"><a href="network-visualization.html#cb259-45" aria-hidden="true" tabindex="-1"></a>  gt_plot <span class="ot">&lt;-</span> <span class="fu">ggplotGrob</span>(</span>
<span id="cb259-46"><a href="network-visualization.html#cb259-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">waffle_iron</span>(nodes_out[nodes_out<span class="sc">$</span>id <span class="sc">==</span> i, ], <span class="fu">aes_d</span>(<span class="at">group=</span>attr))) <span class="sc">+</span></span>
<span id="cb259-47"><a href="network-visualization.html#cb259-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_waffle</span>(<span class="fu">aes</span>(x, y, <span class="at">fill =</span> group), <span class="at">size=</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb259-48"><a href="network-visualization.html#cb259-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb259-49"><a href="network-visualization.html#cb259-49" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb259-50"><a href="network-visualization.html#cb259-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(</span>
<span id="cb259-51"><a href="network-visualization.html#cb259-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb259-52"><a href="network-visualization.html#cb259-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">colour =</span> <span class="cn">NA</span>),</span>
<span id="cb259-53"><a href="network-visualization.html#cb259-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">line =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb259-54"><a href="network-visualization.html#cb259-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_blank</span>()</span>
<span id="cb259-55"><a href="network-visualization.html#cb259-55" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb259-56"><a href="network-visualization.html#cb259-56" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb259-57"><a href="network-visualization.html#cb259-57" aria-hidden="true" tabindex="-1"></a>  panel_coords <span class="ot">&lt;-</span> gt_plot<span class="sc">$</span>layout[gt_plot<span class="sc">$</span>layout<span class="sc">$</span>name <span class="sc">==</span> <span class="st">&quot;panel&quot;</span>, ]</span>
<span id="cb259-58"><a href="network-visualization.html#cb259-58" aria-hidden="true" tabindex="-1"></a>  gt_plot[panel_coords<span class="sc">$</span>t<span class="sc">:</span>panel_coords<span class="sc">$</span>b, panel_coords<span class="sc">$</span>l<span class="sc">:</span>panel_coords<span class="sc">$</span>r]</span>
<span id="cb259-59"><a href="network-visualization.html#cb259-59" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb259-60"><a href="network-visualization.html#cb259-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-61"><a href="network-visualization.html#cb259-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the results above into custom annotation</span></span>
<span id="cb259-62"><a href="network-visualization.html#cb259-62" aria-hidden="true" tabindex="-1"></a>annot_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">vcount</span>(g), <span class="cf">function</span>(i) {</span>
<span id="cb259-63"><a href="network-visualization.html#cb259-63" aria-hidden="true" tabindex="-1"></a>  xmin <span class="ot">&lt;-</span> nodes_wide<span class="sc">$</span>x[i] <span class="sc">-</span> .<span class="dv">2</span></span>
<span id="cb259-64"><a href="network-visualization.html#cb259-64" aria-hidden="true" tabindex="-1"></a>  xmax <span class="ot">&lt;-</span> nodes_wide<span class="sc">$</span>x[i] <span class="sc">+</span> .<span class="dv">2</span></span>
<span id="cb259-65"><a href="network-visualization.html#cb259-65" aria-hidden="true" tabindex="-1"></a>  ymin <span class="ot">&lt;-</span> nodes_wide<span class="sc">$</span>y[i] <span class="sc">-</span> .<span class="dv">2</span></span>
<span id="cb259-66"><a href="network-visualization.html#cb259-66" aria-hidden="true" tabindex="-1"></a>  ymax <span class="ot">&lt;-</span> nodes_wide<span class="sc">$</span>y[i] <span class="sc">+</span> .<span class="dv">2</span></span>
<span id="cb259-67"><a href="network-visualization.html#cb259-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_custom</span>(</span>
<span id="cb259-68"><a href="network-visualization.html#cb259-68" aria-hidden="true" tabindex="-1"></a>    bar_list[[i]],</span>
<span id="cb259-69"><a href="network-visualization.html#cb259-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> xmin,</span>
<span id="cb259-70"><a href="network-visualization.html#cb259-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> xmax,</span>
<span id="cb259-71"><a href="network-visualization.html#cb259-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> ymin,</span>
<span id="cb259-72"><a href="network-visualization.html#cb259-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> ymax</span>
<span id="cb259-73"><a href="network-visualization.html#cb259-73" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb259-74"><a href="network-visualization.html#cb259-74" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb259-75"><a href="network-visualization.html#cb259-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-76"><a href="network-visualization.html#cb259-76" aria-hidden="true" tabindex="-1"></a><span class="co"># create basic network</span></span>
<span id="cb259-77"><a href="network-visualization.html#cb259-77" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(g, <span class="st">&quot;manual&quot;</span>, <span class="at">x =</span> <span class="fu">V</span>(g)<span class="sc">$</span>x, <span class="at">y =</span> <span class="fu">V</span>(g)<span class="sc">$</span>y) <span class="sc">+</span></span>
<span id="cb259-78"><a href="network-visualization.html#cb259-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link0</span>() <span class="sc">+</span></span>
<span id="cb259-79"><a href="network-visualization.html#cb259-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>() <span class="sc">+</span></span>
<span id="cb259-80"><a href="network-visualization.html#cb259-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span>
<span id="cb259-81"><a href="network-visualization.html#cb259-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-82"><a href="network-visualization.html#cb259-82" aria-hidden="true" tabindex="-1"></a><span class="co"># put everything together by combining with the annotation (bar plots + network)</span></span>
<span id="cb259-83"><a href="network-visualization.html#cb259-83" aria-hidden="true" tabindex="-1"></a>F6<span class="fl">.3</span>d<span class="ot">&lt;-</span> <span class="fu">Reduce</span>(<span class="st">&quot;+&quot;</span>, annot_list, p)</span>
<span id="cb259-84"><a href="network-visualization.html#cb259-84" aria-hidden="true" tabindex="-1"></a>F6<span class="fl">.3</span>d</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig6_3d-1.png" width="576" /></p>
<p>Combine all of the plots into a single figure</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="network-visualization.html#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb260-2"><a href="network-visualization.html#cb260-2" aria-hidden="true" tabindex="-1"></a>figure_6_3 <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(F6<span class="fl">.3</span>a,F6<span class="fl">.3</span>b,F6<span class="fl">.3</span>c,F6<span class="fl">.3</span>d, <span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>,<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&#39;(a)&#39;</span>,<span class="st">&#39;(b)&#39;</span>,<span class="st">&#39;(c)&#39;</span>,<span class="st">&#39;(d)&#39;</span>), <span class="at">font.label=</span><span class="fu">list</span>(<span class="at">size=</span><span class="dv">22</span>))</span>
<span id="cb260-3"><a href="network-visualization.html#cb260-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-4"><a href="network-visualization.html#cb260-4" aria-hidden="true" tabindex="-1"></a>figure_6_3</span></code></pre></div>
<p><img src="images/Figure_6_3.jpg.jpeg" style="width:100.0%" /></p>
</div>
<div id="Figure_6_4" class="section level3" number="6.4.4">
<h3><span class="header-section-number">6.4.4</span> Figure 6.4: Simple Network with Clusters</h3>
<p>Figure 6.4 is a network of shared lithic material sources among Clovis sites in western North America.</p>
<p>This example shows how to define and indicate groups and label points.</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="network-visualization.html#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb261-2"><a href="network-visualization.html#cb261-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb261-3"><a href="network-visualization.html#cb261-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statnet)</span>
<span id="cb261-4"><a href="network-visualization.html#cb261-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb261-5"><a href="network-visualization.html#cb261-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-6"><a href="network-visualization.html#cb261-6" aria-hidden="true" tabindex="-1"></a>Clovis <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/Clovis.csv&quot;</span>, <span class="at">header=</span>T, <span class="at">row.names=</span><span class="dv">1</span>)</span>
<span id="cb261-7"><a href="network-visualization.html#cb261-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Clovis) <span class="ot">&lt;-</span> <span class="fu">row.names</span>(Clovis)</span>
<span id="cb261-8"><a href="network-visualization.html#cb261-8" aria-hidden="true" tabindex="-1"></a>graph <span class="ot">&lt;-</span> <span class="fu">graph_from_adjacency_matrix</span>(<span class="fu">as.matrix</span>(Clovis),<span class="at">mode=</span><span class="st">&quot;undirected&quot;</span>, <span class="at">diag=</span>F)</span>
<span id="cb261-9"><a href="network-visualization.html#cb261-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-10"><a href="network-visualization.html#cb261-10" aria-hidden="true" tabindex="-1"></a>bw <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">betweenness</span>(graph)</span>
<span id="cb261-11"><a href="network-visualization.html#cb261-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-12"><a href="network-visualization.html#cb261-12" aria-hidden="true" tabindex="-1"></a>grp <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">cluster_louvain</span>(graph)<span class="sc">$</span>membership)</span>
<span id="cb261-13"><a href="network-visualization.html#cb261-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-14"><a href="network-visualization.html#cb261-14" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">43643548</span>)</span>
<span id="cb261-15"><a href="network-visualization.html#cb261-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(graph, <span class="at">layout =</span> <span class="st">&quot;fr&quot;</span>) <span class="sc">+</span></span>
<span id="cb261-16"><a href="network-visualization.html#cb261-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">edge_width=</span><span class="dv">1</span>, <span class="at">color=</span><span class="st">&#39;gray&#39;</span>) <span class="sc">+</span></span>
<span id="cb261-17"><a href="network-visualization.html#cb261-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> grp, <span class="at">size=</span>bw, <span class="at">color=</span>grp), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">alpha=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb261-18"><a href="network-visualization.html#cb261-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb261-19"><a href="network-visualization.html#cb261-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mark_hull</span>(</span>
<span id="cb261-20"><a href="network-visualization.html#cb261-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(x, y, <span class="at">group =</span> grp, <span class="at">fill =</span> grp, <span class="at">label=</span>grp, <span class="at">color=</span><span class="cn">NA</span>),</span>
<span id="cb261-21"><a href="network-visualization.html#cb261-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">concavity =</span> <span class="dv">4</span>,</span>
<span id="cb261-22"><a href="network-visualization.html#cb261-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">&quot;mm&quot;</span>),</span>
<span id="cb261-23"><a href="network-visualization.html#cb261-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">label.fontsize=</span><span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb261-24"><a href="network-visualization.html#cb261-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="sc">+</span></span>
<span id="cb261-25"><a href="network-visualization.html#cb261-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="sc">+</span></span>
<span id="cb261-26"><a href="network-visualization.html#cb261-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.3</span>), <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb261-27"><a href="network-visualization.html#cb261-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(bw <span class="sc">&gt;</span> <span class="dv">40</span>, <span class="fu">as.character</span>(name), <span class="cn">NA_character_</span>)), <span class="at">size=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb261-28"><a href="network-visualization.html#cb261-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()<span class="sc">+</span></span>
<span id="cb261-29"><a href="network-visualization.html#cb261-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig6_4-1.png" width="768" /></p>
</div>
<div id="Figure_6_5" class="section level3" number="6.4.5">
<h3><span class="header-section-number">6.4.5</span> Figure 6.5: Interactive Layout</h3>
<p>Figure 6.5 was produced in NetDraw by creating a simple network and just creating two configurations of nodes. There are a few options for creating a similar figure in R. The simplest is to use an igraph network object and the “tkplot” function. This function brings up a window that lets you drag and move nodes (with or without an initial algorithmic layout) and when you’re done you can assign the new positions to a variable to use for plotting. <a href="data/Peeples2018.Rdata">Use these data</a> to follow along.</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="network-visualization.html#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb262-2"><a href="network-visualization.html#cb262-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(intergraph)</span>
<span id="cb262-3"><a href="network-visualization.html#cb262-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-4"><a href="network-visualization.html#cb262-4" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/Peeples2018.Rdata&quot;</span>)</span>
<span id="cb262-5"><a href="network-visualization.html#cb262-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-6"><a href="network-visualization.html#cb262-6" aria-hidden="true" tabindex="-1"></a>Cibola_i <span class="ot">&lt;-</span> <span class="fu">asIgraph</span>(BRnet)</span>
<span id="cb262-7"><a href="network-visualization.html#cb262-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-8"><a href="network-visualization.html#cb262-8" aria-hidden="true" tabindex="-1"></a>locs <span class="ot">&lt;-</span> <span class="fu">tkplot</span>(Cibola_i)</span>
<span id="cb262-9"><a href="network-visualization.html#cb262-9" aria-hidden="true" tabindex="-1"></a>Coords <span class="ot">&lt;-</span> <span class="fu">tkplot.getcoords</span>(locs)</span></code></pre></div>
<p>This will bring up a window like the example below and when you click “Close” it will automatically create the variables with the locational information for plotting.</p>
<p><img src="images/interactive.jpg" style="width:80.0%" /></p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="network-visualization.html#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Cibola_i, <span class="at">layout=</span>Coords)</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig6_5c-1.png" width="672" /></p>
</div>
<div id="Figure_6_6" class="section level3" number="6.4.6">
<h3><span class="header-section-number">6.4.6</span> Figure 6.6: Absolute Geographic Layout</h3>
<p>Fig. 6.6. Map of major Roman roads and major settlements on the Iberian Peninsula, (a) with roads mapped along their actual geographic paths and (b) roads shown as simple line segments between nodes.</p>
<p>The figure that appears in the book was originally created using GIS software but it is possible to prepare a quite similar figure in R using the tools we outlined above. To reproduce the results presented here you will need to download <a href="data/Hispania_nodes.csv">the node information file</a> and the <a href="data/Hispania_roads.csv">road edge list</a>.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="network-visualization.html#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb264-2"><a href="network-visualization.html#cb264-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggmap)</span>
<span id="cb264-3"><a href="network-visualization.html#cb264-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb264-4"><a href="network-visualization.html#cb264-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-5"><a href="network-visualization.html#cb264-5" aria-hidden="true" tabindex="-1"></a>edges1 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/Hispania_roads.csv&quot;</span>, <span class="at">header=</span>T)</span>
<span id="cb264-6"><a href="network-visualization.html#cb264-6" aria-hidden="true" tabindex="-1"></a>edges1 <span class="ot">&lt;-</span> edges1[<span class="fu">which</span>(edges1<span class="sc">$</span>Weight<span class="sc">&gt;</span><span class="dv">25</span>),]</span>
<span id="cb264-7"><a href="network-visualization.html#cb264-7" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/Hispania_nodes.csv&quot;</span>, <span class="at">header=</span>T)</span>
<span id="cb264-8"><a href="network-visualization.html#cb264-8" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> nodes[<span class="fu">which</span>(nodes<span class="sc">$</span>Id <span class="sc">%in%</span> <span class="fu">c</span>(edges1<span class="sc">$</span>Source,edges1<span class="sc">$</span>Target)),]</span>
<span id="cb264-9"><a href="network-visualization.html#cb264-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-10"><a href="network-visualization.html#cb264-10" aria-hidden="true" tabindex="-1"></a>road_net <span class="ot">&lt;-</span> <span class="fu">graph_from_edgelist</span>(<span class="fu">as.matrix</span>(edges1[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]), <span class="at">directed=</span><span class="cn">FALSE</span>)</span>
<span id="cb264-11"><a href="network-visualization.html#cb264-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-12"><a href="network-visualization.html#cb264-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert attribute location data to sf coordinates</span></span>
<span id="cb264-13"><a href="network-visualization.html#cb264-13" aria-hidden="true" tabindex="-1"></a>locations_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(nodes, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;long&quot;</span>, <span class="st">&quot;lat&quot;</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb264-14"><a href="network-visualization.html#cb264-14" aria-hidden="true" tabindex="-1"></a>coord1 <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">st_geometry</span>(locations_sf)) <span class="sc">%&gt;%</span> </span>
<span id="cb264-15"><a href="network-visualization.html#cb264-15" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">&quot;lon&quot;</span>,<span class="st">&quot;lat&quot;</span>))</span>
<span id="cb264-16"><a href="network-visualization.html#cb264-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-17"><a href="network-visualization.html#cb264-17" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(coord1)</span>
<span id="cb264-18"><a href="network-visualization.html#cb264-18" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(xy) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;x&#39;</span>,<span class="st">&#39;y&#39;</span>)</span>
<span id="cb264-19"><a href="network-visualization.html#cb264-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-20"><a href="network-visualization.html#cb264-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract edgelist from network object</span></span>
<span id="cb264-21"><a href="network-visualization.html#cb264-21" aria-hidden="true" tabindex="-1"></a>edgelist <span class="ot">&lt;-</span> <span class="fu">get.edgelist</span>(road_net)</span>
<span id="cb264-22"><a href="network-visualization.html#cb264-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-23"><a href="network-visualization.html#cb264-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataframe of beginning and ending points of edges</span></span>
<span id="cb264-24"><a href="network-visualization.html#cb264-24" aria-hidden="true" tabindex="-1"></a>edges <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">nrow</span>(edgelist),<span class="dv">4</span>))</span>
<span id="cb264-25"><a href="network-visualization.html#cb264-25" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(edges) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X1&quot;</span>,<span class="st">&quot;Y1&quot;</span>,<span class="st">&quot;X2&quot;</span>,<span class="st">&quot;Y2&quot;</span>)</span>
<span id="cb264-26"><a href="network-visualization.html#cb264-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(edgelist)) {</span>
<span id="cb264-27"><a href="network-visualization.html#cb264-27" aria-hidden="true" tabindex="-1"></a>edges[i,] <span class="ot">&lt;-</span> <span class="fu">c</span>(nodes[<span class="fu">which</span>(nodes<span class="sc">$</span>Id<span class="sc">==</span>edgelist[i,<span class="dv">1</span>]),<span class="dv">3</span>],nodes[<span class="fu">which</span>(nodes<span class="sc">$</span>Id<span class="sc">==</span>edgelist[i,<span class="dv">1</span>]),<span class="dv">2</span>],</span>
<span id="cb264-28"><a href="network-visualization.html#cb264-28" aria-hidden="true" tabindex="-1"></a>               nodes[<span class="fu">which</span>(nodes<span class="sc">$</span>Id<span class="sc">==</span>edgelist[i,<span class="dv">2</span>]),<span class="dv">3</span>],nodes[<span class="fu">which</span>(nodes<span class="sc">$</span>Id<span class="sc">==</span>edgelist[i,<span class="dv">2</span>]),<span class="dv">2</span>])</span>
<span id="cb264-29"><a href="network-visualization.html#cb264-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb264-30"><a href="network-visualization.html#cb264-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-31"><a href="network-visualization.html#cb264-31" aria-hidden="true" tabindex="-1"></a>myMap <span class="ot">&lt;-</span> <span class="fu">get_stamenmap</span>(<span class="at">bbox =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">9.5</span>,<span class="dv">36</span>,<span class="dv">3</span>,<span class="fl">43.8</span>),<span class="at">maptype =</span> <span class="st">&quot;watercolor&quot;</span>,<span class="at">zoom =</span> <span class="dv">6</span>)</span>
<span id="cb264-32"><a href="network-visualization.html#cb264-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-33"><a href="network-visualization.html#cb264-33" aria-hidden="true" tabindex="-1"></a><span class="fu">ggmap</span>(myMap) <span class="sc">+</span></span>
<span id="cb264-34"><a href="network-visualization.html#cb264-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> edges, <span class="fu">aes</span>(<span class="at">x=</span>X1, <span class="at">y=</span>Y1, <span class="at">xend=</span>X2, <span class="at">yend=</span>Y2), <span class="at">col=</span><span class="st">&#39;black&#39;</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb264-35"><a href="network-visualization.html#cb264-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> xy, <span class="fu">aes</span>(x,y), <span class="at">alpha=</span><span class="fl">0.8</span>, <span class="at">col=</span><span class="st">&#39;black&#39;</span>, <span class="at">fill=</span><span class="st">&quot;white&quot;</span>, <span class="at">shape=</span><span class="dv">21</span>, <span class="at">size=</span><span class="fl">1.5</span>, <span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb264-36"><a href="network-visualization.html#cb264-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig6_6-1.png" width="672" /></p>
</div>
<div id="Figure_6_7" class="section level3" number="6.4.7">
<h3><span class="header-section-number">6.4.7</span> Figure 6.7: Distorted Geographic Layout</h3>
<p>Fig. 6.7. This ceramic similarity network of the San Pedro River Valley in Arizona shows the challenges of creating geographic network layouts. Figure 6.7a shows sites in their original locations whereas figure 6.7b shifts locations to improve the visibility of network structure. Note how the distorted geographic layout retains the basic relationships among the nodes while altering their locations slightly.</p>
<p>Unfortunately as the first map contains real site locations we cannot share those data here. The second map can still be reproduced given nothing but the code below.</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="network-visualization.html#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb265-2"><a href="network-visualization.html#cb265-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb265-3"><a href="network-visualization.html#cb265-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggmap)</span>
<span id="cb265-4"><a href="network-visualization.html#cb265-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggsn)</span>
<span id="cb265-5"><a href="network-visualization.html#cb265-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb265-6"><a href="network-visualization.html#cb265-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb265-7"><a href="network-visualization.html#cb265-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-8"><a href="network-visualization.html#cb265-8" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/Figure6_7a.Rdata&quot;</span>)</span>
<span id="cb265-9"><a href="network-visualization.html#cb265-9" aria-hidden="true" tabindex="-1"></a><span class="co"># attr - site attribute data for San Pedro sites</span></span>
<span id="cb265-10"><a href="network-visualization.html#cb265-10" aria-hidden="true" tabindex="-1"></a><span class="co"># g.net - igraph network object of San Pedro sites based on ceramic similarity</span></span>
<span id="cb265-11"><a href="network-visualization.html#cb265-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-12"><a href="network-visualization.html#cb265-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-13"><a href="network-visualization.html#cb265-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert attribute location data to sf coordinates</span></span>
<span id="cb265-14"><a href="network-visualization.html#cb265-14" aria-hidden="true" tabindex="-1"></a>locations_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(attr, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;Easting&quot;</span>, <span class="st">&quot;Northing&quot;</span>), <span class="at">crs =</span> <span class="dv">26912</span>)</span>
<span id="cb265-15"><a href="network-visualization.html#cb265-15" aria-hidden="true" tabindex="-1"></a>loc_trans <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(locations_sf,<span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb265-16"><a href="network-visualization.html#cb265-16" aria-hidden="true" tabindex="-1"></a>coord1 <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">st_geometry</span>(loc_trans)) <span class="sc">%&gt;%</span> </span>
<span id="cb265-17"><a href="network-visualization.html#cb265-17" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">&quot;lon&quot;</span>,<span class="st">&quot;lat&quot;</span>))</span>
<span id="cb265-18"><a href="network-visualization.html#cb265-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-19"><a href="network-visualization.html#cb265-19" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(coord1)</span>
<span id="cb265-20"><a href="network-visualization.html#cb265-20" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(xy) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;x&#39;</span>,<span class="st">&#39;y&#39;</span>)</span>
<span id="cb265-21"><a href="network-visualization.html#cb265-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-22"><a href="network-visualization.html#cb265-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Define coordinates of &quot;jittered&quot; points</span></span>
<span id="cb265-23"><a href="network-visualization.html#cb265-23" aria-hidden="true" tabindex="-1"></a><span class="co"># These points were originally created using the &quot;jitter&quot; function</span></span>
<span id="cb265-24"><a href="network-visualization.html#cb265-24" aria-hidden="true" tabindex="-1"></a><span class="co"># until a reasonable set of points were found.</span></span>
<span id="cb265-25"><a href="network-visualization.html#cb265-25" aria-hidden="true" tabindex="-1"></a>coord <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">110.7985</span>, <span class="fl">32.97888</span>,</span>
<span id="cb265-26"><a href="network-visualization.html#cb265-26" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">110.7472</span>, <span class="fl">32.89950</span>,</span>
<span id="cb265-27"><a href="network-visualization.html#cb265-27" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">110.6965</span>, <span class="fl">32.83496</span>,</span>
<span id="cb265-28"><a href="network-visualization.html#cb265-28" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">110.6899</span>, <span class="fl">32.91499</span>,</span>
<span id="cb265-29"><a href="network-visualization.html#cb265-29" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">110.5508</span>, <span class="fl">32.72260</span>,</span>
<span id="cb265-30"><a href="network-visualization.html#cb265-30" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">110.4752</span>, <span class="fl">32.60533</span>,</span>
<span id="cb265-31"><a href="network-visualization.html#cb265-31" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">110.3367</span>, <span class="fl">32.33341</span>,</span>
<span id="cb265-32"><a href="network-visualization.html#cb265-32" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">110.5930</span>, <span class="fl">32.43487</span>,</span>
<span id="cb265-33"><a href="network-visualization.html#cb265-33" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">110.8160</span>, <span class="fl">32.86185</span>,</span>
<span id="cb265-34"><a href="network-visualization.html#cb265-34" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">110.6650</span>, <span class="fl">32.64882</span>,</span>
<span id="cb265-35"><a href="network-visualization.html#cb265-35" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">110.4558</span>, <span class="fl">32.56866</span>,</span>
<span id="cb265-36"><a href="network-visualization.html#cb265-36" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">110.6879</span>, <span class="fl">32.60055</span>,</span>
<span id="cb265-37"><a href="network-visualization.html#cb265-37" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">110.7428</span>, <span class="fl">32.93124</span>,</span>
<span id="cb265-38"><a href="network-visualization.html#cb265-38" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">110.4173</span>, <span class="fl">32.34401</span>,</span>
<span id="cb265-39"><a href="network-visualization.html#cb265-39" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">110.7000</span>, <span class="fl">32.73344</span>)</span>
<span id="cb265-40"><a href="network-visualization.html#cb265-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-41"><a href="network-visualization.html#cb265-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert coordinates to data frame</span></span>
<span id="cb265-42"><a href="network-visualization.html#cb265-42" aria-hidden="true" tabindex="-1"></a>zz <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(coord,<span class="at">nrow=</span><span class="dv">15</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>))</span>
<span id="cb265-43"><a href="network-visualization.html#cb265-43" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(zz) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;x&#39;</span>,<span class="st">&#39;y&#39;</span>)</span>
<span id="cb265-44"><a href="network-visualization.html#cb265-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-45"><a href="network-visualization.html#cb265-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Get basemap &quot;terrain-background&quot; data for map in black and white</span></span>
<span id="cb265-46"><a href="network-visualization.html#cb265-46" aria-hidden="true" tabindex="-1"></a>base3 <span class="ot">&lt;-</span> <span class="fu">get_stamenmap</span>(<span class="at">bbox=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">111</span>,<span class="fl">32.2</span>,<span class="sc">-</span><span class="dv">110</span>,<span class="fl">33.1</span>),<span class="at">zoom=</span><span class="dv">10</span>,<span class="at">maptype=</span><span class="st">&quot;terrain-background&quot;</span>,<span class="at">color=</span><span class="st">&quot;bw&quot;</span>)</span>
<span id="cb265-47"><a href="network-visualization.html#cb265-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-48"><a href="network-visualization.html#cb265-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract edgelist from network object</span></span>
<span id="cb265-49"><a href="network-visualization.html#cb265-49" aria-hidden="true" tabindex="-1"></a>edgelist <span class="ot">&lt;-</span> <span class="fu">get.edgelist</span>(g.net)</span>
<span id="cb265-50"><a href="network-visualization.html#cb265-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-51"><a href="network-visualization.html#cb265-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataframe of beginning and ending points of edges</span></span>
<span id="cb265-52"><a href="network-visualization.html#cb265-52" aria-hidden="true" tabindex="-1"></a>edges <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(xy[edgelist[,<span class="dv">1</span>],], xy[edgelist[,<span class="dv">2</span>],])</span>
<span id="cb265-53"><a href="network-visualization.html#cb265-53" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(edges) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X1&quot;</span>,<span class="st">&quot;Y1&quot;</span>,<span class="st">&quot;X2&quot;</span>,<span class="st">&quot;Y2&quot;</span>)</span>
<span id="cb265-54"><a href="network-visualization.html#cb265-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-55"><a href="network-visualization.html#cb265-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataframe of beginning and ending points of edges</span></span>
<span id="cb265-56"><a href="network-visualization.html#cb265-56" aria-hidden="true" tabindex="-1"></a>edges2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(zz[edgelist[,<span class="dv">1</span>],], zz[edgelist[,<span class="dv">2</span>],])</span>
<span id="cb265-57"><a href="network-visualization.html#cb265-57" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(edges2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X1&quot;</span>,<span class="st">&quot;Y1&quot;</span>,<span class="st">&quot;X2&quot;</span>,<span class="st">&quot;Y2&quot;</span>)</span>
<span id="cb265-58"><a href="network-visualization.html#cb265-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-59"><a href="network-visualization.html#cb265-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot original data on map</span></span>
<span id="cb265-60"><a href="network-visualization.html#cb265-60" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">ggmap</span>(base3,<span class="at">darken=</span><span class="fl">0.35</span>) <span class="sc">+</span></span>
<span id="cb265-61"><a href="network-visualization.html#cb265-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> edges, <span class="fu">aes</span>(<span class="at">x=</span>X1, <span class="at">y=</span>Y1, <span class="at">xend=</span>X2, <span class="at">yend=</span>Y2), <span class="at">col=</span><span class="st">&#39;white&#39;</span>,<span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb265-62"><a href="network-visualization.html#cb265-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> xy,<span class="fu">aes</span>(x,y),<span class="at">alpha=</span><span class="fl">0.8</span>, <span class="at">col=</span><span class="st">&#39;red&#39;</span>, <span class="at">size=</span><span class="dv">5</span>, <span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb265-63"><a href="network-visualization.html#cb265-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">label=</span>attr<span class="sc">$</span>Sites), <span class="at">data=</span>xy, <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb265-64"><a href="network-visualization.html#cb265-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scalebar</span>(<span class="at">x.min =</span> <span class="sc">-</span><span class="dv">111</span>, <span class="at">x.max =</span> <span class="sc">-</span><span class="fl">110.75</span>,</span>
<span id="cb265-65"><a href="network-visualization.html#cb265-65" aria-hidden="true" tabindex="-1"></a>           <span class="at">y.min =</span> <span class="fl">32.25</span>, <span class="at">y.max =</span> <span class="dv">33</span>,</span>
<span id="cb265-66"><a href="network-visualization.html#cb265-66" aria-hidden="true" tabindex="-1"></a>           <span class="at">dist =</span> <span class="dv">10</span>, <span class="at">dist_unit =</span> <span class="st">&quot;km&quot;</span>,</span>
<span id="cb265-67"><a href="network-visualization.html#cb265-67" aria-hidden="true" tabindex="-1"></a>           <span class="at">st.bottom =</span> <span class="cn">FALSE</span>, <span class="at">transform =</span> <span class="cn">TRUE</span>, </span>
<span id="cb265-68"><a href="network-visualization.html#cb265-68" aria-hidden="true" tabindex="-1"></a>           <span class="at">model =</span> <span class="st">&quot;WGS84&quot;</span>) <span class="sc">+</span></span>
<span id="cb265-69"><a href="network-visualization.html#cb265-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb265-70"><a href="network-visualization.html#cb265-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-71"><a href="network-visualization.html#cb265-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot jittered coordinates on map</span></span>
<span id="cb265-72"><a href="network-visualization.html#cb265-72" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">ggmap</span>(base3,<span class="at">darken=</span><span class="fl">0.35</span>) <span class="sc">+</span></span>
<span id="cb265-73"><a href="network-visualization.html#cb265-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> edges2, <span class="fu">aes</span>(<span class="at">x=</span>X1, <span class="at">y=</span>Y1, <span class="at">xend=</span>X2, <span class="at">yend=</span>Y2), <span class="at">col=</span><span class="st">&#39;white&#39;</span>,<span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb265-74"><a href="network-visualization.html#cb265-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> zz,<span class="fu">aes</span>(x,y),<span class="at">alpha=</span><span class="fl">0.8</span>, <span class="at">col=</span><span class="st">&#39;red&#39;</span>, <span class="at">size=</span><span class="dv">5</span>, <span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb265-75"><a href="network-visualization.html#cb265-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">label=</span>attr<span class="sc">$</span>Sites), <span class="at">data=</span>zz, <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb265-76"><a href="network-visualization.html#cb265-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scalebar</span>(<span class="at">x.min =</span> <span class="sc">-</span><span class="dv">111</span>, <span class="at">x.max =</span> <span class="sc">-</span><span class="fl">110.75</span>,</span>
<span id="cb265-77"><a href="network-visualization.html#cb265-77" aria-hidden="true" tabindex="-1"></a>           <span class="at">y.min =</span> <span class="fl">32.25</span>, <span class="at">y.max =</span> <span class="dv">33</span>,</span>
<span id="cb265-78"><a href="network-visualization.html#cb265-78" aria-hidden="true" tabindex="-1"></a>           <span class="at">dist =</span> <span class="dv">10</span>, <span class="at">dist_unit =</span> <span class="st">&quot;km&quot;</span>,</span>
<span id="cb265-79"><a href="network-visualization.html#cb265-79" aria-hidden="true" tabindex="-1"></a>           <span class="at">st.bottom =</span> <span class="cn">FALSE</span>, <span class="at">transform =</span> <span class="cn">TRUE</span>, </span>
<span id="cb265-80"><a href="network-visualization.html#cb265-80" aria-hidden="true" tabindex="-1"></a>           <span class="at">model =</span> <span class="st">&quot;WGS84&quot;</span>) <span class="sc">+</span></span>
<span id="cb265-81"><a href="network-visualization.html#cb265-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb265-82"><a href="network-visualization.html#cb265-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-83"><a href="network-visualization.html#cb265-83" aria-hidden="true" tabindex="-1"></a>figure_6_7 <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(m1,m2,</span>
<span id="cb265-84"><a href="network-visualization.html#cb265-84" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;(a)&quot;</span>, <span class="st">&quot;(b)&quot;</span>),</span>
<span id="cb265-85"><a href="network-visualization.html#cb265-85" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb265-86"><a href="network-visualization.html#cb265-86" aria-hidden="true" tabindex="-1"></a>                    <span class="at">font.label=</span><span class="fu">list</span>(<span class="at">size=</span><span class="dv">20</span>))</span>
<span id="cb265-87"><a href="network-visualization.html#cb265-87" aria-hidden="true" tabindex="-1"></a>figure_6_7</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig6_7-1.png" width="1152" /></p>
<p>Code for producing Fig. 6.7. B alone</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="network-visualization.html#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb266-2"><a href="network-visualization.html#cb266-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb266-3"><a href="network-visualization.html#cb266-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggmap)</span>
<span id="cb266-4"><a href="network-visualization.html#cb266-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggsn)</span>
<span id="cb266-5"><a href="network-visualization.html#cb266-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb266-6"><a href="network-visualization.html#cb266-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb266-7"><a href="network-visualization.html#cb266-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-8"><a href="network-visualization.html#cb266-8" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/Figure6_7.Rdata&quot;</span>)</span>
<span id="cb266-9"><a href="network-visualization.html#cb266-9" aria-hidden="true" tabindex="-1"></a><span class="co"># g.net - igraph network object of San Pedro sites based on ceramic similarity</span></span>
<span id="cb266-10"><a href="network-visualization.html#cb266-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-11"><a href="network-visualization.html#cb266-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Define coordinates of &quot;jittered&quot; points</span></span>
<span id="cb266-12"><a href="network-visualization.html#cb266-12" aria-hidden="true" tabindex="-1"></a><span class="co"># These points were originally created using the &quot;jitter&quot; function</span></span>
<span id="cb266-13"><a href="network-visualization.html#cb266-13" aria-hidden="true" tabindex="-1"></a><span class="co"># until a reasonable set of points were found.</span></span>
<span id="cb266-14"><a href="network-visualization.html#cb266-14" aria-hidden="true" tabindex="-1"></a>coord <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">110.7985</span>, <span class="fl">32.97888</span>,</span>
<span id="cb266-15"><a href="network-visualization.html#cb266-15" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">110.7472</span>, <span class="fl">32.89950</span>,</span>
<span id="cb266-16"><a href="network-visualization.html#cb266-16" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">110.6965</span>, <span class="fl">32.83496</span>,</span>
<span id="cb266-17"><a href="network-visualization.html#cb266-17" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">110.6899</span>, <span class="fl">32.91499</span>,</span>
<span id="cb266-18"><a href="network-visualization.html#cb266-18" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">110.5508</span>, <span class="fl">32.72260</span>,</span>
<span id="cb266-19"><a href="network-visualization.html#cb266-19" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">110.4752</span>, <span class="fl">32.60533</span>,</span>
<span id="cb266-20"><a href="network-visualization.html#cb266-20" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">110.3367</span>, <span class="fl">32.33341</span>,</span>
<span id="cb266-21"><a href="network-visualization.html#cb266-21" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">110.5930</span>, <span class="fl">32.43487</span>,</span>
<span id="cb266-22"><a href="network-visualization.html#cb266-22" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">110.8160</span>, <span class="fl">32.86185</span>,</span>
<span id="cb266-23"><a href="network-visualization.html#cb266-23" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">110.6650</span>, <span class="fl">32.64882</span>,</span>
<span id="cb266-24"><a href="network-visualization.html#cb266-24" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">110.4558</span>, <span class="fl">32.56866</span>,</span>
<span id="cb266-25"><a href="network-visualization.html#cb266-25" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">110.6879</span>, <span class="fl">32.60055</span>,</span>
<span id="cb266-26"><a href="network-visualization.html#cb266-26" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">110.7428</span>, <span class="fl">32.93124</span>,</span>
<span id="cb266-27"><a href="network-visualization.html#cb266-27" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">110.4173</span>, <span class="fl">32.34401</span>,</span>
<span id="cb266-28"><a href="network-visualization.html#cb266-28" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">110.7000</span>, <span class="fl">32.73344</span>)</span>
<span id="cb266-29"><a href="network-visualization.html#cb266-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-30"><a href="network-visualization.html#cb266-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert coordinates to data frame</span></span>
<span id="cb266-31"><a href="network-visualization.html#cb266-31" aria-hidden="true" tabindex="-1"></a>zz <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(coord,<span class="at">nrow=</span><span class="dv">15</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>))</span>
<span id="cb266-32"><a href="network-visualization.html#cb266-32" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(zz) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;x&#39;</span>,<span class="st">&#39;y&#39;</span>)</span>
<span id="cb266-33"><a href="network-visualization.html#cb266-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-34"><a href="network-visualization.html#cb266-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Get basemap &quot;terrain-background&quot; data for map in black and white</span></span>
<span id="cb266-35"><a href="network-visualization.html#cb266-35" aria-hidden="true" tabindex="-1"></a>base3 <span class="ot">&lt;-</span> <span class="fu">get_stamenmap</span>(<span class="at">bbox=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">111</span>,<span class="fl">32.2</span>,<span class="sc">-</span><span class="dv">110</span>,<span class="fl">33.1</span>),<span class="at">zoom=</span><span class="dv">10</span>,<span class="at">maptype=</span><span class="st">&quot;terrain-background&quot;</span>,<span class="at">color=</span><span class="st">&quot;bw&quot;</span>)</span>
<span id="cb266-36"><a href="network-visualization.html#cb266-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-37"><a href="network-visualization.html#cb266-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract edgelist from network object</span></span>
<span id="cb266-38"><a href="network-visualization.html#cb266-38" aria-hidden="true" tabindex="-1"></a>edgelist <span class="ot">&lt;-</span> <span class="fu">get.edgelist</span>(g.net)</span>
<span id="cb266-39"><a href="network-visualization.html#cb266-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-40"><a href="network-visualization.html#cb266-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataframe of beginning and ending points of edges</span></span>
<span id="cb266-41"><a href="network-visualization.html#cb266-41" aria-hidden="true" tabindex="-1"></a>edges2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(zz[edgelist[,<span class="dv">1</span>],], zz[edgelist[,<span class="dv">2</span>],])</span>
<span id="cb266-42"><a href="network-visualization.html#cb266-42" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(edges2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X1&quot;</span>,<span class="st">&quot;Y1&quot;</span>,<span class="st">&quot;X2&quot;</span>,<span class="st">&quot;Y2&quot;</span>)</span>
<span id="cb266-43"><a href="network-visualization.html#cb266-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-44"><a href="network-visualization.html#cb266-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot jittered coordinates on map</span></span>
<span id="cb266-45"><a href="network-visualization.html#cb266-45" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">ggmap</span>(base3,<span class="at">darken=</span><span class="fl">0.35</span>) <span class="sc">+</span></span>
<span id="cb266-46"><a href="network-visualization.html#cb266-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> edges2, <span class="fu">aes</span>(<span class="at">x=</span>X1, <span class="at">y=</span>Y1, <span class="at">xend=</span>X2, <span class="at">yend=</span>Y2), <span class="at">col=</span><span class="st">&#39;white&#39;</span>,<span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb266-47"><a href="network-visualization.html#cb266-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> zz,<span class="fu">aes</span>(x,y),<span class="at">alpha=</span><span class="fl">0.8</span>, <span class="at">col=</span><span class="st">&#39;red&#39;</span>, <span class="at">size=</span><span class="dv">5</span>, <span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb266-48"><a href="network-visualization.html#cb266-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">label=</span>attr<span class="sc">$</span>Sites), <span class="at">data=</span>zz, <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb266-49"><a href="network-visualization.html#cb266-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scalebar</span>(<span class="at">x.min =</span> <span class="sc">-</span><span class="dv">111</span>, <span class="at">x.max =</span> <span class="sc">-</span><span class="fl">110.75</span>,</span>
<span id="cb266-50"><a href="network-visualization.html#cb266-50" aria-hidden="true" tabindex="-1"></a>           <span class="at">y.min =</span> <span class="fl">32.25</span>, <span class="at">y.max =</span> <span class="dv">33</span>,</span>
<span id="cb266-51"><a href="network-visualization.html#cb266-51" aria-hidden="true" tabindex="-1"></a>           <span class="at">dist =</span> <span class="dv">10</span>, <span class="at">dist_unit =</span> <span class="st">&quot;km&quot;</span>,</span>
<span id="cb266-52"><a href="network-visualization.html#cb266-52" aria-hidden="true" tabindex="-1"></a>           <span class="at">st.bottom =</span> <span class="cn">FALSE</span>, <span class="at">transform =</span> <span class="cn">TRUE</span>, </span>
<span id="cb266-53"><a href="network-visualization.html#cb266-53" aria-hidden="true" tabindex="-1"></a>           <span class="at">model =</span> <span class="st">&quot;WGS84&quot;</span>) <span class="sc">+</span></span>
<span id="cb266-54"><a href="network-visualization.html#cb266-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb266-55"><a href="network-visualization.html#cb266-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-56"><a href="network-visualization.html#cb266-56" aria-hidden="true" tabindex="-1"></a>m2</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-75-1.png" width="576" /></p>
</div>
<div id="Figure_6_8" class="section level3" number="6.4.8">
<h3><span class="header-section-number">6.4.8</span> Figure 6.8: Graph Layout Algorithms</h3>
<p>Fig. 6.8. Several different graph layouts all using the same “Zachary karate” network. In each graph, nodes are scale based on betweenness centrality and color coded based on optimal clusters based on modularity maximization.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="network-visualization.html#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb267-2"><a href="network-visualization.html#cb267-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb267-3"><a href="network-visualization.html#cb267-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb267-4"><a href="network-visualization.html#cb267-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraphdata)</span>
<span id="cb267-5"><a href="network-visualization.html#cb267-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(graphlayouts)</span>
<span id="cb267-6"><a href="network-visualization.html#cb267-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb267-7"><a href="network-visualization.html#cb267-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggmap)</span>
<span id="cb267-8"><a href="network-visualization.html#cb267-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-9"><a href="network-visualization.html#cb267-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Load igraph aegean_net data</span></span>
<span id="cb267-10"><a href="network-visualization.html#cb267-10" aria-hidden="true" tabindex="-1"></a><span class="co">#data(aegean_net)</span></span>
<span id="cb267-11"><a href="network-visualization.html#cb267-11" aria-hidden="true" tabindex="-1"></a>aegean <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/aegean.csv&quot;</span>,<span class="at">row.names=</span><span class="dv">1</span>, <span class="at">header=</span>T)</span>
<span id="cb267-12"><a href="network-visualization.html#cb267-12" aria-hidden="true" tabindex="-1"></a>aegean_dist <span class="ot">&lt;-</span> aegean</span>
<span id="cb267-13"><a href="network-visualization.html#cb267-13" aria-hidden="true" tabindex="-1"></a>aegean_dist[aegean_dist<span class="sc">&gt;</span><span class="dv">124</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb267-14"><a href="network-visualization.html#cb267-14" aria-hidden="true" tabindex="-1"></a>aegean_dist[aegean_dist<span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb267-15"><a href="network-visualization.html#cb267-15" aria-hidden="true" tabindex="-1"></a>aegean_net <span class="ot">&lt;-</span> <span class="fu">graph_from_adjacency_matrix</span>(<span class="fu">as.matrix</span>(aegean_dist))</span>
<span id="cb267-16"><a href="network-visualization.html#cb267-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-17"><a href="network-visualization.html#cb267-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Define cluster membership and betweenness centrality for plotting</span></span>
<span id="cb267-18"><a href="network-visualization.html#cb267-18" aria-hidden="true" tabindex="-1"></a>grp <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">cluster_optimal</span>(aegean_net)<span class="sc">$</span>membership)</span>
<span id="cb267-19"><a href="network-visualization.html#cb267-19" aria-hidden="true" tabindex="-1"></a>bw <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(igraph<span class="sc">::</span><span class="fu">betweenness</span>(aegean_net))</span>
<span id="cb267-20"><a href="network-visualization.html#cb267-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-21"><a href="network-visualization.html#cb267-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Multidimensional Scaling Layout with color by cluster and node size by betweenness</span></span>
<span id="cb267-22"><a href="network-visualization.html#cb267-22" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">435353</span>)</span>
<span id="cb267-23"><a href="network-visualization.html#cb267-23" aria-hidden="true" tabindex="-1"></a>g.mds <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(aegean_net, <span class="at">layout =</span> <span class="st">&quot;mds&quot;</span>) <span class="sc">+</span></span>
<span id="cb267-24"><a href="network-visualization.html#cb267-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link0</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb267-25"><a href="network-visualization.html#cb267-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> grp, <span class="at">size =</span> bw), <span class="at">shape=</span><span class="dv">21</span> ,<span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb267-26"><a href="network-visualization.html#cb267-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb267-27"><a href="network-visualization.html#cb267-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="sc">+</span></span>
<span id="cb267-28"><a href="network-visualization.html#cb267-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="sc">+</span></span>
<span id="cb267-29"><a href="network-visualization.html#cb267-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.3</span>), <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb267-30"><a href="network-visualization.html#cb267-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()<span class="sc">+</span></span>
<span id="cb267-31"><a href="network-visualization.html#cb267-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">22</span>)) <span class="sc">+</span></span>
<span id="cb267-32"><a href="network-visualization.html#cb267-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Multi-Dimensional Scaling&quot;</span>) <span class="sc">+</span></span>
<span id="cb267-33"><a href="network-visualization.html#cb267-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb267-34"><a href="network-visualization.html#cb267-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-35"><a href="network-visualization.html#cb267-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Fruchterman-Reingold Layout with color by cluster and node size by betweenness</span></span>
<span id="cb267-36"><a href="network-visualization.html#cb267-36" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">435353</span>)</span>
<span id="cb267-37"><a href="network-visualization.html#cb267-37" aria-hidden="true" tabindex="-1"></a>g.fr <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(aegean_net, <span class="at">layout =</span> <span class="st">&quot;fr&quot;</span>) <span class="sc">+</span></span>
<span id="cb267-38"><a href="network-visualization.html#cb267-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link0</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb267-39"><a href="network-visualization.html#cb267-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> grp, <span class="at">size =</span> bw), <span class="at">shape=</span><span class="dv">21</span> ,<span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb267-40"><a href="network-visualization.html#cb267-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb267-41"><a href="network-visualization.html#cb267-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="sc">+</span></span>
<span id="cb267-42"><a href="network-visualization.html#cb267-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="sc">+</span></span>
<span id="cb267-43"><a href="network-visualization.html#cb267-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.3</span>), <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb267-44"><a href="network-visualization.html#cb267-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()<span class="sc">+</span></span>
<span id="cb267-45"><a href="network-visualization.html#cb267-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">22</span>)) <span class="sc">+</span></span>
<span id="cb267-46"><a href="network-visualization.html#cb267-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Fruchterman-Reingold&quot;</span>) <span class="sc">+</span></span>
<span id="cb267-47"><a href="network-visualization.html#cb267-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb267-48"><a href="network-visualization.html#cb267-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-49"><a href="network-visualization.html#cb267-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Kamada-Kawai Layout with color by cluster and node size by betweenness</span></span>
<span id="cb267-50"><a href="network-visualization.html#cb267-50" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">435353</span>)</span>
<span id="cb267-51"><a href="network-visualization.html#cb267-51" aria-hidden="true" tabindex="-1"></a>g.kk <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(aegean_net, <span class="at">layout =</span> <span class="st">&quot;kk&quot;</span>) <span class="sc">+</span></span>
<span id="cb267-52"><a href="network-visualization.html#cb267-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link0</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb267-53"><a href="network-visualization.html#cb267-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> grp, <span class="at">size =</span> bw), <span class="at">shape=</span><span class="dv">21</span> ,<span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb267-54"><a href="network-visualization.html#cb267-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb267-55"><a href="network-visualization.html#cb267-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="sc">+</span></span>
<span id="cb267-56"><a href="network-visualization.html#cb267-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="sc">+</span></span>
<span id="cb267-57"><a href="network-visualization.html#cb267-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.3</span>), <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb267-58"><a href="network-visualization.html#cb267-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()<span class="sc">+</span></span>
<span id="cb267-59"><a href="network-visualization.html#cb267-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">22</span>)) <span class="sc">+</span></span>
<span id="cb267-60"><a href="network-visualization.html#cb267-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Kamada-Kawai&quot;</span>) <span class="sc">+</span></span>
<span id="cb267-61"><a href="network-visualization.html#cb267-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb267-62"><a href="network-visualization.html#cb267-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-63"><a href="network-visualization.html#cb267-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Radial Centrality Layout with color by cluster and node size by betweenness</span></span>
<span id="cb267-64"><a href="network-visualization.html#cb267-64" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">435353</span>)</span>
<span id="cb267-65"><a href="network-visualization.html#cb267-65" aria-hidden="true" tabindex="-1"></a>g.cent <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(aegean_net, <span class="at">layout =</span> <span class="st">&quot;centrality&quot;</span>, <span class="at">centrality=</span>igraph<span class="sc">::</span><span class="fu">betweenness</span>(aegean_net)) <span class="sc">+</span></span>
<span id="cb267-66"><a href="network-visualization.html#cb267-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link0</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb267-67"><a href="network-visualization.html#cb267-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> grp, <span class="at">size =</span> bw), <span class="at">shape=</span><span class="dv">21</span> ,<span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb267-68"><a href="network-visualization.html#cb267-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb267-69"><a href="network-visualization.html#cb267-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="sc">+</span></span>
<span id="cb267-70"><a href="network-visualization.html#cb267-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="sc">+</span></span>
<span id="cb267-71"><a href="network-visualization.html#cb267-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.3</span>), <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb267-72"><a href="network-visualization.html#cb267-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()<span class="sc">+</span></span>
<span id="cb267-73"><a href="network-visualization.html#cb267-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">22</span>)) <span class="sc">+</span></span>
<span id="cb267-74"><a href="network-visualization.html#cb267-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Radial Centrality&quot;</span>) <span class="sc">+</span></span>
<span id="cb267-75"><a href="network-visualization.html#cb267-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb267-76"><a href="network-visualization.html#cb267-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-77"><a href="network-visualization.html#cb267-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Spectral Layout with color by cluster and node size by betweenness</span></span>
<span id="cb267-78"><a href="network-visualization.html#cb267-78" aria-hidden="true" tabindex="-1"></a>u1 <span class="ot">&lt;-</span> <span class="fu">layout_with_eigen</span>(aegean_net)</span>
<span id="cb267-79"><a href="network-visualization.html#cb267-79" aria-hidden="true" tabindex="-1"></a>g.spec <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(aegean_net, <span class="at">layout =</span> <span class="st">&quot;manual&quot;</span>,</span>
<span id="cb267-80"><a href="network-visualization.html#cb267-80" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x=</span>u1[,<span class="dv">1</span>],</span>
<span id="cb267-81"><a href="network-visualization.html#cb267-81" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y=</span>u1[,<span class="dv">2</span>]) <span class="sc">+</span></span>
<span id="cb267-82"><a href="network-visualization.html#cb267-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link0</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb267-83"><a href="network-visualization.html#cb267-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> grp, <span class="at">size =</span> bw), <span class="at">shape=</span><span class="dv">21</span> ,<span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb267-84"><a href="network-visualization.html#cb267-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb267-85"><a href="network-visualization.html#cb267-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="sc">+</span></span>
<span id="cb267-86"><a href="network-visualization.html#cb267-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="sc">+</span></span>
<span id="cb267-87"><a href="network-visualization.html#cb267-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.3</span>), <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb267-88"><a href="network-visualization.html#cb267-88" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb267-89"><a href="network-visualization.html#cb267-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()<span class="sc">+</span></span>
<span id="cb267-90"><a href="network-visualization.html#cb267-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">22</span>)) <span class="sc">+</span></span>
<span id="cb267-91"><a href="network-visualization.html#cb267-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Spectral&quot;</span>) <span class="sc">+</span></span>
<span id="cb267-92"><a href="network-visualization.html#cb267-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb267-93"><a href="network-visualization.html#cb267-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-94"><a href="network-visualization.html#cb267-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-95"><a href="network-visualization.html#cb267-95" aria-hidden="true" tabindex="-1"></a><span class="co"># Create geographic network and plot</span></span>
<span id="cb267-96"><a href="network-visualization.html#cb267-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-97"><a href="network-visualization.html#cb267-97" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&#39;data/aegean_locs.csv&#39;</span>)</span>
<span id="cb267-98"><a href="network-visualization.html#cb267-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-99"><a href="network-visualization.html#cb267-99" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert attribute location data to sf coordinates</span></span>
<span id="cb267-100"><a href="network-visualization.html#cb267-100" aria-hidden="true" tabindex="-1"></a>locations_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(nodes, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>, <span class="st">&quot;Latitude&quot;</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb267-101"><a href="network-visualization.html#cb267-101" aria-hidden="true" tabindex="-1"></a>coord1 <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">st_geometry</span>(locations_sf)) <span class="sc">%&gt;%</span> </span>
<span id="cb267-102"><a href="network-visualization.html#cb267-102" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">&quot;lon&quot;</span>,<span class="st">&quot;lat&quot;</span>))</span>
<span id="cb267-103"><a href="network-visualization.html#cb267-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-104"><a href="network-visualization.html#cb267-104" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(coord1)</span>
<span id="cb267-105"><a href="network-visualization.html#cb267-105" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(xy) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;x&#39;</span>,<span class="st">&#39;y&#39;</span>)</span>
<span id="cb267-106"><a href="network-visualization.html#cb267-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-107"><a href="network-visualization.html#cb267-107" aria-hidden="true" tabindex="-1"></a>myMap <span class="ot">&lt;-</span> <span class="fu">get_stamenmap</span>(<span class="at">bbox=</span><span class="fu">c</span>(<span class="dv">22</span>,<span class="fl">34.5</span>,<span class="dv">29</span>,<span class="fl">38.8</span>),<span class="at">zoom=</span><span class="dv">8</span>,<span class="at">maptype=</span><span class="st">&quot;terrain-background&quot;</span>)</span>
<span id="cb267-108"><a href="network-visualization.html#cb267-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-109"><a href="network-visualization.html#cb267-109" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract edgelist from network object for road_net</span></span>
<span id="cb267-110"><a href="network-visualization.html#cb267-110" aria-hidden="true" tabindex="-1"></a>edgelist1 <span class="ot">&lt;-</span> <span class="fu">get.edgelist</span>(aegean_net)</span>
<span id="cb267-111"><a href="network-visualization.html#cb267-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-112"><a href="network-visualization.html#cb267-112" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataframe of beginning and ending points of edges</span></span>
<span id="cb267-113"><a href="network-visualization.html#cb267-113" aria-hidden="true" tabindex="-1"></a>edges1 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">nrow</span>(edgelist1),<span class="dv">4</span>))</span>
<span id="cb267-114"><a href="network-visualization.html#cb267-114" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(edges1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X1&quot;</span>,<span class="st">&quot;Y1&quot;</span>,<span class="st">&quot;X2&quot;</span>,<span class="st">&quot;Y2&quot;</span>)</span>
<span id="cb267-115"><a href="network-visualization.html#cb267-115" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(edgelist1)) {</span>
<span id="cb267-116"><a href="network-visualization.html#cb267-116" aria-hidden="true" tabindex="-1"></a>  edges1[i,] <span class="ot">&lt;-</span> <span class="fu">c</span>(nodes[<span class="fu">which</span>(nodes<span class="sc">$</span>Name<span class="sc">==</span>edgelist1[i,<span class="dv">1</span>]),]<span class="sc">$</span>Longitude,nodes[<span class="fu">which</span>(nodes<span class="sc">$</span>Name<span class="sc">==</span>edgelist1[i,<span class="dv">1</span>]),]<span class="sc">$</span>Latitude,</span>
<span id="cb267-117"><a href="network-visualization.html#cb267-117" aria-hidden="true" tabindex="-1"></a>                  nodes[<span class="fu">which</span>(nodes<span class="sc">$</span>Name<span class="sc">==</span>edgelist1[i,<span class="dv">2</span>]),]<span class="sc">$</span>Longitude,nodes[<span class="fu">which</span>(nodes<span class="sc">$</span>Name<span class="sc">==</span>edgelist1[i,<span class="dv">2</span>]),]<span class="sc">$</span>Latitude)</span>
<span id="cb267-118"><a href="network-visualization.html#cb267-118" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb267-119"><a href="network-visualization.html#cb267-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-120"><a href="network-visualization.html#cb267-120" aria-hidden="true" tabindex="-1"></a>geo_net <span class="ot">&lt;-</span> <span class="fu">ggmap</span>(myMap) <span class="sc">+</span></span>
<span id="cb267-121"><a href="network-visualization.html#cb267-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> edges1, <span class="fu">aes</span>(<span class="at">x=</span>X1, <span class="at">y=</span>Y1, <span class="at">xend=</span>X2, <span class="at">yend=</span>Y2), <span class="at">col=</span><span class="st">&#39;black&#39;</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb267-122"><a href="network-visualization.html#cb267-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> xy, <span class="fu">aes</span>(x,y,<span class="at">size=</span>bw,<span class="at">fill=</span>grp), <span class="at">alpha=</span><span class="fl">0.8</span>, <span class="at">shape=</span><span class="dv">21</span>, <span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb267-123"><a href="network-visualization.html#cb267-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb267-124"><a href="network-visualization.html#cb267-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="sc">+</span></span>
<span id="cb267-125"><a href="network-visualization.html#cb267-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="sc">+</span></span>
<span id="cb267-126"><a href="network-visualization.html#cb267-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>() <span class="sc">+</span></span>
<span id="cb267-127"><a href="network-visualization.html#cb267-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Geographic&quot;</span>) <span class="sc">+</span></span>
<span id="cb267-128"><a href="network-visualization.html#cb267-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">22</span>)) </span>
<span id="cb267-129"><a href="network-visualization.html#cb267-129" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb267-130"><a href="network-visualization.html#cb267-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-131"><a href="network-visualization.html#cb267-131" aria-hidden="true" tabindex="-1"></a>figure_6_8a <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(geo_net, g.mds, g.fr, g.kk, g.cent, g.spec, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb267-132"><a href="network-visualization.html#cb267-132" aria-hidden="true" tabindex="-1"></a>figure_6_8a</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig6_8-1.png" width="960" /></p>
</div>
<div id="Figure_6_9" class="section level3" number="6.4.9">
<h3><span class="header-section-number">6.4.9</span> Figure 6.9: Heirarchical Graph Layouts</h3>
<p>Fig. 6.9. Examples of visualizations based on hierarchical graph data. A) Graph with nodes color coded by hierarchical level. B) Bubble plot where nodes are scaled proportional to the sub-group size. C) Dendrogram of hierarchical cluster data. D) Radial graph with edges bundled based on similarity in relations. Edges are color coded such that they are red at the origin and purple at the destination to help visualize direction.</p>
<p>These graphs are based on a hierarchical graph that was created by assigning nodes to the leaves of a hierarchical cluster analysis performed on the Cibola ceramic technological cluster data. The data for 6.9d were randomly generated following an example on the R Graph Gallery. <a href="data/Figure6_9.Rdata">Use these data</a> to follow along.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="network-visualization.html#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize libraries</span></span>
<span id="cb268-2"><a href="network-visualization.html#cb268-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb268-3"><a href="network-visualization.html#cb268-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb268-4"><a href="network-visualization.html#cb268-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ape)</span>
<span id="cb268-5"><a href="network-visualization.html#cb268-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb268-6"><a href="network-visualization.html#cb268-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb268-7"><a href="network-visualization.html#cb268-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-8"><a href="network-visualization.html#cb268-8" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file=</span><span class="st">&quot;data/Figure6_9.Rdata&quot;</span>)</span>
<span id="cb268-9"><a href="network-visualization.html#cb268-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-10"><a href="network-visualization.html#cb268-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4353543</span>)</span>
<span id="cb268-11"><a href="network-visualization.html#cb268-11" aria-hidden="true" tabindex="-1"></a>h1 <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(h_graph, <span class="st">&#39;circlepack&#39;</span>) <span class="sc">+</span> </span>
<span id="cb268-12"><a href="network-visualization.html#cb268-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>() <span class="sc">+</span> </span>
<span id="cb268-13"><a href="network-visualization.html#cb268-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> depth, <span class="at">size=</span>(<span class="fu">max</span>(depth)<span class="sc">-</span>depth)<span class="sc">/</span><span class="dv">2</span>), <span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb268-14"><a href="network-visualization.html#cb268-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis</span>() <span class="sc">+</span></span>
<span id="cb268-15"><a href="network-visualization.html#cb268-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>() <span class="sc">+</span></span>
<span id="cb268-16"><a href="network-visualization.html#cb268-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span>
<span id="cb268-17"><a href="network-visualization.html#cb268-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-18"><a href="network-visualization.html#cb268-18" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">643346463</span>)</span>
<span id="cb268-19"><a href="network-visualization.html#cb268-19" aria-hidden="true" tabindex="-1"></a>h2 <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(h_graph, <span class="st">&#39;circlepack&#39;</span>) <span class="sc">+</span> </span>
<span id="cb268-20"><a href="network-visualization.html#cb268-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_circle</span>(<span class="fu">aes</span>(<span class="at">fill=</span>depth), <span class="at">size =</span> <span class="fl">0.25</span>, <span class="at">n =</span> <span class="dv">50</span>, <span class="at">show.legend=</span>F) <span class="sc">+</span> </span>
<span id="cb268-21"><a href="network-visualization.html#cb268-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>() <span class="sc">+</span></span>
<span id="cb268-22"><a href="network-visualization.html#cb268-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>() <span class="sc">+</span></span>
<span id="cb268-23"><a href="network-visualization.html#cb268-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span>
<span id="cb268-24"><a href="network-visualization.html#cb268-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-25"><a href="network-visualization.html#cb268-25" aria-hidden="true" tabindex="-1"></a>h3 <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(h_graph, <span class="st">&#39;dendrogram&#39;</span>) <span class="sc">+</span> </span>
<span id="cb268-26"><a href="network-visualization.html#cb268-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">filter=</span>leaf),<span class="at">color=</span><span class="st">&#39;blue&#39;</span> , <span class="at">alpha=</span><span class="fl">0.7</span>, <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb268-27"><a href="network-visualization.html#cb268-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()<span class="sc">+</span></span>
<span id="cb268-28"><a href="network-visualization.html#cb268-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span>
<span id="cb268-29"><a href="network-visualization.html#cb268-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-30"><a href="network-visualization.html#cb268-30" aria-hidden="true" tabindex="-1"></a>h4 <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(sub_grp_graph, <span class="at">layout =</span> <span class="st">&#39;dendrogram&#39;</span>, <span class="at">circular =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb268-31"><a href="network-visualization.html#cb268-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_conn_bundle</span>(<span class="at">data =</span> <span class="fu">get_con</span>(<span class="at">from =</span> from, <span class="at">to =</span> to), <span class="at">alpha=</span><span class="fl">0.2</span>, <span class="at">width=</span><span class="fl">0.9</span>, <span class="at">tension=</span><span class="fl">0.9</span>, <span class="fu">aes</span>(<span class="at">colour=</span>..index..)) <span class="sc">+</span></span>
<span id="cb268-32"><a href="network-visualization.html#cb268-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_colour_distiller</span>(<span class="at">palette =</span> <span class="st">&quot;RdPu&quot;</span>) <span class="sc">+</span></span>
<span id="cb268-33"><a href="network-visualization.html#cb268-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">filter =</span> leaf, <span class="at">x =</span> x<span class="sc">*</span><span class="fl">1.05</span>, <span class="at">y=</span>y<span class="sc">*</span><span class="fl">1.05</span>, <span class="at">colour=</span>group),<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb268-34"><a href="network-visualization.html#cb268-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values=</span> <span class="fu">rep</span>(<span class="fu">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Paired&quot;</span>) , <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb268-35"><a href="network-visualization.html#cb268-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>() <span class="sc">+</span></span>
<span id="cb268-36"><a href="network-visualization.html#cb268-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) </span>
<span id="cb268-37"><a href="network-visualization.html#cb268-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-38"><a href="network-visualization.html#cb268-38" aria-hidden="true" tabindex="-1"></a>figure_6_9 <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(h1,h2,h3,h4, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&#39;(a)&#39;</span>,<span class="st">&#39;(b)&#39;</span>,<span class="st">&#39;(c)&#39;</span>,<span class="st">&#39;(d)&#39;</span>))</span>
<span id="cb268-39"><a href="network-visualization.html#cb268-39" aria-hidden="true" tabindex="-1"></a>figure_6_9</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig6_9-1.png" width="768" /></p>
</div>
<div id="Figure_6_10" class="section level3" number="6.4.10">
<h3><span class="header-section-number">6.4.10</span> Figure 6.10: Be kind to the color blind</h3>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="network-visualization.html#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb269-2"><a href="network-visualization.html#cb269-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statnet)</span>
<span id="cb269-3"><a href="network-visualization.html#cb269-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(intergraph)</span>
<span id="cb269-4"><a href="network-visualization.html#cb269-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb269-5"><a href="network-visualization.html#cb269-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb269-6"><a href="network-visualization.html#cb269-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(colorspace)</span>
<span id="cb269-7"><a href="network-visualization.html#cb269-7" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;data/colorblindr.R&quot;</span>)</span>
<span id="cb269-8"><a href="network-visualization.html#cb269-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-9"><a href="network-visualization.html#cb269-9" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/Peeples2018.Rdata&quot;</span>)</span>
<span id="cb269-10"><a href="network-visualization.html#cb269-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-11"><a href="network-visualization.html#cb269-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create igraph object for plots below</span></span>
<span id="cb269-12"><a href="network-visualization.html#cb269-12" aria-hidden="true" tabindex="-1"></a>net <span class="ot">&lt;-</span> <span class="fu">asIgraph</span>(BRnet)</span>
<span id="cb269-13"><a href="network-visualization.html#cb269-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-14"><a href="network-visualization.html#cb269-14" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">347</span>)</span>
<span id="cb269-15"><a href="network-visualization.html#cb269-15" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(net, <span class="at">layout =</span> <span class="st">&quot;kk&quot;</span>) <span class="sc">+</span></span>
<span id="cb269-16"><a href="network-visualization.html#cb269-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">edge_color=</span><span class="st">&quot;gray&quot;</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb269-17"><a href="network-visualization.html#cb269-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> site_info<span class="sc">$</span>Region), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> igraph<span class="sc">::</span><span class="fu">degree</span>(net), <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb269-18"><a href="network-visualization.html#cb269-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb269-19"><a href="network-visualization.html#cb269-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="sc">+</span></span>
<span id="cb269-20"><a href="network-visualization.html#cb269-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()<span class="sc">+</span></span>
<span id="cb269-21"><a href="network-visualization.html#cb269-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb269-22"><a href="network-visualization.html#cb269-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-23"><a href="network-visualization.html#cb269-23" aria-hidden="true" tabindex="-1"></a><span class="fu">cvd_grid2</span>(g1)</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig6_10-1.png" width="672" /></p>
</div>
<div id="Figure_6_11" class="section level3" number="6.4.11">
<h3><span class="header-section-number">6.4.11</span> Figure 6.11: Node Symbol and Color Schemes</h3>
<p>Fig. 6.11. Examples of different node color and symbol schemes. Note how adding color and size eases the identification of particular values, in particular with closely spaced points. Using transparency can similarly aid in showing multiple overlapping nodes.</p>
<p>The version that appears in the book was compiled and labeled in Adobe Illustrator.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="network-visualization.html#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb270-2"><a href="network-visualization.html#cb270-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-3"><a href="network-visualization.html#cb270-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">y=</span><span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">5</span>), <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span><span class="fu">seq</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>), <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>), <span class="at">bty=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xlab=</span><span class="st">&#39;&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;&#39;</span>)</span>
<span id="cb270-4"><a href="network-visualization.html#cb270-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">y=</span><span class="fu">rep</span>(<span class="fl">1.5</span>,<span class="dv">5</span>), <span class="at">pch=</span><span class="dv">21</span>, <span class="at">cex=</span><span class="fu">seq</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>), <span class="at">bg=</span><span class="fu">heat.colors</span>(<span class="dv">5</span>, <span class="at">rev=</span>T))</span>
<span id="cb270-5"><a href="network-visualization.html#cb270-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">y=</span><span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">5</span>), <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>), <span class="at">cex=</span><span class="fu">seq</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>), <span class="at">bg=</span><span class="st">&#39;skyblue&#39;</span>, <span class="at">col=</span><span class="st">&#39;blue&#39;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig6_11-1.png" width="672" /></p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="network-visualization.html#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">34456</span>)</span>
<span id="cb271-2"><a href="network-visualization.html#cb271-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">15</span>,<span class="dv">1</span>,<span class="fl">0.5</span>)</span>
<span id="cb271-3"><a href="network-visualization.html#cb271-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">15</span>,<span class="dv">1</span>,<span class="fl">0.5</span>)</span>
<span id="cb271-4"><a href="network-visualization.html#cb271-4" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x,y)</span>
<span id="cb271-5"><a href="network-visualization.html#cb271-5" aria-hidden="true" tabindex="-1"></a>xy2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x<span class="sc">+</span><span class="dv">5</span>,y)</span>
<span id="cb271-6"><a href="network-visualization.html#cb271-6" aria-hidden="true" tabindex="-1"></a>xy3 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x<span class="sc">+</span><span class="dv">10</span>,y)</span>
<span id="cb271-7"><a href="network-visualization.html#cb271-7" aria-hidden="true" tabindex="-1"></a>xy4 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x<span class="sc">+</span><span class="dv">15</span>,y)</span>
<span id="cb271-8"><a href="network-visualization.html#cb271-8" aria-hidden="true" tabindex="-1"></a>xy5 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x<span class="sc">+</span><span class="dv">20</span>,y)</span>
<span id="cb271-9"><a href="network-visualization.html#cb271-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-10"><a href="network-visualization.html#cb271-10" aria-hidden="true" tabindex="-1"></a>size <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>),<span class="at">size=</span><span class="dv">15</span>,<span class="at">replace=</span>T)</span>
<span id="cb271-11"><a href="network-visualization.html#cb271-11" aria-hidden="true" tabindex="-1"></a>size <span class="ot">&lt;-</span> size<span class="dv">-4</span></span>
<span id="cb271-12"><a href="network-visualization.html#cb271-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-13"><a href="network-visualization.html#cb271-13" aria-hidden="true" tabindex="-1"></a>h.col <span class="ot">&lt;-</span> <span class="fu">heat.colors</span>(<span class="dv">5</span>,<span class="at">rev=</span>T)</span>
<span id="cb271-14"><a href="network-visualization.html#cb271-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-15"><a href="network-visualization.html#cb271-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xy[<span class="fu">order</span>(size,<span class="at">decreasing=</span>T),], <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">&#39;blue&#39;</span>, <span class="at">cex=</span>size[<span class="fu">order</span>(size,<span class="at">decreasing=</span>T)], <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">22</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">3</span>),<span class="at">bty=</span><span class="st">&#39;n&#39;</span>, <span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="at">xlab=</span><span class="st">&#39;&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;&#39;</span>)</span>
<span id="cb271-16"><a href="network-visualization.html#cb271-16" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(xy2[<span class="fu">order</span>(size,<span class="at">decreasing=</span>T),], <span class="at">pch=</span><span class="dv">21</span>, <span class="at">bg=</span>h.col[size[<span class="fu">order</span>(size,<span class="at">decreasing=</span>T)]], <span class="at">cex=</span>size[<span class="fu">order</span>(size,<span class="at">decreasing=</span>T)])</span>
<span id="cb271-17"><a href="network-visualization.html#cb271-17" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(xy3[<span class="fu">order</span>(size,<span class="at">decreasing=</span>T),], <span class="at">pch=</span>size[<span class="fu">order</span>(size,<span class="at">decreasing=</span>T)], <span class="at">col=</span><span class="st">&#39;blue&#39;</span>, <span class="at">cex=</span>size[<span class="fu">order</span>(size,<span class="at">decreasing=</span>T)])</span>
<span id="cb271-18"><a href="network-visualization.html#cb271-18" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(xy4[<span class="fu">order</span>(size,<span class="at">decreasing=</span>T),], <span class="at">pch=</span><span class="dv">21</span>, <span class="at">col=</span><span class="st">&#39;gray66&#39;</span>, <span class="at">bg=</span><span class="fu">alpha</span>(<span class="st">&#39;blue&#39;</span>,<span class="fl">0.7</span>), <span class="at">cex=</span>size[<span class="fu">order</span>(size,<span class="at">decreasing=</span>T)])</span>
<span id="cb271-19"><a href="network-visualization.html#cb271-19" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(xy5[<span class="fu">order</span>(size,<span class="at">decreasing=</span>T),], <span class="at">pch=</span><span class="dv">21</span>, <span class="at">bg=</span><span class="fu">alpha</span>(h.col[size[<span class="fu">order</span>(size,<span class="at">decreasing=</span>T)]],<span class="fl">0.7</span>), <span class="at">cex=</span>size[<span class="fu">order</span>(size,<span class="at">decreasing=</span>T)])</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig6_11-2.png" width="672" /></p>
</div>
<div id="Figure_6_12" class="section level3" number="6.4.12">
<h3><span class="header-section-number">6.4.12</span> Figure 6.12: Image for Node</h3>
<p>Fig. 6.12. Network graph showing similarity among carved faces from Banés, Holguín province, Cuba. Nodes are depicted as the objects in question themselves and edges represent shared attributes with numbers indicating the number of shared attributes for each pair of faces.</p>
<p>Figure 6.12 was used with permission by Angus Mol and the original was produced for his 2014 book.</p>
</div>
<div id="Figure_6_13" class="section level3" number="6.4.13">
<h3><span class="header-section-number">6.4.13</span> Figure 6.13: Images for Nodes</h3>
<p>Fig. 6.13. Two-mode network of ceramics and sites in the San Pedro Valley with ceramic ware categories represented by a graphic example of each type.</p>
<p>The version of Figure 6.13 in the Brughmans and Peeples (2022) book was originally created in NetDraw and modified to add the node pictures in Adobe Photoshop. This approach was preferred as it produced higher resolution and more consistent images than the graphics we could produce directly in R for this particular feature. It is, however, possible to use images in the place of nodes in R networks as the example below illustrates.</p>
<p>We have found in practice that this feature in R works best for simple icons. If you are using high resolution images or lots of color or detail in your images it works better to create an initial image format in something like R or NetDraw and then to modify the network in a graphical editing software after the fact. You can <a href="data/Figure6_13.Rdata">download the data</a> to follow along.</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="network-visualization.html#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(png)</span>
<span id="cb272-2"><a href="network-visualization.html#cb272-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb272-3"><a href="network-visualization.html#cb272-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-4"><a href="network-visualization.html#cb272-4" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/Figure6_13.Rdata&quot;</span>)</span>
<span id="cb272-5"><a href="network-visualization.html#cb272-5" aria-hidden="true" tabindex="-1"></a><span class="co"># two_mode_net - igraph two mode network object</span></span>
<span id="cb272-6"><a href="network-visualization.html#cb272-6" aria-hidden="true" tabindex="-1"></a><span class="co"># img.1 &lt;- readPNG(&quot;images/site.png&quot;)</span></span>
<span id="cb272-7"><a href="network-visualization.html#cb272-7" aria-hidden="true" tabindex="-1"></a><span class="co">#img.2 &lt;- readPNG(&quot;images/pot.png&quot;)</span></span>
<span id="cb272-8"><a href="network-visualization.html#cb272-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-9"><a href="network-visualization.html#cb272-9" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(two_mode_net)<span class="sc">$</span>raster <span class="ot">&lt;-</span> <span class="fu">list</span>(img<span class="fl">.1</span>, img<span class="fl">.2</span>)[<span class="fu">V</span>(two_mode_net)<span class="sc">$</span>type<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb272-10"><a href="network-visualization.html#cb272-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-11"><a href="network-visualization.html#cb272-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">34673</span>)</span>
<span id="cb272-12"><a href="network-visualization.html#cb272-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(two_mode_net, <span class="at">vertex.shape=</span><span class="st">&quot;raster&quot;</span>, <span class="at">vertex.label=</span><span class="cn">NA</span>,</span>
<span id="cb272-13"><a href="network-visualization.html#cb272-13" aria-hidden="true" tabindex="-1"></a><span class="at">vertex.size=</span><span class="dv">16</span>, <span class="at">vertex.size2=</span><span class="dv">16</span>, <span class="at">edge.width=</span><span class="dv">2</span>, <span class="at">edge.color=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig6_13-1.png" width="768" /></p>
</div>
<div id="Figure_6_14" class="section level3" number="6.4.14">
<h3><span class="header-section-number">6.4.14</span> Figure 6.14: Edge Thickness and Color</h3>
<p>Fig. 6.14. A random weighted graph where edge line thickness and color are both used to indicate weight in 5 categories.</p>
<p>You can <a href="data/Figure6_14.Rdata">download the data and images</a> to follow along.</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="network-visualization.html#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb273-2"><a href="network-visualization.html#cb273-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb273-3"><a href="network-visualization.html#cb273-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-4"><a href="network-visualization.html#cb273-4" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/Figure6_14.Rdata&quot;</span>)</span>
<span id="cb273-5"><a href="network-visualization.html#cb273-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-6"><a href="network-visualization.html#cb273-6" aria-hidden="true" tabindex="-1"></a>edge.cols <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&#39;gray&#39;</span>,<span class="st">&#39;darkblue&#39;</span>))(<span class="dv">5</span>)</span>
<span id="cb273-7"><a href="network-visualization.html#cb273-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-8"><a href="network-visualization.html#cb273-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">43644</span>)</span>
<span id="cb273-9"><a href="network-visualization.html#cb273-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(g.net, <span class="at">layout =</span> <span class="st">&quot;fr&quot;</span>) <span class="sc">+</span></span>
<span id="cb273-10"><a href="network-visualization.html#cb273-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link0</span>(<span class="fu">aes</span>(<span class="at">width =</span> <span class="fu">E</span>(g.net)<span class="sc">$</span>weight), <span class="at">edge_colour=</span>edge.cols[<span class="fu">E</span>(g.net)<span class="sc">$</span>weight]) <span class="sc">+</span></span>
<span id="cb273-11"><a href="network-visualization.html#cb273-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size=</span>igraph<span class="sc">::</span><span class="fu">degree</span>(g.net)<span class="sc">+</span><span class="dv">3</span>, <span class="at">fill=</span><span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb273-12"><a href="network-visualization.html#cb273-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>() <span class="sc">+</span></span>
<span id="cb273-13"><a href="network-visualization.html#cb273-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>()) </span></code></pre></div>
<p><img src="_main_files/figure-html/Fig6_14-1.png" width="576" /></p>
</div>
<div id="Figure_6_15" class="section level3" number="6.4.15">
<h3><span class="header-section-number">6.4.15</span> Figure 6.15: Edge Direction</h3>
<p>Fig. 6.15. Two methods of displaying directed ties using arrows (a) and arcs (c). Both of these simple networks represent the same relationships shown in the adjacency matrix in the center (b).</p>
<p>See the tutorial above for more details on using arrows in ggraph.</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="network-visualization.html#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb274-2"><a href="network-visualization.html#cb274-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb274-3"><a href="network-visualization.html#cb274-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb274-4"><a href="network-visualization.html#cb274-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-5"><a href="network-visualization.html#cb274-5" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">graph</span>( <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>,</span>
<span id="cb274-6"><a href="network-visualization.html#cb274-6" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>,</span>
<span id="cb274-7"><a href="network-visualization.html#cb274-7" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;A&quot;</span>, <span class="st">&quot;C&quot;</span>,</span>
<span id="cb274-8"><a href="network-visualization.html#cb274-8" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>,</span>
<span id="cb274-9"><a href="network-visualization.html#cb274-9" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;C&quot;</span>,<span class="st">&quot;B&quot;</span>,</span>
<span id="cb274-10"><a href="network-visualization.html#cb274-10" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;D&quot;</span>,<span class="st">&quot;C&quot;</span>))</span>
<span id="cb274-11"><a href="network-visualization.html#cb274-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-12"><a href="network-visualization.html#cb274-12" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>), <span class="dv">1</span>, <span class="dv">5</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb274-13"><a href="network-visualization.html#cb274-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-14"><a href="network-visualization.html#cb274-14" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4355467</span>)</span>
<span id="cb274-15"><a href="network-visualization.html#cb274-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g, <span class="at">edge.arrow.size=</span><span class="dv">1</span>, <span class="at">vertex.color=</span><span class="st">&quot;black&quot;</span>, <span class="at">vertex.size=</span><span class="dv">50</span>, </span>
<span id="cb274-16"><a href="network-visualization.html#cb274-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.frame.color=</span><span class="st">&quot;gray&quot;</span>, <span class="at">vertex.label.color=</span><span class="st">&quot;white&quot;</span>, <span class="at">edge.width=</span><span class="dv">2</span>, </span>
<span id="cb274-17"><a href="network-visualization.html#cb274-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label.cex=</span><span class="fl">2.75</span>, <span class="at">vertex.label.dist=</span><span class="dv">0</span>, <span class="at">vertex.label.family=</span><span class="st">&#39;Helvetica&#39;</span>) </span>
<span id="cb274-18"><a href="network-visualization.html#cb274-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-19"><a href="network-visualization.html#cb274-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.new</span>()</span>
<span id="cb274-20"><a href="network-visualization.html#cb274-20" aria-hidden="true" tabindex="-1"></a>adj1 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(g)))</span>
<span id="cb274-21"><a href="network-visualization.html#cb274-21" aria-hidden="true" tabindex="-1"></a>tt2 <span class="ot">&lt;-</span> <span class="fu">ttheme_minimal</span>(<span class="at">base_size=</span><span class="dv">25</span>)</span>
<span id="cb274-22"><a href="network-visualization.html#cb274-22" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.table</span>(adj1,<span class="at">theme=</span>tt2) </span>
<span id="cb274-23"><a href="network-visualization.html#cb274-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-24"><a href="network-visualization.html#cb274-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g, <span class="at">edge.arrow.size=</span><span class="fl">1.25</span>, <span class="at">vertex.color=</span><span class="st">&quot;black&quot;</span>, <span class="at">vertex.size=</span><span class="dv">50</span>, </span>
<span id="cb274-25"><a href="network-visualization.html#cb274-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.frame.color=</span><span class="st">&quot;gray&quot;</span>, <span class="at">vertex.label.color=</span><span class="st">&quot;white&quot;</span>, <span class="at">edge.width=</span><span class="dv">2</span>, </span>
<span id="cb274-26"><a href="network-visualization.html#cb274-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">edge.curved=</span><span class="fl">0.3</span>,</span>
<span id="cb274-27"><a href="network-visualization.html#cb274-27" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label.cex=</span><span class="fl">2.75</span>, <span class="at">vertex.label.dist=</span><span class="dv">0</span>, <span class="at">vertex.label.family=</span><span class="st">&#39;Helvetica&#39;</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/Fig6_15-1.png" width="672" /></p>
</div>
<div id="Figure_6_16" class="section level3" number="6.4.16">
<h3><span class="header-section-number">6.4.16</span> Figure 6.16: Edge Binarization</h3>
<p>Fig. 6.16. These networks all show the same data based on similarity scores among sites in the U.S. Southwest (ca. A.D. 1350-1400) but each has a different cutoff for binarization.</p>
<p>The following chunk of code uses <a href="data/Figure6_16.Rdata">ceramic similarity data from the SWSN database</a> and defines three different cutoff thresholds for defining edges.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="network-visualization.html#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb275-2"><a href="network-visualization.html#cb275-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statnet)</span>
<span id="cb275-3"><a href="network-visualization.html#cb275-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(intergraph)</span>
<span id="cb275-4"><a href="network-visualization.html#cb275-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb275-5"><a href="network-visualization.html#cb275-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb275-6"><a href="network-visualization.html#cb275-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-7"><a href="network-visualization.html#cb275-7" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/Figure6_16.Rdata&quot;</span>)</span>
<span id="cb275-8"><a href="network-visualization.html#cb275-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Contains similarity matrix AD1350sim</span></span>
<span id="cb275-9"><a href="network-visualization.html#cb275-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-10"><a href="network-visualization.html#cb275-10" aria-hidden="true" tabindex="-1"></a>AD1350sim_cut0_5 <span class="ot">&lt;-</span> <span class="fu">asIgraph</span>(<span class="fu">network</span>(<span class="fu">event2dichot</span>(AD1350sim, <span class="at">method=</span><span class="st">&quot;absolute&quot;</span>, <span class="at">thresh=</span><span class="fl">0.25</span>), <span class="at">directed=</span><span class="cn">FALSE</span>))</span>
<span id="cb275-11"><a href="network-visualization.html#cb275-11" aria-hidden="true" tabindex="-1"></a>AD1350sim_cut0_75 <span class="ot">&lt;-</span> <span class="fu">asIgraph</span>(<span class="fu">network</span>(<span class="fu">event2dichot</span>(AD1350sim, <span class="at">method=</span><span class="st">&quot;absolute&quot;</span>, <span class="at">thresh=</span><span class="fl">0.5</span>), <span class="at">directed=</span><span class="cn">FALSE</span>))</span>
<span id="cb275-12"><a href="network-visualization.html#cb275-12" aria-hidden="true" tabindex="-1"></a>AD1350sim_cut0_9 <span class="ot">&lt;-</span> <span class="fu">asIgraph</span>(<span class="fu">network</span>(<span class="fu">event2dichot</span>(AD1350sim, <span class="at">method=</span><span class="st">&quot;absolute&quot;</span>, <span class="at">thresh=</span><span class="fl">0.75</span>), <span class="at">directed=</span><span class="cn">FALSE</span>))</span>
<span id="cb275-13"><a href="network-visualization.html#cb275-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-14"><a href="network-visualization.html#cb275-14" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4637</span>)</span>
<span id="cb275-15"><a href="network-visualization.html#cb275-15" aria-hidden="true" tabindex="-1"></a>g0<span class="fl">.50</span> <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(AD1350sim_cut0_5, <span class="at">layout=</span><span class="st">&quot;fr&quot;</span>) <span class="sc">+</span></span>
<span id="cb275-16"><a href="network-visualization.html#cb275-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link0</span>(<span class="at">edge_colour=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb275-17"><a href="network-visualization.html#cb275-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill=</span><span class="st">&#39;gray&#39;</span>) <span class="sc">+</span></span>
<span id="cb275-18"><a href="network-visualization.html#cb275-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;0.25&quot;</span>) <span class="sc">+</span></span>
<span id="cb275-19"><a href="network-visualization.html#cb275-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>() </span>
<span id="cb275-20"><a href="network-visualization.html#cb275-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-21"><a href="network-visualization.html#cb275-21" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">574578</span>)</span>
<span id="cb275-22"><a href="network-visualization.html#cb275-22" aria-hidden="true" tabindex="-1"></a>g0<span class="fl">.75</span> <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(AD1350sim_cut0_75, <span class="at">layout=</span><span class="st">&quot;fr&quot;</span>) <span class="sc">+</span></span>
<span id="cb275-23"><a href="network-visualization.html#cb275-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link0</span>(<span class="at">edge_colour=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb275-24"><a href="network-visualization.html#cb275-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill=</span><span class="st">&#39;gray&#39;</span>) <span class="sc">+</span></span>
<span id="cb275-25"><a href="network-visualization.html#cb275-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;0.50&quot;</span>) <span class="sc">+</span></span>
<span id="cb275-26"><a href="network-visualization.html#cb275-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>() </span>
<span id="cb275-27"><a href="network-visualization.html#cb275-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-28"><a href="network-visualization.html#cb275-28" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7343</span>)</span>
<span id="cb275-29"><a href="network-visualization.html#cb275-29" aria-hidden="true" tabindex="-1"></a>g0<span class="fl">.90</span> <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(AD1350sim_cut0_9, <span class="at">layout=</span><span class="st">&quot;fr&quot;</span>) <span class="sc">+</span></span>
<span id="cb275-30"><a href="network-visualization.html#cb275-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link0</span>(<span class="at">edge_colour=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb275-31"><a href="network-visualization.html#cb275-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill=</span><span class="st">&#39;gray&#39;</span>) <span class="sc">+</span></span>
<span id="cb275-32"><a href="network-visualization.html#cb275-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;0.75&quot;</span>) <span class="sc">+</span></span>
<span id="cb275-33"><a href="network-visualization.html#cb275-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>() </span>
<span id="cb275-34"><a href="network-visualization.html#cb275-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-35"><a href="network-visualization.html#cb275-35" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(g0<span class="fl">.50</span>, g0<span class="fl">.75</span>, g0<span class="fl">.90</span>, <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig6_16-1.png" width="1152" /></p>
</div>
<div id="Figure_6_17" class="section level3" number="6.4.17">
<h3><span class="header-section-number">6.4.17</span> Figure 6.17: Edge Bundling</h3>
<p>Fig. 6.17. Network map of ceramic similarity from the U.S. Southwest/Mexican Northwest ca. A.D. 1350-1400 based on the hammer bundling algorithm.</p>
<p>This function relies on the “edgebundle” package to combine sets of nodes with similar relations into single paths. <a href="data/Figure6_17.Rdata">Use these data</a> to follow along. Note that this procedure can take several seconds to a few minutes depending on the speed of your computer. Note that this figure will look somewhat different from the one in the book as the locations of sites have been jittered for data security</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="network-visualization.html#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb276-2"><a href="network-visualization.html#cb276-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb276-3"><a href="network-visualization.html#cb276-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(edgebundle)</span>
<span id="cb276-4"><a href="network-visualization.html#cb276-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggmap)</span>
<span id="cb276-5"><a href="network-visualization.html#cb276-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb276-6"><a href="network-visualization.html#cb276-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-7"><a href="network-visualization.html#cb276-7" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&#39;data/Figure6_17.Rdata&#39;</span>)</span>
<span id="cb276-8"><a href="network-visualization.html#cb276-8" aria-hidden="true" tabindex="-1"></a><span class="co"># attr.dat - site attribute data</span></span>
<span id="cb276-9"><a href="network-visualization.html#cb276-9" aria-hidden="true" tabindex="-1"></a><span class="co"># g.net - igraph network object</span></span>
<span id="cb276-10"><a href="network-visualization.html#cb276-10" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&#39;data/map.RData&#39;</span>)</span>
<span id="cb276-11"><a href="network-visualization.html#cb276-11" aria-hidden="true" tabindex="-1"></a><span class="co"># map3 - state outlines</span></span>
<span id="cb276-12"><a href="network-visualization.html#cb276-12" aria-hidden="true" tabindex="-1"></a><span class="co"># base2 - terrain basemap in black and white</span></span>
<span id="cb276-13"><a href="network-visualization.html#cb276-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-14"><a href="network-visualization.html#cb276-14" aria-hidden="true" tabindex="-1"></a>locations_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(attr.dat, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;V3&quot;</span>, <span class="st">&quot;V4&quot;</span>), <span class="at">crs =</span> <span class="dv">26912</span>)</span>
<span id="cb276-15"><a href="network-visualization.html#cb276-15" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(locations_sf,<span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb276-16"><a href="network-visualization.html#cb276-16" aria-hidden="true" tabindex="-1"></a>coord1 <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">st_geometry</span>(z)) <span class="sc">%&gt;%</span> </span>
<span id="cb276-17"><a href="network-visualization.html#cb276-17" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">&quot;lon&quot;</span>,<span class="st">&quot;lat&quot;</span>))</span>
<span id="cb276-18"><a href="network-visualization.html#cb276-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-19"><a href="network-visualization.html#cb276-19" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(coord1)</span>
<span id="cb276-20"><a href="network-visualization.html#cb276-20" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(xy) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;x&#39;</span>,<span class="st">&#39;y&#39;</span>)</span>
<span id="cb276-21"><a href="network-visualization.html#cb276-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-22"><a href="network-visualization.html#cb276-22" aria-hidden="true" tabindex="-1"></a>hbundle <span class="ot">&lt;-</span> <span class="fu">edge_bundle_hammer</span>(g.net,xy,<span class="at">bw =</span><span class="fl">0.9</span>, <span class="at">decay =</span> <span class="fl">0.2</span>)</span>
<span id="cb276-23"><a href="network-visualization.html#cb276-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-24"><a href="network-visualization.html#cb276-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggmap</span>(base2,<span class="at">darken=</span><span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb276-25"><a href="network-visualization.html#cb276-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data=</span>map3, <span class="fu">aes</span>(x, y, <span class="at">group=</span>Group<span class="fl">.1</span>),<span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.5</span>,<span class="at">fill=</span><span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb276-26"><a href="network-visualization.html#cb276-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> hbundle,<span class="fu">aes</span>(x,y,<span class="at">group=</span>group),<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb276-27"><a href="network-visualization.html#cb276-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> hbundle,<span class="fu">aes</span>(x,y,<span class="at">group=</span>group),<span class="at">color=</span><span class="st">&quot;darkorchid4&quot;</span>,  <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb276-28"><a href="network-visualization.html#cb276-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> xy,<span class="fu">aes</span>(x,y),<span class="at">alpha=</span><span class="fl">0.4</span>, <span class="at">size=</span><span class="fl">2.5</span>, <span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb276-29"><a href="network-visualization.html#cb276-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig6_17-1.png" width="768" /></p>
</div>
<div id="Figure_6_18" class="section level3" number="6.4.18">
<h3><span class="header-section-number">6.4.18</span> Figure 6.18: Group-in-a-box</h3>
<p>Fig. 6.18. Example of a group-in-a-box custom graph layout created in NodeXL based on ceramic similarity data from the U.S. Southwest/Mexican Northwest ca. AD 1350-1400.</p>
<p>The group-in-a-box network format is, as far as we are aware, currently only implemented in the <a href="https://www.smrfoundation.org/nodexl/">NodeXL</a> platform. This software package is an add-in for Microsoft Excel that allows for the creation and analysis of network graphs using a wide variety of useful visualization tools. To produce a “Group-in-a-box” layout you simply need to paste a set of edge list values into the NodeXL Excel Template, define groups (based on an algorithm or some vertex attribute), and the be sure to select “Layout each of the graph’s groups in its own box” in the layout options.</p>
<p>For more details on how to use NodeXL see the extensive documentation online. There are commercial versions of the software available but the group-in-a-box example shown here can be produced in the free version.</p>
<p><img src="images/group-in-a-box.jpg" /></p>
<p>To download an Excel workbook set up for the example provided in the book <a href="%22data/NodeXLGraph1.xlsx%22">click here</a>.</p>
</div>
<div id="Figure_6_19" class="section level3" number="6.4.19">
<h3><span class="header-section-number">6.4.19</span> Figure 6.19: Weighted Adjacency Matrix</h3>
<p>Fig. 6.19. Dual display of a network graph and associated weighted adjacency matrix based on Peeples (2018) ceramic technology data.</p>
<p>This plot uses a sub-set of the Cibola technological similarity network data to produce both a typical node-link diagram and an associated weighted adjacency matrix. <a href="data/Figure6_19.Rdata">Use these data</a> to follow along.</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="network-visualization.html#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb277-2"><a href="network-visualization.html#cb277-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb277-3"><a href="network-visualization.html#cb277-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb277-4"><a href="network-visualization.html#cb277-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-5"><a href="network-visualization.html#cb277-5" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/Figure6_19.Rdata&quot;</span>)</span>
<span id="cb277-6"><a href="network-visualization.html#cb277-6" aria-hidden="true" tabindex="-1"></a><span class="co"># graph6.18 - graph object in igraph format</span></span>
<span id="cb277-7"><a href="network-visualization.html#cb277-7" aria-hidden="true" tabindex="-1"></a><span class="co"># node_list - dataframe with node details</span></span>
<span id="cb277-8"><a href="network-visualization.html#cb277-8" aria-hidden="true" tabindex="-1"></a><span class="co"># edge_list - edge_list which contains information on groups and edge weight</span></span>
<span id="cb277-9"><a href="network-visualization.html#cb277-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-10"><a href="network-visualization.html#cb277-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">343645</span>)</span>
<span id="cb277-11"><a href="network-visualization.html#cb277-11" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">layout_with_fr</span>(graph6<span class="fl">.18</span>)</span>
<span id="cb277-12"><a href="network-visualization.html#cb277-12" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(graph6<span class="fl">.18</span>, <span class="st">&quot;manual&quot;</span>,</span>
<span id="cb277-13"><a href="network-visualization.html#cb277-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span>coords[,<span class="dv">1</span>],</span>
<span id="cb277-14"><a href="network-visualization.html#cb277-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span>coords[,<span class="dv">2</span>]) <span class="sc">+</span></span>
<span id="cb277-15"><a href="network-visualization.html#cb277-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(),<span class="at">color=</span><span class="st">&#39;gray75&#39;</span>,<span class="at">alpha=</span><span class="fl">0.5</span>,<span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb277-16"><a href="network-visualization.html#cb277-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="fu">as.factor</span>(<span class="fu">V</span>(graph6<span class="fl">.18</span>)<span class="sc">$</span>comm), <span class="at">size=</span><span class="dv">5</span>), <span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb277-17"><a href="network-visualization.html#cb277-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&#39;#8da0cb&#39;</span>,<span class="st">&#39;#66c2a5&#39;</span>,<span class="st">&#39;#fc8d62&#39;</span>), <span class="at">guide=</span>F) <span class="sc">+</span></span>
<span id="cb277-18"><a href="network-visualization.html#cb277-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span>
<span id="cb277-19"><a href="network-visualization.html#cb277-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-20"><a href="network-visualization.html#cb277-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Set order of nodes to order in which they appear in the y axis in the network graph above</span></span>
<span id="cb277-21"><a href="network-visualization.html#cb277-21" aria-hidden="true" tabindex="-1"></a>name_order <span class="ot">&lt;-</span> node_list[<span class="fu">order</span>(coords[,<span class="dv">2</span>]),]<span class="sc">$</span>name</span>
<span id="cb277-22"><a href="network-visualization.html#cb277-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-23"><a href="network-visualization.html#cb277-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust the &#39;to&#39; and &#39;from&#39; factor levels so they are equal</span></span>
<span id="cb277-24"><a href="network-visualization.html#cb277-24" aria-hidden="true" tabindex="-1"></a><span class="co"># to this complete list of node names</span></span>
<span id="cb277-25"><a href="network-visualization.html#cb277-25" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> edge_list <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb277-26"><a href="network-visualization.html#cb277-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">to =</span> <span class="fu">factor</span>(to, <span class="at">levels =</span> name_order),</span>
<span id="cb277-27"><a href="network-visualization.html#cb277-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">from =</span> <span class="fu">factor</span>(from, <span class="at">levels =</span> <span class="fu">rev</span>(name_order)))</span>
<span id="cb277-28"><a href="network-visualization.html#cb277-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-29"><a href="network-visualization.html#cb277-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Now run the ggplot code again</span></span>
<span id="cb277-30"><a href="network-visualization.html#cb277-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the adjacency matrix plot</span></span>
<span id="cb277-31"><a href="network-visualization.html#cb277-31" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> from, <span class="at">y =</span> to, <span class="at">fill =</span> group, <span class="at">alpha =</span> (weight<span class="sc">*</span><span class="fl">1.5</span>))) <span class="sc">+</span></span>
<span id="cb277-32"><a href="network-visualization.html#cb277-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb277-33"><a href="network-visualization.html#cb277-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb277-34"><a href="network-visualization.html#cb277-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">drop =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb277-35"><a href="network-visualization.html#cb277-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">drop =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb277-36"><a href="network-visualization.html#cb277-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">270</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb277-37"><a href="network-visualization.html#cb277-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb277-38"><a href="network-visualization.html#cb277-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">aspect.ratio =</span> <span class="dv">1</span>, </span>
<span id="cb277-39"><a href="network-visualization.html#cb277-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb277-40"><a href="network-visualization.html#cb277-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;&#39;</span>) <span class="sc">+</span></span>
<span id="cb277-41"><a href="network-visualization.html#cb277-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;&#39;</span>) <span class="sc">+</span></span>
<span id="cb277-42"><a href="network-visualization.html#cb277-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&#39;#8da0cb&#39;</span>,<span class="st">&#39;#66c2a5&#39;</span>,<span class="st">&#39;#fc8d62&#39;</span>,<span class="st">&#39;black&#39;</span>), <span class="at">guide=</span>F)</span>
<span id="cb277-43"><a href="network-visualization.html#cb277-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-44"><a href="network-visualization.html#cb277-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine into a single figure</span></span>
<span id="cb277-45"><a href="network-visualization.html#cb277-45" aria-hidden="true" tabindex="-1"></a>figure6_19 <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(g1,g2,<span class="at">nrow=</span><span class="dv">1</span>)</span>
<span id="cb277-46"><a href="network-visualization.html#cb277-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-47"><a href="network-visualization.html#cb277-47" aria-hidden="true" tabindex="-1"></a>figure6_19</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig6_18-1.png" width="1152" /></p>
</div>
<div id="Figure_6_20" class="section level3" number="6.4.20">
<h3><span class="header-section-number">6.4.20</span> Figure 6.20: Nodetrix Diagram</h3>
<p>Fig. 6.20. Nodetrix visualization of the Peeples (2018) ceramic technological data showing one dense cluster as an adjacency matrix and the remainder of the graph as a node-link diagram.</p>
<p>This Nodetrix interactive visualization was created using the Javascript implementation available on <a href="https://github.com/IRT-SystemX/nodetrix">GitHub</a> by user <a href="https://github.com/jdfekete/">jdfekete</a>, Jean-Daniel Fekete who was one of the original authors of the method (Henry et al. 2007).</p>
<p>The details of running the Javascript program are described on the GitHub page and are beyond this scope of this tutorial. We do illustrate below, however, how you can export R in the *.json format required by this program using the “d3r” and “rjson” packages.</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="network-visualization.html#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(d3r)</span>
<span id="cb278-2"><a href="network-visualization.html#cb278-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rjson)</span>
<span id="cb278-3"><a href="network-visualization.html#cb278-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-4"><a href="network-visualization.html#cb278-4" aria-hidden="true" tabindex="-1"></a><span class="co"># net &lt;- igraph network object</span></span>
<span id="cb278-5"><a href="network-visualization.html#cb278-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-6"><a href="network-visualization.html#cb278-6" aria-hidden="true" tabindex="-1"></a>data_json <span class="ot">&lt;-</span> <span class="fu">d3_igraph</span>(net)</span>
<span id="cb278-7"><a href="network-visualization.html#cb278-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-8"><a href="network-visualization.html#cb278-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-9"><a href="network-visualization.html#cb278-9" aria-hidden="true" tabindex="-1"></a>  dj <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(data_json)</span>
<span id="cb278-10"><a href="network-visualization.html#cb278-10" aria-hidden="true" tabindex="-1"></a>  dj<span class="sc">$</span>links[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(dj<span class="sc">$</span>links[[<span class="dv">1</span>]]) </span>
<span id="cb278-11"><a href="network-visualization.html#cb278-11" aria-hidden="true" tabindex="-1"></a>  dj<span class="sc">$</span>links[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(dj<span class="sc">$</span>links[[<span class="dv">2</span>]]) </span>
<span id="cb278-12"><a href="network-visualization.html#cb278-12" aria-hidden="true" tabindex="-1"></a>  dj <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">toJSON</span>(dj)</span>
<span id="cb278-13"><a href="network-visualization.html#cb278-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-14"><a href="network-visualization.html#cb278-14" aria-hidden="true" tabindex="-1"></a><span class="fu">write</span>(dj, <span class="st">&quot;network.json&quot;</span>)</span></code></pre></div>
</div>
<div id="Figure_6_21" class="section level3" number="6.4.21">
<h3><span class="header-section-number">6.4.21</span> Figure 6.21: The Filmstrip Approach</h3>
<p>Fig. 6.21. A demonstration of the filmstrip approach to plotting longitudinal network data. These data represent networks of ceramic similarity in the San Pedro Valley of Arizona for three consecutive 50-year intervals.</p>
<p><a href="data/Figure6_21.Rdata">Use these data</a> to replicate the figures shown here.</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="network-visualization.html#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb279-2"><a href="network-visualization.html#cb279-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb279-3"><a href="network-visualization.html#cb279-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb279-4"><a href="network-visualization.html#cb279-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-5"><a href="network-visualization.html#cb279-5" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/Figure6_21.Rdata&quot;</span>)</span>
<span id="cb279-6"><a href="network-visualization.html#cb279-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-7"><a href="network-visualization.html#cb279-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4543</span>)</span>
<span id="cb279-8"><a href="network-visualization.html#cb279-8" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(AD1250net, <span class="st">&quot;kk&quot;</span>) <span class="sc">+</span></span>
<span id="cb279-9"><a href="network-visualization.html#cb279-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(),<span class="at">color=</span><span class="st">&#39;gray75&#39;</span>,<span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb279-10"><a href="network-visualization.html#cb279-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(), <span class="at">size=</span><span class="dv">5</span>, <span class="at">show.legend=</span>F, <span class="at">color=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb279-11"><a href="network-visualization.html#cb279-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;AD1250-1300&quot;</span>) <span class="sc">+</span></span>
<span id="cb279-12"><a href="network-visualization.html#cb279-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span>
<span id="cb279-13"><a href="network-visualization.html#cb279-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-14"><a href="network-visualization.html#cb279-14" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4543</span>)</span>
<span id="cb279-15"><a href="network-visualization.html#cb279-15" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(AD1300net, <span class="st">&quot;kk&quot;</span>) <span class="sc">+</span></span>
<span id="cb279-16"><a href="network-visualization.html#cb279-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(),<span class="at">color=</span><span class="st">&#39;gray75&#39;</span>,<span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb279-17"><a href="network-visualization.html#cb279-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(), <span class="at">size=</span><span class="dv">5</span>, <span class="at">show.legend=</span>F, <span class="at">color=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb279-18"><a href="network-visualization.html#cb279-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;AD1300-1350&quot;</span>) <span class="sc">+</span></span>
<span id="cb279-19"><a href="network-visualization.html#cb279-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span>
<span id="cb279-20"><a href="network-visualization.html#cb279-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-21"><a href="network-visualization.html#cb279-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-22"><a href="network-visualization.html#cb279-22" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4543</span>)</span>
<span id="cb279-23"><a href="network-visualization.html#cb279-23" aria-hidden="true" tabindex="-1"></a>g3 <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(AD1350net, <span class="st">&quot;kk&quot;</span>) <span class="sc">+</span></span>
<span id="cb279-24"><a href="network-visualization.html#cb279-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(),<span class="at">color=</span><span class="st">&#39;gray75&#39;</span>,<span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb279-25"><a href="network-visualization.html#cb279-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(), <span class="at">size=</span><span class="dv">5</span>, <span class="at">show.legend=</span>F, <span class="at">color=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb279-26"><a href="network-visualization.html#cb279-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;AD1350-1400&quot;</span>) <span class="sc">+</span></span>
<span id="cb279-27"><a href="network-visualization.html#cb279-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span>
<span id="cb279-28"><a href="network-visualization.html#cb279-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-29"><a href="network-visualization.html#cb279-29" aria-hidden="true" tabindex="-1"></a>figure6_21 <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(g1,g2,g3, <span class="at">nrow=</span><span class="dv">1</span>)</span>
<span id="cb279-30"><a href="network-visualization.html#cb279-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-31"><a href="network-visualization.html#cb279-31" aria-hidden="true" tabindex="-1"></a>figure6_21</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig6_21-1.png" width="1536" /></p>
</div>
<div id="Figure_6_22" class="section level3" number="6.4.22">
<h3><span class="header-section-number">6.4.22</span> Figure 6.22: Similtaneous Display</h3>
<p>Fig. 6.22. Examples of simultaneous display of two consecutive intervals for the San Pedro valley ceramic similarity network. A) A network using the Kamada-Kawai algorithm with edges color coded based on time period. B) An arc plot showing ties in consecutive intervals above and below the line.</p>
<p><a href="data/Figure6_22.Rdata">Use these data</a> to follow along.</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="network-visualization.html#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb280-2"><a href="network-visualization.html#cb280-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb280-3"><a href="network-visualization.html#cb280-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb280-4"><a href="network-visualization.html#cb280-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb280-5"><a href="network-visualization.html#cb280-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-6"><a href="network-visualization.html#cb280-6" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/Figure6_22.Rdata&quot;</span>)</span>
<span id="cb280-7"><a href="network-visualization.html#cb280-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-8"><a href="network-visualization.html#cb280-8" aria-hidden="true" tabindex="-1"></a>graph <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(net.all)</span>
<span id="cb280-9"><a href="network-visualization.html#cb280-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-10"><a href="network-visualization.html#cb280-10" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">layout_with_kk</span>(graph)</span>
<span id="cb280-11"><a href="network-visualization.html#cb280-11" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">cbind</span>(sites,xy)</span>
<span id="cb280-12"><a href="network-visualization.html#cb280-12" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(xy)</span>
<span id="cb280-13"><a href="network-visualization.html#cb280-13" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(xy) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;site&#39;</span>,<span class="st">&#39;x&#39;</span>,<span class="st">&#39;y&#39;</span>)</span>
<span id="cb280-14"><a href="network-visualization.html#cb280-14" aria-hidden="true" tabindex="-1"></a>xy<span class="sc">$</span>x <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(xy<span class="sc">$</span>x)</span>
<span id="cb280-15"><a href="network-visualization.html#cb280-15" aria-hidden="true" tabindex="-1"></a>xy<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(xy<span class="sc">$</span>y)</span>
<span id="cb280-16"><a href="network-visualization.html#cb280-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-17"><a href="network-visualization.html#cb280-17" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">6436</span>)</span>
<span id="cb280-18"><a href="network-visualization.html#cb280-18" aria-hidden="true" tabindex="-1"></a>similt.net <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(graph,<span class="at">layout=</span><span class="st">&quot;manual&quot;</span>,</span>
<span id="cb280-19"><a href="network-visualization.html#cb280-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x=</span>xy<span class="sc">$</span>x, <span class="at">y=</span>xy<span class="sc">$</span>y) <span class="sc">+</span> </span>
<span id="cb280-20"><a href="network-visualization.html#cb280-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Period), <span class="at">alpha=</span><span class="fl">0.3</span>, <span class="at">width=</span><span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb280-21"><a href="network-visualization.html#cb280-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_node_point</span>(<span class="at">size=</span><span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb280-22"><a href="network-visualization.html#cb280-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">label=</span>site), <span class="at">data=</span>xy, <span class="at">size=</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb280-23"><a href="network-visualization.html#cb280-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>() <span class="sc">+</span></span>
<span id="cb280-24"><a href="network-visualization.html#cb280-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb280-25"><a href="network-visualization.html#cb280-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb280-26"><a href="network-visualization.html#cb280-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.height=</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&#39;cm&#39;</span>),</span>
<span id="cb280-27"><a href="network-visualization.html#cb280-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width=</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">&#39;cm&#39;</span>))</span>
<span id="cb280-28"><a href="network-visualization.html#cb280-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-29"><a href="network-visualization.html#cb280-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the graph</span></span>
<span id="cb280-30"><a href="network-visualization.html#cb280-30" aria-hidden="true" tabindex="-1"></a>lin.net <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(SPgraph, <span class="at">layout=</span><span class="st">&quot;linear&quot;</span>) <span class="sc">+</span> </span>
<span id="cb280-31"><a href="network-visualization.html#cb280-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_arc</span>(<span class="at">edge_colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">edge_alpha=</span><span class="fl">0.4</span>, <span class="at">edge_width=</span><span class="fl">0.3</span>, <span class="at">fold=</span>F, <span class="at">strength=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb280-32"><a href="network-visualization.html#cb280-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size=</span>igraph<span class="sc">::</span><span class="fu">degree</span>(SPgraph)), <span class="at">col=</span><span class="st">&#39;red&#39;</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb280-33"><a href="network-visualization.html#cb280-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb280-34"><a href="network-visualization.html#cb280-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>() <span class="sc">+</span></span>
<span id="cb280-35"><a href="network-visualization.html#cb280-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title=</span><span class="fu">element_blank</span>(), <span class="at">plot.margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.4</span>,<span class="dv">0</span>), <span class="st">&quot;null&quot;</span>),</span>
<span id="cb280-36"><a href="network-visualization.html#cb280-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">3.4</span>,<span class="dv">0</span>), <span class="st">&quot;null&quot;</span>)) <span class="sc">+</span></span>
<span id="cb280-37"><a href="network-visualization.html#cb280-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="dv">3</span>, <span class="at">label =</span> <span class="st">&quot;AD 1250-1300&quot;</span>,<span class="at">size=</span><span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb280-38"><a href="network-visualization.html#cb280-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">label =</span> <span class="st">&quot;AD 1300-1350&quot;</span>,<span class="at">size=</span><span class="dv">6</span>) </span>
<span id="cb280-39"><a href="network-visualization.html#cb280-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-40"><a href="network-visualization.html#cb280-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-41"><a href="network-visualization.html#cb280-41" aria-hidden="true" tabindex="-1"></a>figure6_22 <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(similt.net,lin.net, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&#39;(a)&#39;</span>,<span class="st">&#39;(b)&#39;</span>), <span class="at">font.label=</span><span class="fu">list</span>(<span class="at">size=</span><span class="dv">28</span>))</span>
<span id="cb280-42"><a href="network-visualization.html#cb280-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-43"><a href="network-visualization.html#cb280-43" aria-hidden="true" tabindex="-1"></a>figure6_22</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-76-1.png" width="1536" /></p>
</div>
<div id="Figure_6_23" class="section level3" number="6.4.23">
<h3><span class="header-section-number">6.4.23</span> Figure 6:23: Timelines and Time Prisms</h3>
<p>Fig. 6.23. This plot shows two displays of the same ceramic similarity data from the Sonoran Desert in the U.S. Southwest as a time prism (top) and timeline (bottom).</p>
<p><a href="data/Figure6_23.Rdata">Use these data</a> to follow along.</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="network-visualization.html#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(networkDynamic)</span>
<span id="cb281-2"><a href="network-visualization.html#cb281-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ndtv)</span>
<span id="cb281-3"><a href="network-visualization.html#cb281-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GISTools)</span>
<span id="cb281-4"><a href="network-visualization.html#cb281-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statnet)</span>
<span id="cb281-5"><a href="network-visualization.html#cb281-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-6"><a href="network-visualization.html#cb281-6" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/Figure6_23.Rdata&quot;</span>)</span>
<span id="cb281-7"><a href="network-visualization.html#cb281-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-8"><a href="network-visualization.html#cb281-8" aria-hidden="true" tabindex="-1"></a><span class="co"># create networkDynamic object from list containing multiple sna network objects</span></span>
<span id="cb281-9"><a href="network-visualization.html#cb281-9" aria-hidden="true" tabindex="-1"></a>SanPedro <span class="ot">&lt;-</span> <span class="fu">networkDynamic</span>(<span class="at">network.list=</span>SP_nets)</span></code></pre></div>
<pre><code>## Neither start or onsets specified, assuming start=0
## Onsets and termini not specified, assuming each network in network.list should have a discrete spell of length 1
## Argument base.net not specified, using first element of network.list instead
## Created net.obs.period to describe network
##  Network observation period info:
##   Number of observation spells: 1 
##   Maximal time range observed: 0 until 5 
##   Temporal mode: discrete 
##   Time unit: step 
##   Suggested time increment: 1</code></pre>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="network-visualization.html#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute animation</span></span>
<span id="cb283-2"><a href="network-visualization.html#cb283-2" aria-hidden="true" tabindex="-1"></a><span class="fu">compute.animation</span>(SanPedro,<span class="at">default.dist=</span><span class="dv">7</span>,<span class="at">animation.mode=</span><span class="st">&#39;MDSJ&#39;</span>)</span></code></pre></div>
<pre><code>## slice parameters:
##   start:0
##   end:5
##   interval:1
##   aggregate.dur:1
##   rule:latest
## 
## [1] &quot;MDSJ starting stress: 5301.0321631597235&quot;
## [2] &quot;MDSJ ending stress: 959.3931260598061&quot;   
## [1] &quot;MDSJ starting stress: 1412.9386478448037&quot;
## [2] &quot;MDSJ ending stress: 954.2950407347979&quot;   
## [1] &quot;MDSJ starting stress: 9810.976270201782&quot;
## [2] &quot;MDSJ ending stress: 791.5729096917316&quot;  
## [1] &quot;MDSJ starting stress: 30913.244468471563&quot;
## [2] &quot;MDSJ ending stress: 564.6472778023632&quot;   
## [1] &quot;MDSJ starting stress: 604.3977587716274&quot;
## [2] &quot;MDSJ ending stress: 562.5011911547776&quot;</code></pre>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="network-visualization.html#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define colors for regions</span></span>
<span id="cb285-2"><a href="network-visualization.html#cb285-2" aria-hidden="true" tabindex="-1"></a>mycol <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">add.alpha</span>(<span class="st">&#39;#1b9e77&#39;</span>,<span class="fl">0.75</span>),<span class="fu">add.alpha</span>(<span class="st">&#39;#d95f02&#39;</span>,<span class="fl">0.75</span>),<span class="fu">add.alpha</span>(<span class="st">&#39;#7570b3&#39;</span>,<span class="fl">0.75</span>),</span>
<span id="cb285-3"><a href="network-visualization.html#cb285-3" aria-hidden="true" tabindex="-1"></a>           <span class="fu">add.alpha</span>(<span class="st">&#39;#e7298a&#39;</span>,<span class="fl">0.75</span>),<span class="fu">add.alpha</span>(<span class="st">&#39;#66a61e&#39;</span>,<span class="fl">0.75</span>),<span class="fu">add.alpha</span>(<span class="st">&#39;#e6ab02&#39;</span>,<span class="fl">0.75</span>))</span>
<span id="cb285-4"><a href="network-visualization.html#cb285-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-5"><a href="network-visualization.html#cb285-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot time prism</span></span>
<span id="cb285-6"><a href="network-visualization.html#cb285-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">364467</span>)</span>
<span id="cb285-7"><a href="network-visualization.html#cb285-7" aria-hidden="true" tabindex="-1"></a><span class="fu">timePrism</span>(SanPedro,<span class="at">at=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),</span>
<span id="cb285-8"><a href="network-visualization.html#cb285-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">displaylabels=</span>F,<span class="at">planes =</span> <span class="cn">TRUE</span>, <span class="at">display.isolates=</span>F,</span>
<span id="cb285-9"><a href="network-visualization.html#cb285-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">label.cex=</span><span class="fl">0.5</span>, <span class="at">usearrows=</span>F,<span class="at">vertex.cex=</span><span class="fl">0.5</span>, <span class="at">edge.col=</span><span class="st">&#39;gray50&#39;</span>,<span class="at">vertex.col=</span>mycol[<span class="fu">factor</span>(SP_attr<span class="sc">$</span>SWSN_MacroGroup)])</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig6_23-1.png" width="672" /></p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="network-visualization.html#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot proximity timeline</span></span>
<span id="cb286-2"><a href="network-visualization.html#cb286-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">235254</span>)</span>
<span id="cb286-3"><a href="network-visualization.html#cb286-3" aria-hidden="true" tabindex="-1"></a><span class="fu">proximity.timeline</span>(SanPedro,<span class="at">default.dist=</span><span class="dv">10</span>,</span>
<span id="cb286-4"><a href="network-visualization.html#cb286-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mode=</span><span class="st">&#39;sammon&#39;</span>,<span class="at">labels.at=</span><span class="dv">17</span>,<span class="at">vertex.cex=</span><span class="dv">4</span>,<span class="at">render.edges=</span>F, <span class="at">vertex.col=</span>mycol[<span class="fu">factor</span>(SP_attr<span class="sc">$</span>SWSN_MacroGroup)],</span>
<span id="cb286-5"><a href="network-visualization.html#cb286-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">chain.direction =</span> <span class="st">&#39;reverse&#39;</span>,<span class="at">xaxt=</span><span class="st">&#39;n&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Fig6_23-2.png" width="672" /></p>
</div>
<div id="Figure_6_24" class="section level3" number="6.4.24">
<h3><span class="header-section-number">6.4.24</span> Figure 6.24: Animation</h3>
<p>Fig. 6.24. An example of three frames from a network animation.</p>
<p>Figure 6.24 was created using the ndtv package and the same data produced above for figure 6.23. We simply rendered the animation as above and then output to an interactive html widget. The figure in the book represents 3 screen shots from the video. See the ndtv documentation for more details.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="network-visualization.html#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="fu">render.d3movie</span>(SanPedro, <span class="at">vertex.col=</span>mycol[<span class="fu">factor</span>(SP_attr<span class="sc">$</span>SWSN_MacroGroup)], <span class="at">output.mode =</span> <span class="st">&quot;HTML&quot;</span>)</span></code></pre></div>
<iframe width="800" height="800" src="images/SanPedro_ani.html">
</iframe>
</div>
<div id="Figure_6_25" class="section level3" number="6.4.25">
<h3><span class="header-section-number">6.4.25</span> Figure 6.25: Interactive Networks</h3>
<p>Fig. 6.25. An example of a dynamic network visual created in R. Notice how the nodes and edges are responding to the movement of the edge under the cursor and the drop down menu that allows selection of nodes by group.</p>
<p>For this example we closely follow an example provided on the <a href="https://kateto.net/network-visualization">Static and dynamic network visualization with R</a> workshop documents online but using the <a href="data/Figure6_25.Rdata">Cibola technological similarity data</a> instead.</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="network-visualization.html#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visNetwork)</span>
<span id="cb288-2"><a href="network-visualization.html#cb288-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(networkD3)</span>
<span id="cb288-3"><a href="network-visualization.html#cb288-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb288-4"><a href="network-visualization.html#cb288-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-5"><a href="network-visualization.html#cb288-5" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/Figure6_25.Rdata&quot;</span>) <span class="co"># Contains an igraph graph object</span></span>
<span id="cb288-6"><a href="network-visualization.html#cb288-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-7"><a href="network-visualization.html#cb288-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Use igraph to make the graph and find membership</span></span>
<span id="cb288-8"><a href="network-visualization.html#cb288-8" aria-hidden="true" tabindex="-1"></a>clust <span class="ot">&lt;-</span> <span class="fu">cluster_louvain</span>(graph)</span>
<span id="cb288-9"><a href="network-visualization.html#cb288-9" aria-hidden="true" tabindex="-1"></a>members <span class="ot">&lt;-</span> <span class="fu">membership</span>(clust)</span>
<span id="cb288-10"><a href="network-visualization.html#cb288-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-11"><a href="network-visualization.html#cb288-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to object suitable for networkD3</span></span>
<span id="cb288-12"><a href="network-visualization.html#cb288-12" aria-hidden="true" tabindex="-1"></a>graph_d3 <span class="ot">&lt;-</span> <span class="fu">igraph_to_networkD3</span>(graph, <span class="at">group =</span> members)</span>
<span id="cb288-13"><a href="network-visualization.html#cb288-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-14"><a href="network-visualization.html#cb288-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create force directed network plot</span></span>
<span id="cb288-15"><a href="network-visualization.html#cb288-15" aria-hidden="true" tabindex="-1"></a><span class="fu">forceNetwork</span>(<span class="at">Links =</span> graph_d3<span class="sc">$</span>links, <span class="at">Nodes =</span> graph_d3<span class="sc">$</span>nodes, </span>
<span id="cb288-16"><a href="network-visualization.html#cb288-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">Source =</span> <span class="st">&#39;source&#39;</span>, <span class="at">Target =</span> <span class="st">&#39;target&#39;</span>, </span>
<span id="cb288-17"><a href="network-visualization.html#cb288-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">NodeID =</span> <span class="st">&#39;name&#39;</span>, <span class="at">Group =</span> <span class="st">&#39;group&#39;</span>)</span></code></pre></div>
<div id="htmlwidget-039cb1ccaf3067b3f3ac" style="width:768px;height:768px;" class="forceNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-039cb1ccaf3067b3f3ac">{"x":{"links":{"source":[0,1,0,3,3,5,6,7,4,8,4,6,3,7,0,3,5,5,9,10,0,7,3,11,5,9,10,3,0,6,9,8,4,1,13,8,4,9,10,0,7,5,6,11,12,9,4,13,14,8,1,8,14,13,9,4,16,7,1,2,4,8,14,13,17,16,7,13,9,8,4,14,17,18,8,1,16,11,5,0,15,9,7,12,3,10,4,20,8,18,17,9,1,7,14,16,13,18,20,22,16,17,9,14,8,4,1,5,10,11,0,12,21,3,20,9,13,23,18,4,1,7,8,22,16,17,14,9,11,15,0,6,5,21,10,24,3,12,9,10,11,26,5,12,6,21,24,0,15,3,7,27,10,0,12,15,26,18,14,13,23,8,22,25,16,4,19],"target":[3,4,5,5,7,7,7,8,8,9,9,9,9,9,10,10,10,11,11,11,11,11,11,12,12,12,12,12,12,12,13,13,13,14,14,14,14,15,15,15,15,15,15,15,15,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,19,19,19,19,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,30,30,30,30,30,30,30,30,30,30],"colour":["#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666"]},"nodes":{"name":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31"],"group":[1,2,2,1,2,1,1,3,2,3,1,1,1,2,2,1,2,2,2,3,2,1,2,2,1,2,1,1,1,4,2]},"options":{"NodeID":"name","Group":"group","colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":7,"fontFamily":"serif","clickTextSize":17.5,"linkDistance":50,"linkWidth":"function(d) { return Math.sqrt(d.value); }","charge":-30,"opacity":0.6,"zoom":false,"legend":false,"arrows":false,"nodesize":false,"radiusCalculation":" Math.sqrt(d.nodesize)+6","bounded":false,"opacityNoHover":0,"clickAction":null}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="network-visualization.html#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modify interactive network to allow highlighting by groups, etc.</span></span>
<span id="cb289-2"><a href="network-visualization.html#cb289-2" aria-hidden="true" tabindex="-1"></a>links <span class="ot">&lt;-</span> graph_d3<span class="sc">$</span>links</span>
<span id="cb289-3"><a href="network-visualization.html#cb289-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(links) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;from&#39;</span>,<span class="st">&#39;to&#39;</span>)</span>
<span id="cb289-4"><a href="network-visualization.html#cb289-4" aria-hidden="true" tabindex="-1"></a>links[,<span class="dv">1</span>] <span class="ot">&lt;-</span> links[,<span class="dv">1</span>]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb289-5"><a href="network-visualization.html#cb289-5" aria-hidden="true" tabindex="-1"></a>links[,<span class="dv">2</span>] <span class="ot">&lt;-</span> links[,<span class="dv">2</span>]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb289-6"><a href="network-visualization.html#cb289-6" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> graph_d3<span class="sc">$</span>nodes</span>
<span id="cb289-7"><a href="network-visualization.html#cb289-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(nodes)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&#39;id&#39;</span></span>
<span id="cb289-8"><a href="network-visualization.html#cb289-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-9"><a href="network-visualization.html#cb289-9" aria-hidden="true" tabindex="-1"></a>vis.nodes <span class="ot">&lt;-</span> nodes</span>
<span id="cb289-10"><a href="network-visualization.html#cb289-10" aria-hidden="true" tabindex="-1"></a>vis.links <span class="ot">&lt;-</span> links</span>
<span id="cb289-11"><a href="network-visualization.html#cb289-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-12"><a href="network-visualization.html#cb289-12" aria-hidden="true" tabindex="-1"></a>vis.nodes<span class="sc">$</span>shape  <span class="ot">&lt;-</span> <span class="st">&quot;dot&quot;</span>  </span>
<span id="cb289-13"><a href="network-visualization.html#cb289-13" aria-hidden="true" tabindex="-1"></a>vis.nodes<span class="sc">$</span>shadow <span class="ot">&lt;-</span> <span class="cn">TRUE</span> <span class="co"># Nodes will drop shadow</span></span>
<span id="cb289-14"><a href="network-visualization.html#cb289-14" aria-hidden="true" tabindex="-1"></a>vis.nodes<span class="sc">$</span>borderWidth <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># Node border width</span></span>
<span id="cb289-15"><a href="network-visualization.html#cb289-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-16"><a href="network-visualization.html#cb289-16" aria-hidden="true" tabindex="-1"></a>vis.nodes<span class="sc">$</span>color.background <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;slategrey&quot;</span>, <span class="st">&quot;tomato&quot;</span>, <span class="st">&quot;gold&quot;</span>, <span class="st">&quot;purple&quot;</span>)[nodes<span class="sc">$</span>group]</span>
<span id="cb289-17"><a href="network-visualization.html#cb289-17" aria-hidden="true" tabindex="-1"></a>vis.nodes<span class="sc">$</span>color.border <span class="ot">&lt;-</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb289-18"><a href="network-visualization.html#cb289-18" aria-hidden="true" tabindex="-1"></a>vis.nodes<span class="sc">$</span>color.highlight.background <span class="ot">&lt;-</span> <span class="st">&quot;orange&quot;</span></span>
<span id="cb289-19"><a href="network-visualization.html#cb289-19" aria-hidden="true" tabindex="-1"></a>vis.nodes<span class="sc">$</span>color.highlight.border <span class="ot">&lt;-</span> <span class="st">&quot;darkred&quot;</span></span>
<span id="cb289-20"><a href="network-visualization.html#cb289-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-21"><a href="network-visualization.html#cb289-21" aria-hidden="true" tabindex="-1"></a>visnet <span class="ot">&lt;-</span> <span class="fu">visNetwork</span>(vis.nodes, vis.links)</span>
<span id="cb289-22"><a href="network-visualization.html#cb289-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-23"><a href="network-visualization.html#cb289-23" aria-hidden="true" tabindex="-1"></a><span class="fu">visOptions</span>(visnet, <span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, <span class="at">selectedBy =</span> <span class="st">&quot;group&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-d8553cae2344a3863bb4" style="width:768px;height:768px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-d8553cae2344a3863bb4">{"x":{"nodes":{"id":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31"],"group":[1,2,2,1,2,1,1,3,2,3,1,1,1,2,2,1,2,2,2,3,2,1,2,2,1,2,1,1,1,4,2],"shape":["dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot"],"shadow":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],"borderWidth":[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],"color.background":["slategrey","tomato","tomato","slategrey","tomato","slategrey","slategrey","gold","tomato","gold","slategrey","slategrey","slategrey","tomato","tomato","slategrey","tomato","tomato","tomato","gold","tomato","slategrey","tomato","tomato","slategrey","tomato","slategrey","slategrey","slategrey","purple","tomato"],"color.border":["black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black"],"color.highlight.background":["orange","orange","orange","orange","orange","orange","orange","orange","orange","orange","orange","orange","orange","orange","orange","orange","orange","orange","orange","orange","orange","orange","orange","orange","orange","orange","orange","orange","orange","orange","orange"],"color.highlight.border":["darkred","darkred","darkred","darkred","darkred","darkred","darkred","darkred","darkred","darkred","darkred","darkred","darkred","darkred","darkred","darkred","darkred","darkred","darkred","darkred","darkred","darkred","darkred","darkred","darkred","darkred","darkred","darkred","darkred","darkred","darkred"],"label":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31"]},"edges":{"from":[1,2,1,4,4,6,7,8,5,9,5,7,4,8,1,4,6,6,10,11,1,8,4,12,6,10,11,4,1,7,10,9,5,2,14,9,5,10,11,1,8,6,7,12,13,10,5,14,15,9,2,9,15,14,10,5,17,8,2,3,5,9,15,14,18,17,8,14,10,9,5,15,18,19,9,2,17,12,6,1,16,10,8,13,4,11,5,21,9,19,18,10,2,8,15,17,14,19,21,23,17,18,10,15,9,5,2,6,11,12,1,13,22,4,21,10,14,24,19,5,2,8,9,23,17,18,15,10,12,16,1,7,6,22,11,25,4,13,10,11,12,27,6,13,7,22,25,1,16,4,8,28,11,1,13,16,27,19,15,14,24,9,23,26,17,5,20],"to":[4,5,6,6,8,8,8,9,9,10,10,10,10,10,11,11,11,12,12,12,12,12,12,13,13,13,13,13,13,13,14,14,14,15,15,15,15,16,16,16,16,16,16,16,16,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,20,20,20,20,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,31,31,31,31,31,31,31,31,31,31]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false}},"groups":["1","2","3","4"],"width":null,"height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":true,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false,"variable":"group","main":"Select by group","values":[1,2,3,4]},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="figure-6.26-swsn-example-1" class="section level3" number="6.4.26">
<h3><span class="header-section-number">6.4.26</span> Figure 6.26: SWSN Example 1</h3>
<p>Fig. 6.26. Networks by time for the SWSN project area (from Mills et al. 2013).</p>
<p>The figure for the original plot in Mills et al. 2013 was produced in R and then compiled and modified using Adobe Illustrator. First a regional color scheme was defined and then each time period was plotted using this color scheme. In Illustrator components were arranged in rough geographic positions and isolates were placed at the margin.</p>
<p>The following chunk of code reproduces Figure 6.26 for one time period (AD1300-1350). <a href="data/Figure6_26.Rdata">Download these data</a> to follow along.</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="network-visualization.html#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statnet)</span>
<span id="cb290-2"><a href="network-visualization.html#cb290-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb290-3"><a href="network-visualization.html#cb290-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-4"><a href="network-visualization.html#cb290-4" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/Figure6_26.Rdata&quot;</span>)</span>
<span id="cb290-5"><a href="network-visualization.html#cb290-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-6"><a href="network-visualization.html#cb290-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sna network object</span></span>
<span id="cb290-7"><a href="network-visualization.html#cb290-7" aria-hidden="true" tabindex="-1"></a>net <span class="ot">&lt;-</span> <span class="fu">network</span>(<span class="fu">event2dichot</span>(sim, <span class="at">method=</span><span class="st">&quot;absolute&quot;</span>, <span class="at">thresh=</span><span class="fl">0.75</span>), <span class="at">directed=</span>F)</span>
<span id="cb290-8"><a href="network-visualization.html#cb290-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-9"><a href="network-visualization.html#cb290-9" aria-hidden="true" tabindex="-1"></a><span class="co"># define color scheme. colors listed in order based on the factor attr$Macro</span></span>
<span id="cb290-10"><a href="network-visualization.html#cb290-10" aria-hidden="true" tabindex="-1"></a>myCols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#000738&quot;</span>, <span class="st">&quot;#ffa1a1&quot;</span>, <span class="st">&quot;#ad71d8&quot;</span>, <span class="st">&quot;#016d1b&quot;</span>, <span class="st">&quot;#00ff30&quot;</span>, <span class="st">&quot;#92d8ff&quot;</span>, <span class="st">&quot;#ffffff&quot;</span>,</span>
<span id="cb290-11"><a href="network-visualization.html#cb290-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;#adadad&quot;</span>, <span class="st">&quot;#846b00&quot;</span>, <span class="st">&quot;#ff0000&quot;</span>, <span class="st">&quot;#5273dd&quot;</span>, <span class="st">&quot;#946a43&quot;</span>, <span class="st">&quot;#a00000&quot;</span>, <span class="st">&quot;#f97c00&quot;</span>,</span>
<span id="cb290-12"><a href="network-visualization.html#cb290-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;#00ffec&quot;</span>, <span class="st">&quot;#ffff3e&quot;</span>, <span class="st">&quot;#824444&quot;</span>, <span class="st">&quot;#00ba89&quot;</span>, <span class="st">&quot;#00ba89&quot;</span>, <span class="st">&quot;#0303ff&quot;</span>)</span>
<span id="cb290-13"><a href="network-visualization.html#cb290-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-14"><a href="network-visualization.html#cb290-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot network</span></span>
<span id="cb290-15"><a href="network-visualization.html#cb290-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">235</span>)</span>
<span id="cb290-16"><a href="network-visualization.html#cb290-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(net, <span class="at">layout=</span><span class="st">&quot;fr&quot;</span>) <span class="sc">+</span></span>
<span id="cb290-17"><a href="network-visualization.html#cb290-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb290-18"><a href="network-visualization.html#cb290-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">fill=</span><span class="fu">as.factor</span>(attr<span class="sc">$</span>Macro), <span class="at">size=</span><span class="fu">evcent</span>(net)), <span class="at">shape=</span><span class="dv">21</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb290-19"><a href="network-visualization.html#cb290-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range=</span><span class="fu">c</span>(<span class="fl">1.5</span>,<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb290-20"><a href="network-visualization.html#cb290-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> myCols) <span class="sc">+</span></span>
<span id="cb290-21"><a href="network-visualization.html#cb290-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-77-1.png" width="960" /></p>
</div>
<div id="figure-6.27-swsn-example-2" class="section level3" number="6.4.27">
<h3><span class="header-section-number">6.4.27</span> Figure 6.27: SWSN Example 2</h3>
<p>Fig. 6.27. An explicit geographic map network of the SWSN project area through time (Mills et al. 2013).</p>
<p>The original version of this figure was produced in ArcGIS using data prepared in R. Here we show how these same network maps with edges color coded by geogrpahic length can be produced in R. We provide code to prepare a map for one time period (AD1300-1350). <a href="data/Figure6_27.Rdata">Use these data</a> to follow along. Note that this figure will differ slightly from the one in the book and in the original Mills et al. 2013 publication as site locations have been jittered.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="network-visualization.html#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statnet)</span>
<span id="cb291-2"><a href="network-visualization.html#cb291-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb291-3"><a href="network-visualization.html#cb291-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(intergraph)</span>
<span id="cb291-4"><a href="network-visualization.html#cb291-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggmap)</span>
<span id="cb291-5"><a href="network-visualization.html#cb291-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb291-6"><a href="network-visualization.html#cb291-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-7"><a href="network-visualization.html#cb291-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in network and map data</span></span>
<span id="cb291-8"><a href="network-visualization.html#cb291-8" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/Figure6_27.Rdata&quot;</span>)</span>
<span id="cb291-9"><a href="network-visualization.html#cb291-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-10"><a href="network-visualization.html#cb291-10" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare network object</span></span>
<span id="cb291-11"><a href="network-visualization.html#cb291-11" aria-hidden="true" tabindex="-1"></a>net <span class="ot">&lt;-</span> <span class="fu">network</span>(<span class="fu">event2dichot</span>(sim,<span class="at">method=</span><span class="st">&#39;absolute&#39;</span>,<span class="at">thresh=</span><span class="fl">0.75</span>),<span class="at">directed=</span>F)</span>
<span id="cb291-12"><a href="network-visualization.html#cb291-12" aria-hidden="true" tabindex="-1"></a>r.net <span class="ot">&lt;-</span> <span class="fu">asIgraph</span>(net)</span>
<span id="cb291-13"><a href="network-visualization.html#cb291-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-14"><a href="network-visualization.html#cb291-14" aria-hidden="true" tabindex="-1"></a><span class="co"># convert coordinates to lat/long and covert to sf object</span></span>
<span id="cb291-15"><a href="network-visualization.html#cb291-15" aria-hidden="true" tabindex="-1"></a>locations_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(attr, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;EASTING&quot;</span>, <span class="st">&quot;NORTHING&quot;</span>), <span class="at">crs =</span> <span class="dv">26912</span>)</span>
<span id="cb291-16"><a href="network-visualization.html#cb291-16" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(locations_sf,<span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb291-17"><a href="network-visualization.html#cb291-17" aria-hidden="true" tabindex="-1"></a>coord1 <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">st_geometry</span>(z)) <span class="sc">%&gt;%</span> </span>
<span id="cb291-18"><a href="network-visualization.html#cb291-18" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">&quot;lon&quot;</span>,<span class="st">&quot;lat&quot;</span>))</span>
<span id="cb291-19"><a href="network-visualization.html#cb291-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-20"><a href="network-visualization.html#cb291-20" aria-hidden="true" tabindex="-1"></a><span class="co"># output coordinates in dataframe</span></span>
<span id="cb291-21"><a href="network-visualization.html#cb291-21" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(coord1)</span>
<span id="cb291-22"><a href="network-visualization.html#cb291-22" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(xy) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;x&#39;</span>,<span class="st">&#39;y&#39;</span>)</span>
<span id="cb291-23"><a href="network-visualization.html#cb291-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-24"><a href="network-visualization.html#cb291-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Create edgelist with xy coordinates for each source and target</span></span>
<span id="cb291-25"><a href="network-visualization.html#cb291-25" aria-hidden="true" tabindex="-1"></a>edgelist2 <span class="ot">&lt;-</span> <span class="fu">get.edgelist</span>(r.net)</span>
<span id="cb291-26"><a href="network-visualization.html#cb291-26" aria-hidden="true" tabindex="-1"></a>edges2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(xy[edgelist2[,<span class="dv">1</span>],], xy[edgelist2[,<span class="dv">2</span>],])</span>
<span id="cb291-27"><a href="network-visualization.html#cb291-27" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(edges2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X1&quot;</span>,<span class="st">&quot;Y1&quot;</span>,<span class="st">&quot;X2&quot;</span>,<span class="st">&quot;Y2&quot;</span>)</span>
<span id="cb291-28"><a href="network-visualization.html#cb291-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-29"><a href="network-visualization.html#cb291-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine the geographic distances of edges</span></span>
<span id="cb291-30"><a href="network-visualization.html#cb291-30" aria-hidden="true" tabindex="-1"></a>dist.meas <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb291-31"><a href="network-visualization.html#cb291-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(edges2)) {</span>
<span id="cb291-32"><a href="network-visualization.html#cb291-32" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(edges2[i,])</span>
<span id="cb291-33"><a href="network-visualization.html#cb291-33" aria-hidden="true" tabindex="-1"></a>  dist.meas[i] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">dist</span>(<span class="fu">rbind</span>(temp[<span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],temp[<span class="dv">1</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>])))<span class="sc">/</span><span class="fl">0.009</span></span>
<span id="cb291-34"><a href="network-visualization.html#cb291-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb291-35"><a href="network-visualization.html#cb291-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-36"><a href="network-visualization.html#cb291-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Order edges so shorest will plot last</span></span>
<span id="cb291-37"><a href="network-visualization.html#cb291-37" aria-hidden="true" tabindex="-1"></a>net.dat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(edges2,dist.meas))</span>
<span id="cb291-38"><a href="network-visualization.html#cb291-38" aria-hidden="true" tabindex="-1"></a>net.dat <span class="ot">&lt;-</span> net.dat[<span class="fu">order</span>(net.dat<span class="sc">$</span>dist.meas,<span class="at">decreasing=</span>T),]</span>
<span id="cb291-39"><a href="network-visualization.html#cb291-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-40"><a href="network-visualization.html#cb291-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Create bins in distance measurement</span></span>
<span id="cb291-41"><a href="network-visualization.html#cb291-41" aria-hidden="true" tabindex="-1"></a>net.dat <span class="ot">&lt;-</span> net.dat <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">DistBins =</span> <span class="fu">cut</span>(dist.meas, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>,<span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">250</span>,<span class="cn">Inf</span>)))</span>
<span id="cb291-42"><a href="network-visualization.html#cb291-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-43"><a href="network-visualization.html#cb291-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot network map</span></span>
<span id="cb291-44"><a href="network-visualization.html#cb291-44" aria-hidden="true" tabindex="-1"></a><span class="fu">ggmap</span>(base2,<span class="at">darken=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb291-45"><a href="network-visualization.html#cb291-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data=</span>map3, <span class="fu">aes</span>(x, y, <span class="at">group=</span>Group<span class="fl">.1</span>),<span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">size=</span><span class="fl">0.5</span>,<span class="at">fill=</span><span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb291-46"><a href="network-visualization.html#cb291-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> net.dat, <span class="fu">aes</span>(<span class="at">x=</span>X1, <span class="at">y=</span>Y1, <span class="at">xend=</span>X2, <span class="at">yend=</span>Y2,<span class="at">col=</span>DistBins), <span class="at">size=</span><span class="fl">0.15</span>, <span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb291-47"><a href="network-visualization.html#cb291-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;white&quot;</span>,<span class="st">&quot;skyblue&quot;</span>,<span class="st">&quot;dodgerblue&quot;</span>,<span class="st">&quot;darkblue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb291-48"><a href="network-visualization.html#cb291-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-78-1.png" width="1152" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="quantifying-uncertainty.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="spatial-networks.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": null,
"position": "static"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
