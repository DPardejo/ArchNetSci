<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 5 Quantifying Uncertainty | Online Companion to Archaeological Network Science by Brughmans and Peeples</title>
  <meta name="description" content="<p>This bookdown document accompanies the Cambridge Manuals in Archaeology book
<em>Archaeological Network Science</em> by Tom Brughmans and Matthew A. Peeples.</p>" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 5 Quantifying Uncertainty | Online Companion to Archaeological Network Science by Brughmans and Peeples" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://archnetworks.net" />
  
  <meta property="og:description" content="<p>This bookdown document accompanies the Cambridge Manuals in Archaeology book
<em>Archaeological Network Science</em> by Tom Brughmans and Matthew A. Peeples.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 5 Quantifying Uncertainty | Online Companion to Archaeological Network Science by Brughmans and Peeples" />
  
  <meta name="twitter:description" content="<p>This bookdown document accompanies the Cambridge Manuals in Archaeology book
<em>Archaeological Network Science</em> by Tom Brughmans and Matthew A. Peeples.</p>" />
  

<meta name="author" content="Matthew A. Peeples and Tom Brughmans" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="exploratory-network-analysis.html"/>
<link rel="next" href="network-visualization.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/d3-4.5.0/d3.min.js"></script>
<script src="libs/forceNetwork-binding-0.4/forceNetwork.js"></script>
<link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet" />
<script src="libs/vis-9.1.0/vis-network.min.js"></script>
<script src="libs/visNetwork-binding-2.1.0/visNetwork.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Archaeological Network Science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome</a></li>
<li class="chapter" data-level="2" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>2</b> Getting Started</a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started.html"><a href="getting-started.html#datasets"><i class="fa fa-check"></i><b>2.1</b> Datasets</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="getting-started.html"><a href="getting-started.html#Everything"><i class="fa fa-check"></i><b>2.1.1</b> Just Give Me Everything</a></li>
<li class="chapter" data-level="2.1.2" data-path="getting-started.html"><a href="getting-started.html#roman-road-networks"><i class="fa fa-check"></i><b>2.1.2</b> Roman Road Networks</a></li>
<li class="chapter" data-level="2.1.3" data-path="getting-started.html"><a href="getting-started.html#southwest-social-networks-project-ceramic-similarity-networks"><i class="fa fa-check"></i><b>2.1.3</b> Southwest Social Networks Project Ceramic Similarity Networks</a></li>
<li class="chapter" data-level="2.1.4" data-path="getting-started.html"><a href="getting-started.html#cibola-region-technological-similarity-network"><i class="fa fa-check"></i><b>2.1.4</b> Cibola Region Technological Similarity Network</a></li>
<li class="chapter" data-level="2.1.5" data-path="getting-started.html"><a href="getting-started.html#himalayan-visibility-networks"><i class="fa fa-check"></i><b>2.1.5</b> Himalayan Visibility Networks</a></li>
<li class="chapter" data-level="2.1.6" data-path="getting-started.html"><a href="getting-started.html#archaeological-publication-networks"><i class="fa fa-check"></i><b>2.1.6</b> Archaeological Publication Networks</a></li>
<li class="chapter" data-level="2.1.7" data-path="getting-started.html"><a href="getting-started.html#iron-age-sites-in-southern-spain"><i class="fa fa-check"></i><b>2.1.7</b> Iron Age Sites in Southern Spain</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="getting-started.html"><a href="getting-started.html#importing-data-in-r"><i class="fa fa-check"></i><b>2.2</b> Importing Data in R</a></li>
<li class="chapter" data-level="2.3" data-path="getting-started.html"><a href="getting-started.html#installing-r-packages"><i class="fa fa-check"></i><b>2.3</b> Installing R Packages</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started.html"><a href="getting-started.html#suggested-workspace-setup"><i class="fa fa-check"></i><b>2.4</b> Suggested Workspace Setup</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="NetworkData.html"><a href="NetworkData.html"><i class="fa fa-check"></i><b>3</b> Network Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="NetworkData.html"><a href="NetworkData.html#network-data-formats"><i class="fa fa-check"></i><b>3.1</b> Network Data Formats</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="NetworkData.html"><a href="NetworkData.html#Edgelist"><i class="fa fa-check"></i><b>3.1.1</b> Edge List</a></li>
<li class="chapter" data-level="3.1.2" data-path="NetworkData.html"><a href="NetworkData.html#adjacency-list"><i class="fa fa-check"></i><b>3.1.2</b> Adjacency List</a></li>
<li class="chapter" data-level="3.1.3" data-path="NetworkData.html"><a href="NetworkData.html#adjacency-matrix"><i class="fa fa-check"></i><b>3.1.3</b> Adjacency Matrix</a></li>
<li class="chapter" data-level="3.1.4" data-path="NetworkData.html"><a href="NetworkData.html#incidence-matrix"><i class="fa fa-check"></i><b>3.1.4</b> Incidence Matrix</a></li>
<li class="chapter" data-level="3.1.5" data-path="NetworkData.html"><a href="NetworkData.html#node-and-edge-information"><i class="fa fa-check"></i><b>3.1.5</b> Node and Edge Information</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="NetworkData.html"><a href="NetworkData.html#types-of-networks"><i class="fa fa-check"></i><b>3.2</b> Types of Networks</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="NetworkData.html"><a href="NetworkData.html#simple-networks"><i class="fa fa-check"></i><b>3.2.1</b> Simple Networks</a></li>
<li class="chapter" data-level="3.2.2" data-path="NetworkData.html"><a href="NetworkData.html#directed-networks"><i class="fa fa-check"></i><b>3.2.2</b> Directed Networks</a></li>
<li class="chapter" data-level="3.2.3" data-path="NetworkData.html"><a href="NetworkData.html#signed-categorized-and-valued-networks"><i class="fa fa-check"></i><b>3.2.3</b> Signed, Categorized, and Valued Networks</a></li>
<li class="chapter" data-level="3.2.4" data-path="NetworkData.html"><a href="NetworkData.html#two-mode-networks-and-affiliation-networks"><i class="fa fa-check"></i><b>3.2.4</b> Two-mode Networks and Affiliation Networks</a></li>
<li class="chapter" data-level="3.2.5" data-path="NetworkData.html"><a href="NetworkData.html#similarity-networks"><i class="fa fa-check"></i><b>3.2.5</b> Similarity Networks</a></li>
<li class="chapter" data-level="3.2.6" data-path="NetworkData.html"><a href="NetworkData.html#ego-networks"><i class="fa fa-check"></i><b>3.2.6</b> Ego Networks</a></li>
<li class="chapter" data-level="3.2.7" data-path="NetworkData.html"><a href="NetworkData.html#multilayer-networks"><i class="fa fa-check"></i><b>3.2.7</b> Multilayer Networks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html"><i class="fa fa-check"></i><b>4</b> Exploratory Network Analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#example-network-objects"><i class="fa fa-check"></i><b>4.1</b> Example Network Objects</a></li>
<li class="chapter" data-level="4.2" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#CalcMetric"><i class="fa fa-check"></i><b>4.2</b> Calculating Network Metrics in R</a></li>
<li class="chapter" data-level="4.3" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#centrality"><i class="fa fa-check"></i><b>4.3</b> Centrality</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#degree-centrality"><i class="fa fa-check"></i><b>4.3.1</b> Degree Centrality</a></li>
<li class="chapter" data-level="4.3.2" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#betweenness-centrality"><i class="fa fa-check"></i><b>4.3.2</b> Betweenness Centrality</a></li>
<li class="chapter" data-level="4.3.3" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#eigenvector-centrality"><i class="fa fa-check"></i><b>4.3.3</b> Eigenvector Centrality</a></li>
<li class="chapter" data-level="4.3.4" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#page-rank-centrality"><i class="fa fa-check"></i><b>4.3.4</b> Page Rank Centrality</a></li>
<li class="chapter" data-level="4.3.5" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#closeness-centrality"><i class="fa fa-check"></i><b>4.3.5</b> Closeness Centrality</a></li>
<li class="chapter" data-level="4.3.6" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#hubs-and-authorities"><i class="fa fa-check"></i><b>4.3.6</b> Hubs and Authorities</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#triads-and-clustering"><i class="fa fa-check"></i><b>4.4</b> Triads and clustering</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#triads"><i class="fa fa-check"></i><b>4.4.1</b> Triads</a></li>
<li class="chapter" data-level="4.4.2" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#transitivity-and-clustering"><i class="fa fa-check"></i><b>4.4.2</b> Transitivity and Clustering</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#walks-paths-and-distance"><i class="fa fa-check"></i><b>4.5</b> Walks, Paths, and Distance</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#distance"><i class="fa fa-check"></i><b>4.5.1</b> Distance</a></li>
<li class="chapter" data-level="4.5.2" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#shortest-paths"><i class="fa fa-check"></i><b>4.5.2</b> Shortest Paths</a></li>
<li class="chapter" data-level="4.5.3" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#diameter"><i class="fa fa-check"></i><b>4.5.3</b> Diameter</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#components-and-bridges"><i class="fa fa-check"></i><b>4.6</b> Components and Bridges</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#identifying-components"><i class="fa fa-check"></i><b>4.6.1</b> Identifying Components</a></li>
<li class="chapter" data-level="4.6.2" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#cutpoints"><i class="fa fa-check"></i><b>4.6.2</b> Cutpoints</a></li>
<li class="chapter" data-level="4.6.3" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#bridges"><i class="fa fa-check"></i><b>4.6.3</b> Bridges</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#cliques-and-communities"><i class="fa fa-check"></i><b>4.7</b> Cliques and Communities</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#cliques"><i class="fa fa-check"></i><b>4.7.1</b> Cliques</a></li>
<li class="chapter" data-level="4.7.2" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#k-cores"><i class="fa fa-check"></i><b>4.7.2</b> K-cores</a></li>
<li class="chapter" data-level="4.7.3" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#cluster-detection-algorithms"><i class="fa fa-check"></i><b>4.7.3</b> Cluster Detection Algorithms</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="exploratory-network-analysis.html"><a href="exploratory-network-analysis.html#case-study"><i class="fa fa-check"></i><b>4.8</b> Case Study</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="quantifying-uncertainty.html"><a href="quantifying-uncertainty.html"><i class="fa fa-check"></i><b>5</b> Quantifying Uncertainty</a>
<ul>
<li class="chapter" data-level="5.1" data-path="quantifying-uncertainty.html"><a href="quantifying-uncertainty.html#a-general-approach-to-uncertainty"><i class="fa fa-check"></i><b>5.1</b> A General Approach to Uncertainty</a></li>
<li class="chapter" data-level="5.2" data-path="quantifying-uncertainty.html"><a href="quantifying-uncertainty.html#missing-at-random"><i class="fa fa-check"></i><b>5.2</b> Missing at Random</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="quantifying-uncertainty.html"><a href="quantifying-uncertainty.html#nodes-missing-at-random"><i class="fa fa-check"></i><b>5.2.1</b> Nodes Missing at Random</a></li>
<li class="chapter" data-level="5.2.2" data-path="quantifying-uncertainty.html"><a href="quantifying-uncertainty.html#edges-missing-at-random"><i class="fa fa-check"></i><b>5.2.2</b> Edges Missing at Random</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="quantifying-uncertainty.html"><a href="quantifying-uncertainty.html#assessing-indivdiual-nodesedges"><i class="fa fa-check"></i><b>5.3</b> Assessing Indivdiual Nodes/Edges</a></li>
<li class="chapter" data-level="5.4" data-path="quantifying-uncertainty.html"><a href="quantifying-uncertainty.html#missing-due-to-biased-sampling"><i class="fa fa-check"></i><b>5.4</b> Missing Due to Biased Sampling</a></li>
<li class="chapter" data-level="5.5" data-path="quantifying-uncertainty.html"><a href="quantifying-uncertainty.html#edge-probability-modeling"><i class="fa fa-check"></i><b>5.5</b> Edge Probability Modeling</a></li>
<li class="chapter" data-level="5.6" data-path="quantifying-uncertainty.html"><a href="quantifying-uncertainty.html#small-or-variable-sample-size"><i class="fa fa-check"></i><b>5.6</b> Small or Variable Sample Size</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="network-visualization.html"><a href="network-visualization.html"><i class="fa fa-check"></i><b>6</b> Network Visualization</a>
<ul>
<li class="chapter" data-level="6.1" data-path="network-visualization.html"><a href="network-visualization.html#datasets-and-r-setup"><i class="fa fa-check"></i><b>6.1</b> Datasets and R Setup</a></li>
<li class="chapter" data-level="6.2" data-path="network-visualization.html"><a href="network-visualization.html#visualizing-networks-in-r"><i class="fa fa-check"></i><b>6.2</b> Visualizing Networks in R</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="network-visualization.html"><a href="network-visualization.html#networkstatnet"><i class="fa fa-check"></i><b>6.2.1</b> network/statnet</a></li>
<li class="chapter" data-level="6.2.2" data-path="network-visualization.html"><a href="network-visualization.html#igraph"><i class="fa fa-check"></i><b>6.2.2</b> igraph</a></li>
<li class="chapter" data-level="6.2.3" data-path="network-visualization.html"><a href="network-visualization.html#ggraph"><i class="fa fa-check"></i><b>6.2.3</b> ggraph</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="network-visualization.html"><a href="network-visualization.html#network-visualization-options"><i class="fa fa-check"></i><b>6.3</b> Network Visualization Options</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="network-visualization.html"><a href="network-visualization.html#graph-layout"><i class="fa fa-check"></i><b>6.3.1</b> Graph Layout</a></li>
<li class="chapter" data-level="6.3.2" data-path="network-visualization.html"><a href="network-visualization.html#node-and-edge-options"><i class="fa fa-check"></i><b>6.3.2</b> Node and Edge Options</a></li>
<li class="chapter" data-level="6.3.3" data-path="network-visualization.html"><a href="network-visualization.html#label-options"><i class="fa fa-check"></i><b>6.3.3</b> Label Options</a></li>
<li class="chapter" data-level="6.3.4" data-path="network-visualization.html"><a href="network-visualization.html#be-kind-to-the-color-blind"><i class="fa fa-check"></i><b>6.3.4</b> Be Kind to the Color Blind</a></li>
<li class="chapter" data-level="6.3.5" data-path="network-visualization.html"><a href="network-visualization.html#communities-and-groups"><i class="fa fa-check"></i><b>6.3.5</b> Communities and Groups</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="network-visualization.html"><a href="network-visualization.html#replicating-the-book-figures"><i class="fa fa-check"></i><b>6.4</b> Replicating the Book Figures</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_1"><i class="fa fa-check"></i><b>6.4.1</b> Figure 6.1: Manual Layout</a></li>
<li class="chapter" data-level="6.4.2" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_2"><i class="fa fa-check"></i><b>6.4.2</b> Figure 6.2: Examples of Common Network Plot Formats</a></li>
<li class="chapter" data-level="6.4.3" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_3"><i class="fa fa-check"></i><b>6.4.3</b> Figure 6.3: Examples of Rare Network Plot Formats</a></li>
<li class="chapter" data-level="6.4.4" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_4"><i class="fa fa-check"></i><b>6.4.4</b> Figure 6.4: Simple Network with Clusters</a></li>
<li class="chapter" data-level="6.4.5" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_5"><i class="fa fa-check"></i><b>6.4.5</b> Figure 6.5: Interactive Layout</a></li>
<li class="chapter" data-level="6.4.6" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_6"><i class="fa fa-check"></i><b>6.4.6</b> Figure 6.6: Absolute Geographic Layout</a></li>
<li class="chapter" data-level="6.4.7" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_7"><i class="fa fa-check"></i><b>6.4.7</b> Figure 6.7: Distorted Geographic Layout</a></li>
<li class="chapter" data-level="6.4.8" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_8"><i class="fa fa-check"></i><b>6.4.8</b> Figure 6.8: Graph Layout Algorithms</a></li>
<li class="chapter" data-level="6.4.9" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_9"><i class="fa fa-check"></i><b>6.4.9</b> Figure 6.9: Heirarchical Graph Layouts</a></li>
<li class="chapter" data-level="6.4.10" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_10"><i class="fa fa-check"></i><b>6.4.10</b> Figure 6.10: Be kind to the color blind</a></li>
<li class="chapter" data-level="6.4.11" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_11"><i class="fa fa-check"></i><b>6.4.11</b> Figure 6.11: Node Symbol and Color Schemes</a></li>
<li class="chapter" data-level="6.4.12" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_12"><i class="fa fa-check"></i><b>6.4.12</b> Figure 6.12: Image for Node</a></li>
<li class="chapter" data-level="6.4.13" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_13"><i class="fa fa-check"></i><b>6.4.13</b> Figure 6.13: Images for Nodes</a></li>
<li class="chapter" data-level="6.4.14" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_14"><i class="fa fa-check"></i><b>6.4.14</b> Figure 6.14: Edge Thickness and Color</a></li>
<li class="chapter" data-level="6.4.15" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_15"><i class="fa fa-check"></i><b>6.4.15</b> Figure 6.15: Edge Direction</a></li>
<li class="chapter" data-level="6.4.16" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_16"><i class="fa fa-check"></i><b>6.4.16</b> Figure 6.16: Edge Binarization</a></li>
<li class="chapter" data-level="6.4.17" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_17"><i class="fa fa-check"></i><b>6.4.17</b> Figure 6.17: Edge Bundling</a></li>
<li class="chapter" data-level="6.4.18" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_18"><i class="fa fa-check"></i><b>6.4.18</b> Figure 6.18: Group-in-a-box</a></li>
<li class="chapter" data-level="6.4.19" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_19"><i class="fa fa-check"></i><b>6.4.19</b> Figure 6.19: Weighted Adjacency Matrix</a></li>
<li class="chapter" data-level="6.4.20" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_20"><i class="fa fa-check"></i><b>6.4.20</b> Figure 6.20: Nodetrix Diagram</a></li>
<li class="chapter" data-level="6.4.21" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_21"><i class="fa fa-check"></i><b>6.4.21</b> Figure 6.21: The Filmstrip Approach</a></li>
<li class="chapter" data-level="6.4.22" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_22"><i class="fa fa-check"></i><b>6.4.22</b> Figure 6.22: Similtaneous Display</a></li>
<li class="chapter" data-level="6.4.23" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_23"><i class="fa fa-check"></i><b>6.4.23</b> Figure 6:23: Timelines and Time Prisms</a></li>
<li class="chapter" data-level="6.4.24" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_24"><i class="fa fa-check"></i><b>6.4.24</b> Figure 6.24: Animation</a></li>
<li class="chapter" data-level="6.4.25" data-path="network-visualization.html"><a href="network-visualization.html#Figure_6_25"><i class="fa fa-check"></i><b>6.4.25</b> Figure 6.25: Interactive Networks</a></li>
<li class="chapter" data-level="6.4.26" data-path="network-visualization.html"><a href="network-visualization.html#figure-6.26-swsn-example-1"><i class="fa fa-check"></i><b>6.4.26</b> Figure 6.26: SWSN Example 1</a></li>
<li class="chapter" data-level="6.4.27" data-path="network-visualization.html"><a href="network-visualization.html#figure-6.27-swsn-example-2"><i class="fa fa-check"></i><b>6.4.27</b> Figure 6.27: SWSN Example 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="spatial-networks.html"><a href="spatial-networks.html"><i class="fa fa-check"></i><b>7</b> Spatial Networks</a>
<ul>
<li class="chapter" data-level="7.1" data-path="spatial-networks.html"><a href="spatial-networks.html#dataset-and-setup"><i class="fa fa-check"></i><b>7.1</b> Dataset and Setup</a></li>
<li class="chapter" data-level="7.2" data-path="spatial-networks.html"><a href="spatial-networks.html#planar-networks-and-trees"><i class="fa fa-check"></i><b>7.2</b> Planar Networks and Trees</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="spatial-networks.html"><a href="spatial-networks.html#evaluating-planarity"><i class="fa fa-check"></i><b>7.2.1</b> Evaluating Planarity</a></li>
<li class="chapter" data-level="7.2.2" data-path="spatial-networks.html"><a href="spatial-networks.html#defining-trees"><i class="fa fa-check"></i><b>7.2.2</b> Defining Trees</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="spatial-networks.html"><a href="spatial-networks.html#spatial-network-models"><i class="fa fa-check"></i><b>7.3</b> Spatial Network Models</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="spatial-networks.html"><a href="spatial-networks.html#relative-neighborhood-networks"><i class="fa fa-check"></i><b>7.3.1</b> Relative Neighborhood Networks</a></li>
<li class="chapter" data-level="7.3.2" data-path="spatial-networks.html"><a href="spatial-networks.html#gabriel-graphs"><i class="fa fa-check"></i><b>7.3.2</b> Gabriel Graphs</a></li>
<li class="chapter" data-level="7.3.3" data-path="spatial-networks.html"><a href="spatial-networks.html#beta-skeletons"><i class="fa fa-check"></i><b>7.3.3</b> Beta Skeletons</a></li>
<li class="chapter" data-level="7.3.4" data-path="spatial-networks.html"><a href="spatial-networks.html#minimum-spanning-trees"><i class="fa fa-check"></i><b>7.3.4</b> Minimum Spanning Trees</a></li>
<li class="chapter" data-level="7.3.5" data-path="spatial-networks.html"><a href="spatial-networks.html#delaunay-triangulation"><i class="fa fa-check"></i><b>7.3.5</b> Delaunay Triangulation</a></li>
<li class="chapter" data-level="7.3.6" data-path="spatial-networks.html"><a href="spatial-networks.html#k-nearest-neighbors"><i class="fa fa-check"></i><b>7.3.6</b> K-nearest Neighbors</a></li>
<li class="chapter" data-level="7.3.7" data-path="spatial-networks.html"><a href="spatial-networks.html#maximum-distance-networks"><i class="fa fa-check"></i><b>7.3.7</b> Maximum Distance Networks</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="spatial-networks.html"><a href="spatial-networks.html#case-studies"><i class="fa fa-check"></i><b>7.4</b> Case Studies</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="spatial-networks.html"><a href="spatial-networks.html#proximity-of-iron-age-sites-in-southern-spain"><i class="fa fa-check"></i><b>7.4.1</b> Proximity of Iron Age sites in Southern Spain</a></li>
<li class="chapter" data-level="7.4.2" data-path="spatial-networks.html"><a href="spatial-networks.html#networks-in-space-in-the-u.s.-southwest"><i class="fa fa-check"></i><b>7.4.2</b> Networks in Space in the U.S. Southwest</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-and-r-packages.html"><a href="references-and-r-packages.html"><i class="fa fa-check"></i>References and R Packages</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Online Companion to <em>Archaeological Network Science</em> by Brughmans and Peeples</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="quantifying-uncertainty" class="section level1" number="5">
<h1><span class="header-section-number">Section 5</span> Quantifying Uncertainty</h1>
<p>This section provides code and examples to accompany Chapter 5 of Brughmans and Peeples (2022) and our discussions of missing and poor quality data in archaeological networks. For many of the other analyses in the book it is possible to use a number of different network software packages to conduct similar analyses. The analyses presented in Chapter 5, however, require the creation of custom scripts and procedures that are only possible in a programming language environment like R. We attempt here to not only provide information on how to replicate the examples in the book but also provide guidance on how you might modify the functions and code provided here for your own purposes.</p>
<div id="a-general-approach-to-uncertainty" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> A General Approach to Uncertainty</h2>
<p>As outlined in the book, our basic approach to quantifying and dealing with uncertainty is to use the sample we have as a means for understanding the robustness or vulnerability of the population from which that sample was drawn to the kinds of variability or perturbations we might expect. The procedures we advocate primarily take the following basic form:</p>
<ul>
<li>Define a network based on the available sample, calculate the metrics and characterize the properties of interest in that network.</li>
<li>Derive a large number of modified samples from the network created in step 1 (or the underlying data) that simulate the potential data problem we are trying to address. For example, if we are interested in the impact of nodes missing at random, we could randomly delete some proportion of the nodes in each sample derived from the network created in step 1.</li>
<li>Calculate the metrics and characterize the properties of the features of interest in every one of the random samples created in step 2 and assess central tendency (mean, median) and distributional properties (range, standard deviation, distribution shape, etc.) or other features of the output as appropriate.</li>
<li>Compare the distributions of metrics and properties (at the graph, node, or edge level) from the random samples to the “original” network created in step 1 to assess the potential impacts of the perturbation or data treatment. This comparison between the properties of the network created in step 1 and the distribution of properties created in step 3 will provide information directly relevant to assessing the impact of the kind of perturbation created in step 2 on the original network sample and, by extension, the complete network from which it was drawn.</li>
</ul>
<p>The underlying assumption of the approach outlined here is that the robustness or vulnerability to a particular perturbation of the observed network data, drawn from a complete network that is unattainable, provides information about the robustness or vulnerability of that unattainable complete network to the same kinds of perturbations. For example, if we are interested in exploring the degree distribution of a network and our sampling experiments show massive fluctuations in that distribution in sub-samples with only small numbers of nodes removed at random, this would suggest that the particular properties of this network are not robust to nodes missing at random for degree calculations and we should not place much confidence in any results obtained from the original sample as indicative of the complete network from which it was drawn. On the other hand, say we instead find that in the resampling experiments the degree distributions in our sub-samples are substantially similar to that of the original network sample even when moderate or large numbers of nodes are removed. In that case, we might conclude that our network structure is such that assessments of degree distribution are robust to node missigness within the range of what we might expect for our original sample in relation to the complete network from which it was drawn. It is important to note, however, that this finding should not be transferred to any other metrics as any given network is likely to be robust to certain kinds of perturbations for certain network metrics, but not to others.</p>
<p>In the sub-sections below we create a basic function to conduct these analyses and show how it can be modified to fit almost any data perturbation you chose to simulate.</p>
</div>
<div id="missing-at-random" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Missing at Random</h2>
<p>This sub-section accompanies the discussion of nodes or edges missing at random in Brughmans and Peeples (2022) Chapter 5.3.1. Here we take one interval of the Chaco World ceramic similarity network (ca. A.D. 1050-1100) and simulate the impact of nodes missing at random on network centrality statistics. Download the <a href="data/AD1050net.csv">ceramic similarity adjacency matrix</a> to follow along.</p>
<p>The first thing we need to do is to initialize our required libraries and import the ceramic ware data and convert it into a network object. Here we will once again use the igraph package. For our example here we are using a simple undirected network.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="quantifying-uncertainty.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb205-2"><a href="quantifying-uncertainty.html#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb205-3"><a href="quantifying-uncertainty.html#cb205-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb205-4"><a href="quantifying-uncertainty.html#cb205-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb205-5"><a href="quantifying-uncertainty.html#cb205-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tnet)</span>
<span id="cb205-6"><a href="quantifying-uncertainty.html#cb205-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb205-7"><a href="quantifying-uncertainty.html#cb205-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb205-8"><a href="quantifying-uncertainty.html#cb205-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statnet)</span>
<span id="cb205-9"><a href="quantifying-uncertainty.html#cb205-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-10"><a href="quantifying-uncertainty.html#cb205-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Import adjacency matrix and covert to network</span></span>
<span id="cb205-11"><a href="quantifying-uncertainty.html#cb205-11" aria-hidden="true" tabindex="-1"></a>chaco <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">&#39;data/AD1050net.csv&#39;</span>,<span class="at">row.names=</span><span class="dv">1</span>)</span>
<span id="cb205-12"><a href="quantifying-uncertainty.html#cb205-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-13"><a href="quantifying-uncertainty.html#cb205-13" aria-hidden="true" tabindex="-1"></a>chaco_net <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">graph_from_adjacency_matrix</span>(<span class="fu">as.matrix</span>(chaco), <span class="at">mode=</span><span class="st">&quot;undirected&quot;</span>)</span></code></pre></div>
<p>Now we need to define a function that removes a specified proportion of nodes at random, assesses the specified metric of interest, and compares each sub-sample to the original sample in terms of the rank order correlation (Spearman’s <span class="math inline">\(\rho\)</span>) among nodes for the metric in question. We have attempted to write this function to be as general as possible so that you can modify it and use it to meet your own needs in your own research. In subsequent steps in this document we will modify this basic function to assess different data perturbations.</p>
<div id="nodes-missing-at-random" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Nodes Missing at Random</h3>
<p>First, following Chapter 5.3.1, we will assess the robustness of these data to nodes missing at random for betweenness centrality.</p>
<p>The “nodes_missing_at_random_bw” function below requires three specific pieces of information from the user.</p>
<ul>
<li>net - You must include a network object in igraph format. The current version expects a simple network but the code could be modified for other types.</li>
<li>nsim - You must specify the number of simulations to perform. The default is 1000.</li>
<li>props - Finally, you must specify the proportion of nodes to be retained for each set of nsim runs. This should be provided as a vector of proportions ranging from &gt; 0 to 1. By default, the script will calculate a 90% sub-sample all the way down to a 10% sub-sample at 10% intervals using props=c(0.9,0.8,0.7,0.6,0.5,0.4,0.3,0.2,0.1).</li>
</ul>
<p>As we said, this function is designed to assess betweenness centrality but if you wish to assess another network metric, you simply need to modify the code in two places as marked below. Let’s initialize the script then take a look at the example from the book first using betweenness centrality and then modifying the code for eigenvector centrality. Note that depending on the size of your network and the number of simulations you specify, this could take from several seconds to several minutes.</p>
<p>To briefly describe how this works, the inner portion of this function contains two nested “for” loops which iterate across all values of “props” and for every simulation 1 to “nsim”. The “sub_samp” object is a vector of random integers based on node ids that determine which nodes will be retained. The “sub_net” object is a subset of the larger graph which includes only those nodes indicated in “sub_samp.” Next, we then calculate betweenness centrality for the “sub_net” object and create a vector of those values called “temp_stats.” Finally, we compare rank order correlation of centrality scores in the “temp_stats” to the “met_orig” which is the vector of values in the original network and add to the output matrix. Once we run the script we can visualize the results.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="quantifying-uncertainty.html#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function for assessing the impact of nodes missing at random on betweenness centrality</span></span>
<span id="cb206-2"><a href="quantifying-uncertainty.html#cb206-2" aria-hidden="true" tabindex="-1"></a>nodes_missing_at_random_bw <span class="ot">&lt;-</span> <span class="cf">function</span>(net, <span class="at">nsim=</span><span class="dv">1000</span>, <span class="at">props=</span><span class="fu">c</span>(<span class="fl">0.9</span>,<span class="fl">0.8</span>,<span class="fl">0.7</span>,<span class="fl">0.6</span>,<span class="fl">0.5</span>,<span class="fl">0.4</span>,<span class="fl">0.3</span>,<span class="fl">0.2</span>,<span class="fl">0.1</span>)) {</span>
<span id="cb206-3"><a href="quantifying-uncertainty.html#cb206-3" aria-hidden="true" tabindex="-1"></a>  met_orig <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">betweenness</span>(net) <span class="co"># insert measure of interest here</span></span>
<span id="cb206-4"><a href="quantifying-uncertainty.html#cb206-4" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,nsim,<span class="fu">length</span>(props))</span>
<span id="cb206-5"><a href="quantifying-uncertainty.html#cb206-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(output) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(props)</span>
<span id="cb206-6"><a href="quantifying-uncertainty.html#cb206-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(props)) {</span>
<span id="cb206-7"><a href="quantifying-uncertainty.html#cb206-7" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim) {</span>
<span id="cb206-8"><a href="quantifying-uncertainty.html#cb206-8" aria-hidden="true" tabindex="-1"></a>        sub_samp <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">vcount</span>(net)), <span class="at">size=</span><span class="fu">round</span>(<span class="fu">vcount</span>(net)<span class="sc">*</span>props[j], <span class="dv">0</span>))</span>
<span id="cb206-9"><a href="quantifying-uncertainty.html#cb206-9" aria-hidden="true" tabindex="-1"></a>        sub_net <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">induced_subgraph</span>(net, <span class="fu">sort</span>(sub_samp))</span>
<span id="cb206-10"><a href="quantifying-uncertainty.html#cb206-10" aria-hidden="true" tabindex="-1"></a>        temp_stats <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">betweenness</span>(sub_net) <span class="co"># insert measure of interest here (same as above)</span></span>
<span id="cb206-11"><a href="quantifying-uncertainty.html#cb206-11" aria-hidden="true" tabindex="-1"></a>        output[i,j] <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">cor</span>(temp_stats, met_orig[<span class="fu">sort</span>(sub_samp)], <span class="at">method=</span><span class="st">&#39;spearman&#39;</span>))</span>
<span id="cb206-12"><a href="quantifying-uncertainty.html#cb206-12" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb206-13"><a href="quantifying-uncertainty.html#cb206-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb206-14"><a href="quantifying-uncertainty.html#cb206-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb206-15"><a href="quantifying-uncertainty.html#cb206-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb206-16"><a href="quantifying-uncertainty.html#cb206-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-17"><a href="quantifying-uncertainty.html#cb206-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the function</span></span>
<span id="cb206-18"><a href="quantifying-uncertainty.html#cb206-18" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4561</span>)</span>
<span id="cb206-19"><a href="quantifying-uncertainty.html#cb206-19" aria-hidden="true" tabindex="-1"></a>bw_test <span class="ot">&lt;-</span> <span class="fu">nodes_missing_at_random_bw</span>(<span class="at">net=</span>chaco_net, <span class="at">nsim=</span><span class="dv">1000</span>, <span class="at">props=</span><span class="fu">c</span>(<span class="fl">0.9</span>,<span class="fl">0.8</span>,<span class="fl">0.7</span>,<span class="fl">0.6</span>,<span class="fl">0.5</span>,<span class="fl">0.4</span>,<span class="fl">0.3</span>,<span class="fl">0.2</span>,<span class="fl">0.1</span>))</span>
<span id="cb206-20"><a href="quantifying-uncertainty.html#cb206-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-21"><a href="quantifying-uncertainty.html#cb206-21" aria-hidden="true" tabindex="-1"></a><span class="co"># visuzlize the results as a boxplot using ggplot</span></span>
<span id="cb206-22"><a href="quantifying-uncertainty.html#cb206-22" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">melt</span>(<span class="fu">as.data.frame</span>(bw_test)) <span class="co"># melt wide data format into long data format</span></span>
<span id="cb206-23"><a href="quantifying-uncertainty.html#cb206-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-24"><a href="quantifying-uncertainty.html#cb206-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df) <span class="sc">+</span></span>
<span id="cb206-25"><a href="quantifying-uncertainty.html#cb206-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value)) <span class="sc">+</span></span>
<span id="cb206-26"><a href="quantifying-uncertainty.html#cb206-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Sub-Sample Size as Proportion of Original&quot;</span>) <span class="sc">+</span></span>
<span id="cb206-27"><a href="quantifying-uncertainty.html#cb206-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="st">&quot;Spearman&#39;s&quot;</span><span class="sc">~</span>rho)) <span class="sc">+</span></span>
<span id="cb206-28"><a href="quantifying-uncertainty.html#cb206-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb206-29"><a href="quantifying-uncertainty.html#cb206-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="dv">2</span>)),<span class="at">axis.text.y=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="dv">2</span>)),</span>
<span id="cb206-30"><a href="quantifying-uncertainty.html#cb206-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="dv">2</span>)),<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="dv">2</span>)),</span>
<span id="cb206-31"><a href="quantifying-uncertainty.html#cb206-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="dv">1</span>)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
<p>Now let’s run the same function for eigenvector centrality, this time using the default arguments in the function we created rather than calling them directly. Note that we modified two lines of code to change igraph::betweenness(net) to igraph::eign_centrality(net)$vector. Because the eigen_centrality function outputs more than just the centrality values, we need to include the vector call.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="quantifying-uncertainty.html#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function for assessing the impact of nodes missing at random on betweenness centrality</span></span>
<span id="cb207-2"><a href="quantifying-uncertainty.html#cb207-2" aria-hidden="true" tabindex="-1"></a>nodes_missing_at_random_ev <span class="ot">&lt;-</span> <span class="cf">function</span>(net, <span class="at">nsim=</span><span class="dv">1000</span>, <span class="at">props=</span><span class="fu">c</span>(<span class="fl">0.9</span>,<span class="fl">0.8</span>,<span class="fl">0.7</span>,<span class="fl">0.6</span>,<span class="fl">0.5</span>,<span class="fl">0.4</span>,<span class="fl">0.3</span>,<span class="fl">0.2</span>,<span class="fl">0.1</span>)) {</span>
<span id="cb207-3"><a href="quantifying-uncertainty.html#cb207-3" aria-hidden="true" tabindex="-1"></a>  met_orig <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">eigen_centrality</span>(net)<span class="sc">$</span>vector <span class="co"># insert measure of interest here</span></span>
<span id="cb207-4"><a href="quantifying-uncertainty.html#cb207-4" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,nsim,<span class="fu">length</span>(props))</span>
<span id="cb207-5"><a href="quantifying-uncertainty.html#cb207-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(output) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(props)</span>
<span id="cb207-6"><a href="quantifying-uncertainty.html#cb207-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(props)) {</span>
<span id="cb207-7"><a href="quantifying-uncertainty.html#cb207-7" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim) {</span>
<span id="cb207-8"><a href="quantifying-uncertainty.html#cb207-8" aria-hidden="true" tabindex="-1"></a>        sub_samp <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">vcount</span>(net)), <span class="at">size=</span><span class="fu">round</span>(<span class="fu">vcount</span>(net)<span class="sc">*</span>props[j], <span class="dv">0</span>))</span>
<span id="cb207-9"><a href="quantifying-uncertainty.html#cb207-9" aria-hidden="true" tabindex="-1"></a>        sub_net <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">induced_subgraph</span>(net, <span class="fu">sort</span>(sub_samp))</span>
<span id="cb207-10"><a href="quantifying-uncertainty.html#cb207-10" aria-hidden="true" tabindex="-1"></a>        temp_stats <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">eigen_centrality</span>(sub_net)<span class="sc">$</span>vector <span class="co"># insert measure of interest here (same as above)</span></span>
<span id="cb207-11"><a href="quantifying-uncertainty.html#cb207-11" aria-hidden="true" tabindex="-1"></a>        output[i,j] <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">cor</span>(temp_stats, met_orig[<span class="fu">sort</span>(sub_samp)], <span class="at">method=</span><span class="st">&#39;spearman&#39;</span>))</span>
<span id="cb207-12"><a href="quantifying-uncertainty.html#cb207-12" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb207-13"><a href="quantifying-uncertainty.html#cb207-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb207-14"><a href="quantifying-uncertainty.html#cb207-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb207-15"><a href="quantifying-uncertainty.html#cb207-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb207-16"><a href="quantifying-uncertainty.html#cb207-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-17"><a href="quantifying-uncertainty.html#cb207-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the function</span></span>
<span id="cb207-18"><a href="quantifying-uncertainty.html#cb207-18" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5609</span>)</span>
<span id="cb207-19"><a href="quantifying-uncertainty.html#cb207-19" aria-hidden="true" tabindex="-1"></a>ev_test <span class="ot">&lt;-</span> <span class="fu">nodes_missing_at_random_ev</span>(<span class="at">net=</span>chaco_net)</span>
<span id="cb207-20"><a href="quantifying-uncertainty.html#cb207-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-21"><a href="quantifying-uncertainty.html#cb207-21" aria-hidden="true" tabindex="-1"></a><span class="co"># visuzlize the results as a boxplot</span></span>
<span id="cb207-22"><a href="quantifying-uncertainty.html#cb207-22" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">melt</span>(<span class="fu">as.data.frame</span>(ev_test)) <span class="co"># melt wide data format into long data format</span></span>
<span id="cb207-23"><a href="quantifying-uncertainty.html#cb207-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-24"><a href="quantifying-uncertainty.html#cb207-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df) <span class="sc">+</span></span>
<span id="cb207-25"><a href="quantifying-uncertainty.html#cb207-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value)) <span class="sc">+</span></span>
<span id="cb207-26"><a href="quantifying-uncertainty.html#cb207-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Sub-Sample Size as Proportion of Original&quot;</span>) <span class="sc">+</span></span>
<span id="cb207-27"><a href="quantifying-uncertainty.html#cb207-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="st">&quot;Spearman&#39;s&quot;</span><span class="sc">~</span>rho)) <span class="sc">+</span></span>
<span id="cb207-28"><a href="quantifying-uncertainty.html#cb207-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb207-29"><a href="quantifying-uncertainty.html#cb207-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="dv">2</span>)),<span class="at">axis.text.y=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="dv">2</span>)),</span>
<span id="cb207-30"><a href="quantifying-uncertainty.html#cb207-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="dv">2</span>)),<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="dv">2</span>)),</span>
<span id="cb207-31"><a href="quantifying-uncertainty.html#cb207-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="dv">1</span>)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-60-1.png" width="672" /></p>
</div>
<div id="edges-missing-at-random" class="section level3" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Edges Missing at Random</h3>
<p>We can also modify the function we defined above a little more to assess the impacts of edges missing at random. In this case we assess the impact of edges missing at random on degree centrality. We changed the same two lines “met_orig” and “temp_stats” to calculate degree and we also had to slightly change the lines beginning with “sub_samp,” “sub_net,” and “output[i,j]” to expect variation in edges rather than nodes. Specifically, in the line that starts with “sub_samp” we change “vcount” to “ecount” to get a sample of edges rather than nodes (vertices). In the next line we use that “sub_samp” object to “delete_edges” for all not in that sub sample. Finally, we remove the brackets after “met_orig” since all nodes are retained in this example.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="quantifying-uncertainty.html#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function for assessing the impact of edges missing at random on degree centrality</span></span>
<span id="cb208-2"><a href="quantifying-uncertainty.html#cb208-2" aria-hidden="true" tabindex="-1"></a>edges_missing_at_random_dg <span class="ot">&lt;-</span> <span class="cf">function</span>(net, <span class="at">nsim=</span><span class="dv">1000</span>, <span class="at">props=</span><span class="fu">c</span>(<span class="fl">0.9</span>,<span class="fl">0.8</span>,<span class="fl">0.7</span>,<span class="fl">0.6</span>,<span class="fl">0.5</span>,<span class="fl">0.4</span>,<span class="fl">0.3</span>,<span class="fl">0.2</span>,<span class="fl">0.1</span>)) {</span>
<span id="cb208-3"><a href="quantifying-uncertainty.html#cb208-3" aria-hidden="true" tabindex="-1"></a>  met_orig <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">degree</span>(net) <span class="co"># insert measure of interest here</span></span>
<span id="cb208-4"><a href="quantifying-uncertainty.html#cb208-4" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,nsim,<span class="fu">length</span>(props))</span>
<span id="cb208-5"><a href="quantifying-uncertainty.html#cb208-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(output) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(props)</span>
<span id="cb208-6"><a href="quantifying-uncertainty.html#cb208-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(props)) {</span>
<span id="cb208-7"><a href="quantifying-uncertainty.html#cb208-7" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim) {</span>
<span id="cb208-8"><a href="quantifying-uncertainty.html#cb208-8" aria-hidden="true" tabindex="-1"></a>        sub_samp <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">ecount</span>(net)), <span class="at">size=</span><span class="fu">round</span>(<span class="fu">ecount</span>(net)<span class="sc">*</span>props[j], <span class="dv">0</span>)) <span class="co"># modify for edges</span></span>
<span id="cb208-9"><a href="quantifying-uncertainty.html#cb208-9" aria-hidden="true" tabindex="-1"></a>        sub_net <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">delete_edges</span>(net, <span class="fu">which</span>(<span class="sc">!</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">ecount</span>(net)) <span class="sc">%in%</span> sub_samp))) <span class="co"># modify for edges</span></span>
<span id="cb208-10"><a href="quantifying-uncertainty.html#cb208-10" aria-hidden="true" tabindex="-1"></a>        temp_stats <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">degree</span>(sub_net) <span class="co"># insert measure of interest here (same as above)</span></span>
<span id="cb208-11"><a href="quantifying-uncertainty.html#cb208-11" aria-hidden="true" tabindex="-1"></a>        output[i,j] <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">cor</span>(temp_stats, met_orig, <span class="at">method=</span><span class="st">&#39;spearman&#39;</span>)) <span class="co"># modify for edges</span></span>
<span id="cb208-12"><a href="quantifying-uncertainty.html#cb208-12" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb208-13"><a href="quantifying-uncertainty.html#cb208-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb208-14"><a href="quantifying-uncertainty.html#cb208-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb208-15"><a href="quantifying-uncertainty.html#cb208-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb208-16"><a href="quantifying-uncertainty.html#cb208-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-17"><a href="quantifying-uncertainty.html#cb208-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the function</span></span>
<span id="cb208-18"><a href="quantifying-uncertainty.html#cb208-18" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5609</span>)</span>
<span id="cb208-19"><a href="quantifying-uncertainty.html#cb208-19" aria-hidden="true" tabindex="-1"></a>dg_edge_test <span class="ot">&lt;-</span> <span class="fu">edges_missing_at_random_dg</span>(<span class="at">net=</span>chaco_net)</span>
<span id="cb208-20"><a href="quantifying-uncertainty.html#cb208-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-21"><a href="quantifying-uncertainty.html#cb208-21" aria-hidden="true" tabindex="-1"></a><span class="co"># visuzlize the results as a boxplot</span></span>
<span id="cb208-22"><a href="quantifying-uncertainty.html#cb208-22" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">melt</span>(<span class="fu">as.data.frame</span>(dg_edge_test)) <span class="co"># melt wide data format into long data format</span></span>
<span id="cb208-23"><a href="quantifying-uncertainty.html#cb208-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-24"><a href="quantifying-uncertainty.html#cb208-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df) <span class="sc">+</span></span>
<span id="cb208-25"><a href="quantifying-uncertainty.html#cb208-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value)) <span class="sc">+</span></span>
<span id="cb208-26"><a href="quantifying-uncertainty.html#cb208-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Sub-Sample Size as Proportion of Original&quot;</span>) <span class="sc">+</span></span>
<span id="cb208-27"><a href="quantifying-uncertainty.html#cb208-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="st">&quot;Spearman&#39;s&quot;</span><span class="sc">~</span>rho)) <span class="sc">+</span></span>
<span id="cb208-28"><a href="quantifying-uncertainty.html#cb208-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb208-29"><a href="quantifying-uncertainty.html#cb208-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="dv">2</span>)),<span class="at">axis.text.y=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="dv">2</span>)),</span>
<span id="cb208-30"><a href="quantifying-uncertainty.html#cb208-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="dv">2</span>)),<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="dv">2</span>)),</span>
<span id="cb208-31"><a href="quantifying-uncertainty.html#cb208-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="dv">1</span>)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-61-1.png" width="672" /></p>
</div>
</div>
<div id="assessing-indivdiual-nodesedges" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Assessing Indivdiual Nodes/Edges</h2>
<p>This sub-section follows along with Chapter 5.3.2 in Brughmans and Peeples (2022). Here we will once again use the Cibola technological similarity network to make this assessment. This script is similar to that used above but instead of outputting correlation coefficients it outputs the specific rank order of the node in question.</p>
<p>The function requires four pieces of information from the user:</p>
<ul>
<li>net - An igraph network object. Again this is currently set up for simple networks but could easily be modified.</li>
<li>target - The name of the target node you wish to assess</li>
<li>prop - The proportion of nodes you wish to retain in the test.</li>
<li>nsim - The number of simulations. The default is 1000.</li>
</ul>
<p>Briefly how this function works is it first determines which node number corresponds with the “target” you wish to assess and creates a sub_sample that retains that target node. A subgraph is then induced (sub_net) and the metric of interest is calculated (betweenness in this case). The “output” object is a vector that records the specific rank order that the node in question fell in in terms of the metric in question.</p>
<p><a href="data/Cibola_edgelist.csv">Use these data</a> to follow along.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="quantifying-uncertainty.html#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in edgelist file as dataframe and create network object</span></span>
<span id="cb209-2"><a href="quantifying-uncertainty.html#cb209-2" aria-hidden="true" tabindex="-1"></a>Cibola_edgelist <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">&quot;data/Cibola_edgelist.csv&quot;</span>, <span class="at">header=</span><span class="cn">TRUE</span>) </span>
<span id="cb209-3"><a href="quantifying-uncertainty.html#cb209-3" aria-hidden="true" tabindex="-1"></a>Cibola_net <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">graph_from_edgelist</span>(<span class="fu">as.matrix</span>(Cibola_edgelist), <span class="at">directed=</span><span class="cn">FALSE</span>)</span>
<span id="cb209-4"><a href="quantifying-uncertainty.html#cb209-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-5"><a href="quantifying-uncertainty.html#cb209-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Function for assessing the impact of rank order correlation in betweenness centrality to nodes missing at random</span></span>
<span id="cb209-6"><a href="quantifying-uncertainty.html#cb209-6" aria-hidden="true" tabindex="-1"></a>individual_nodes_bw <span class="ot">&lt;-</span> <span class="cf">function</span>(net, target, prop, <span class="at">nsim=</span><span class="dv">1000</span>) {</span>
<span id="cb209-7"><a href="quantifying-uncertainty.html#cb209-7" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb209-8"><a href="quantifying-uncertainty.html#cb209-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim) {</span>
<span id="cb209-9"><a href="quantifying-uncertainty.html#cb209-9" aria-hidden="true" tabindex="-1"></a>  target_number <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">V</span>(net)<span class="sc">$</span>name <span class="sc">==</span> target)</span>
<span id="cb209-10"><a href="quantifying-uncertainty.html#cb209-10" aria-hidden="true" tabindex="-1"></a>  sub_samp <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">vcount</span>(net),target_number), <span class="at">size=</span><span class="fu">round</span>(<span class="fu">vcount</span>(net)<span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>prop), <span class="dv">0</span>)) </span>
<span id="cb209-11"><a href="quantifying-uncertainty.html#cb209-11" aria-hidden="true" tabindex="-1"></a>  sub_net <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">induced_subgraph</span>(net, <span class="fu">sort</span>(<span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">vcount</span>(net),sub_samp))) </span>
<span id="cb209-12"><a href="quantifying-uncertainty.html#cb209-12" aria-hidden="true" tabindex="-1"></a>  temp_stats <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">betweenness</span>(sub_net)</span>
<span id="cb209-13"><a href="quantifying-uncertainty.html#cb209-13" aria-hidden="true" tabindex="-1"></a>  output[i] <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">names</span>(<span class="fu">sort</span>(temp_stats, <span class="at">decreasing=</span><span class="cn">TRUE</span>))<span class="sc">==</span>target)</span>
<span id="cb209-14"><a href="quantifying-uncertainty.html#cb209-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb209-15"><a href="quantifying-uncertainty.html#cb209-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb209-16"><a href="quantifying-uncertainty.html#cb209-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb209-17"><a href="quantifying-uncertainty.html#cb209-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-18"><a href="quantifying-uncertainty.html#cb209-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the function</span></span>
<span id="cb209-19"><a href="quantifying-uncertainty.html#cb209-19" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">52793</span>)</span>
<span id="cb209-20"><a href="quantifying-uncertainty.html#cb209-20" aria-hidden="true" tabindex="-1"></a>GR <span class="ot">&lt;-</span> <span class="fu">individual_nodes_bw</span>(<span class="at">net=</span>Cibola_net, <span class="at">target=</span><span class="st">&quot;Garcia Ranch&quot;</span>, <span class="at">prop=</span><span class="fl">0.8</span>, <span class="at">nsim=</span><span class="dv">1000</span>)</span>
<span id="cb209-21"><a href="quantifying-uncertainty.html#cb209-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-22"><a href="quantifying-uncertainty.html#cb209-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the results</span></span>
<span id="cb209-23"><a href="quantifying-uncertainty.html#cb209-23" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(GR)</span>
<span id="cb209-24"><a href="quantifying-uncertainty.html#cb209-24" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="st">&quot;RankOrder&quot;</span></span>
<span id="cb209-25"><a href="quantifying-uncertainty.html#cb209-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-26"><a href="quantifying-uncertainty.html#cb209-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>RankOrder)) <span class="sc">+</span> </span>
<span id="cb209-27"><a href="quantifying-uncertainty.html#cb209-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span> </span>
<span id="cb209-28"><a href="quantifying-uncertainty.html#cb209-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb209-29"><a href="quantifying-uncertainty.html#cb209-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot; &quot;</span>, <span class="at">x =</span><span class="st">&quot;Rank Order&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Count&quot;</span>)<span class="sc">+</span></span>
<span id="cb209-30"><a href="quantifying-uncertainty.html#cb209-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="dv">2</span>)),<span class="at">axis.text.y=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="dv">2</span>)),</span>
<span id="cb209-31"><a href="quantifying-uncertainty.html#cb209-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="dv">2</span>)),<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="dv">2</span>)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
</div>
<div id="missing-due-to-biased-sampling" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Missing Due to Biased Sampling</h2>
<p>This sub-section follows along with Brughmans and Peeples (2022) Chapter 5.3.3. There are many situations where we are interested in modeling situations where the data that are missing are not missing at random but instead are influenced by some biased sampling process. For example, say we have a study area where there have been lots of general reconnaissance surveys that have recorded most of the large sites but few full coverage surveys that have captured smaller sites. In that case, we may wish to model missingness such that small sites would more likely be missing than large sites.</p>
<p>We illustrate this approach using the co-authorship network example presented in the book. In this case we start with an incidence matrix of publications and authors and we want to assess the potential impact of missing data. Since we gathered these data from digital repositories and citations, it is likely that we are missing some publication and it is reasonable to assume that we would be more likely to miss older publications than newer ones given the inclusion of newer publications in searchable digital indexes. Thus, in this example we want to assess missingness such that newer publications are more likely to be retained than older ones in our sample. We compare this to missing at random to assess how these results relate to one another.</p>
<p>First we need to provide two data files. The first is the <a href="data/biblio_attr.csv">bibliographic attribute data</a> which includes date, publication type, and other information on each publication designated by a unique identifier. The second is an <a href="data/biblio_dat.csv">incidence matrix</a> of publications denoted by unique identifier and authors. We read this into R and then create an adjaceny matrix of author to author connections using matrix algebra, convert it into a igraph network object and then calculate betweenness centrality for all nodes. We then provide a simple network node link diagram to visualize these data.</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="quantifying-uncertainty.html#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in publication and author attribute data</span></span>
<span id="cb210-2"><a href="quantifying-uncertainty.html#cb210-2" aria-hidden="true" tabindex="-1"></a>bib <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&#39;data/biblio_attr.csv&#39;</span>)</span>
<span id="cb210-3"><a href="quantifying-uncertainty.html#cb210-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in incidence matrix of publication and author data </span></span>
<span id="cb210-4"><a href="quantifying-uncertainty.html#cb210-4" aria-hidden="true" tabindex="-1"></a>bib_dat <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">read.csv</span>(<span class="st">&#39;data/biblio_dat.csv&#39;</span>,<span class="at">header=</span>T,<span class="at">row.names=</span><span class="dv">1</span>))</span>
<span id="cb210-5"><a href="quantifying-uncertainty.html#cb210-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create adjacency matrix from incidence matrix using matrix algebra</span></span>
<span id="cb210-6"><a href="quantifying-uncertainty.html#cb210-6" aria-hidden="true" tabindex="-1"></a>bib_adj <span class="ot">&lt;-</span> <span class="fu">t</span>(bib_dat) <span class="sc">%*%</span> bib_dat</span>
<span id="cb210-7"><a href="quantifying-uncertainty.html#cb210-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to igraph network object removing self loops (diag=FALSE)</span></span>
<span id="cb210-8"><a href="quantifying-uncertainty.html#cb210-8" aria-hidden="true" tabindex="-1"></a>bib_net <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">graph_from_adjacency_matrix</span>(bib_adj, <span class="at">mode=</span><span class="st">&quot;undirected&quot;</span>, <span class="at">diag=</span><span class="cn">FALSE</span>)</span>
<span id="cb210-9"><a href="quantifying-uncertainty.html#cb210-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Betweenness Centrality</span></span>
<span id="cb210-10"><a href="quantifying-uncertainty.html#cb210-10" aria-hidden="true" tabindex="-1"></a>bw_all <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">betweenness</span>(bib_net)</span>
<span id="cb210-11"><a href="quantifying-uncertainty.html#cb210-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb210-12"><a href="quantifying-uncertainty.html#cb210-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot network with nodes scaled based on betweenness</span></span>
<span id="cb210-13"><a href="quantifying-uncertainty.html#cb210-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">346</span>)</span>
<span id="cb210-14"><a href="quantifying-uncertainty.html#cb210-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(bib_net, <span class="at">layout =</span> <span class="st">&quot;fr&quot;</span>) <span class="sc">+</span></span>
<span id="cb210-15"><a href="quantifying-uncertainty.html#cb210-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link0</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb210-16"><a href="quantifying-uncertainty.html#cb210-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="fu">aes</span>(<span class="at">size =</span> bw_all<span class="sc">*</span><span class="dv">5</span>), <span class="at">fill=</span><span class="st">&#39;gray&#39;</span>, <span class="at">alpha=</span><span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb210-17"><a href="quantifying-uncertainty.html#cb210-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()<span class="sc">+</span></span>
<span id="cb210-18"><a href="quantifying-uncertainty.html#cb210-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-63-1.png" width="672" /></p>
<p>With these network objects created we then need to modify our “nodes_missing_at_random_bw” function from above to the specific nature of our question and these data. Indeed since our example here relies on an incidence matrix that includes information defined across multiple publications, we have to me additional changes to the structure of that function.</p>
<p>We create a “nodes_missing_biased_bw” function below that requires five specific pieces of information from the user.</p>
<ul>
<li>net - You must include a network object in igraph format. The current version expects a simple network but the code could be modified for other types.</li>
<li>inc - You must also include an incidence matrix (as an R matrix object) which describes the relationships between publications and authors</li>
<li>nsim - You must specify the number of simulations to perform. The default is 1000.</li>
<li>props - Finally, you must specify the proportion of nodes to be retained for each set of nsim runs. This should be provided as a vector of proportions ranging from &gt; 0 to 1. By default, the script will calculate a 90% sub-sample all the way down to a 10% sub-sample at 10% intervals using props=c(0.9,0.8,0.7,0.6,0.5,0.4,0.3,0.2,0.1).</li>
<li>lookup_dat - Finally, you must provide the lookup data which connects the publication key code to the year as that is the basis of our simulation. Note that this function is designed to work with a lookup file that has column names exactly as shown here (“Publication.Year”, “prob”, “Key”) and this would need to be modified to work with data with different columns.</li>
</ul>
<p>The first step is to create a new column in the lookup file called “prob” that defines the probability that a node will be retained in each random sub-sample. To do this we simply take the vector of publication years and rescale them such that the maximum value (most recent publication) equals 1 and older publications are less than 1. This will mean that older publications will more often be removed in our random sub-samples than newer ones.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="quantifying-uncertainty.html#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataframe of all unique combinations of publication code and year from attributes data</span></span>
<span id="cb211-2"><a href="quantifying-uncertainty.html#cb211-2" aria-hidden="true" tabindex="-1"></a>lookup <span class="ot">&lt;-</span> <span class="fu">unique</span>(bib[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)])</span>
<span id="cb211-3"><a href="quantifying-uncertainty.html#cb211-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign a probability for a publication to be retained inverse to the year it was published</span></span>
<span id="cb211-4"><a href="quantifying-uncertainty.html#cb211-4" aria-hidden="true" tabindex="-1"></a>lookup<span class="sc">$</span>prob <span class="ot">&lt;-</span> (lookup<span class="sc">$</span>Publication.Year<span class="sc">-</span><span class="fu">min</span>(lookup<span class="sc">$</span>Publication.Year))<span class="sc">/</span></span>
<span id="cb211-5"><a href="quantifying-uncertainty.html#cb211-5" aria-hidden="true" tabindex="-1"></a>                (<span class="fu">max</span>(lookup<span class="sc">$</span>Publication.Year)<span class="sc">-</span><span class="fu">min</span>(lookup<span class="sc">$</span>Publication.Year))</span>
<span id="cb211-6"><a href="quantifying-uncertainty.html#cb211-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(lookup)</span></code></pre></div>
<pre><code>##         Key Publication.Year      prob
## 1  FUV8A7JK             2014 0.9583333
## 2  C7MRVHWA             2013 0.9375000
## 3  3EG6T4P6             1991 0.4791667
## 4  I3UPKTTM             2014 0.9583333
## 19 9ZVD38UW             2001 0.6875000
## 20 XRWFR6XU             1977 0.1875000</code></pre>
<p>Next we create a function that wraps all of this together. This is similar to the “nodes_missing_at_random_bw” function with a few key differences. Specifically:</p>
<ul>
<li>The line starting with “sub_samp” includes an additional argument “prob” which is assigned to the probability variable we created in the last step such that higher probability (newer) publications will be more likely to be retained.</li>
<li>Next, since the network of co-authorship includes connections that could be made by more than one publication we actually need to sub-sample from the incidence matrix. The line begining with “sub” finds all publications that were retained in the “sub_samp” object.</li>
<li>Next we convert “sub” to an adjacency matrix called “sub_adj” using matrix algebra and then a network object called “sub_net”</li>
<li>Finally, we calculate betweenness centrality and rank order correlations and put the results in the output object.</li>
</ul>
<p>Here we are going to run the function for nsim=1000 and for 3 sampling fractions (0.9, 0.8, 0.7).</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="quantifying-uncertainty.html#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function for assessing the impact of data missing due to biased process on betweenness centrality</span></span>
<span id="cb213-2"><a href="quantifying-uncertainty.html#cb213-2" aria-hidden="true" tabindex="-1"></a>nodes_missing_biased_bw <span class="ot">&lt;-</span> <span class="cf">function</span>(net, inc, <span class="at">nsim=</span><span class="dv">1000</span>, <span class="at">props=</span><span class="fu">c</span>(<span class="fl">0.9</span>,<span class="fl">0.8</span>,<span class="fl">0.7</span>,<span class="fl">0.6</span>,<span class="fl">0.5</span>,<span class="fl">0.4</span>,<span class="fl">0.3</span>,<span class="fl">0.2</span>,<span class="fl">0.1</span>), lookup_dat) {</span>
<span id="cb213-3"><a href="quantifying-uncertainty.html#cb213-3" aria-hidden="true" tabindex="-1"></a>  met_orig <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">betweenness</span>(net) <span class="co"># insert measure of interest here</span></span>
<span id="cb213-4"><a href="quantifying-uncertainty.html#cb213-4" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,nsim,<span class="fu">length</span>(props))</span>
<span id="cb213-5"><a href="quantifying-uncertainty.html#cb213-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(output) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(props)</span>
<span id="cb213-6"><a href="quantifying-uncertainty.html#cb213-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(props)) {</span>
<span id="cb213-7"><a href="quantifying-uncertainty.html#cb213-7" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim) {</span>
<span id="cb213-8"><a href="quantifying-uncertainty.html#cb213-8" aria-hidden="true" tabindex="-1"></a>        sub_samp <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(lookup_dat)), <span class="at">size=</span><span class="fu">round</span>(<span class="fu">nrow</span>(lookup_dat)<span class="sc">*</span>props[j], <span class="dv">0</span>), <span class="at">prob=</span>lookup_dat<span class="sc">$</span>prob) <span class="co"># added prob argument</span></span>
<span id="cb213-9"><a href="quantifying-uncertainty.html#cb213-9" aria-hidden="true" tabindex="-1"></a>        sub <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">rownames</span>(bib_dat) <span class="sc">%in%</span> lookup<span class="sc">$</span>Key[sub_samp]) </span>
<span id="cb213-10"><a href="quantifying-uncertainty.html#cb213-10" aria-hidden="true" tabindex="-1"></a>        sub_adj <span class="ot">&lt;-</span> <span class="fu">t</span>(inc[sub,]) <span class="sc">%*%</span> inc[sub,]</span>
<span id="cb213-11"><a href="quantifying-uncertainty.html#cb213-11" aria-hidden="true" tabindex="-1"></a>        sub_net <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">graph_from_adjacency_matrix</span>(sub_adj)</span>
<span id="cb213-12"><a href="quantifying-uncertainty.html#cb213-12" aria-hidden="true" tabindex="-1"></a>        temp_stats <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">betweenness</span>(sub_net) <span class="co"># insert measure of interest here (same as above)</span></span>
<span id="cb213-13"><a href="quantifying-uncertainty.html#cb213-13" aria-hidden="true" tabindex="-1"></a>        output[i,j] <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">cor</span>(temp_stats, met_orig, <span class="at">method=</span><span class="st">&#39;spearman&#39;</span>))</span>
<span id="cb213-14"><a href="quantifying-uncertainty.html#cb213-14" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb213-15"><a href="quantifying-uncertainty.html#cb213-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb213-16"><a href="quantifying-uncertainty.html#cb213-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb213-17"><a href="quantifying-uncertainty.html#cb213-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb213-18"><a href="quantifying-uncertainty.html#cb213-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-19"><a href="quantifying-uncertainty.html#cb213-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Run fuction</span></span>
<span id="cb213-20"><a href="quantifying-uncertainty.html#cb213-20" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4634</span>)</span>
<span id="cb213-21"><a href="quantifying-uncertainty.html#cb213-21" aria-hidden="true" tabindex="-1"></a>bib_bias <span class="ot">&lt;-</span> <span class="fu">nodes_missing_biased_bw</span>(<span class="at">net=</span>bib_net, <span class="at">inc=</span>bib_dat, <span class="at">lookup_dat=</span>lookup, <span class="at">props=</span><span class="fu">c</span>(<span class="fl">0.9</span>,<span class="fl">0.8</span>,<span class="fl">0.7</span>))</span>
<span id="cb213-22"><a href="quantifying-uncertainty.html#cb213-22" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(bib_bias)</span></code></pre></div>
<pre><code>##            0.9       0.8       0.7
## [1,] 0.9327931 0.9314217 0.8433757
## [2,] 0.9200489 0.9818085 0.7750152
## [3,] 0.9999088 0.9763457 0.9079782
## [4,] 1.0000000 0.9311525 0.7161128
## [5,] 0.9779243 0.8115974 0.8307865
## [6,] 0.9778791 0.9998792 0.7273099</code></pre>
<p>With this in place, we now need a function that deals with our incidence matrix data but simulates missigness at random. This only requires a single argument to change from our last function. Specifically, all we need to do is remove the “prob=lookup_dat$prob” argument from the line beginning with “sub_samp” and we’re ready to go.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="quantifying-uncertainty.html#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function for assessing the impact of nodes missing at random on betweenness centrality</span></span>
<span id="cb215-2"><a href="quantifying-uncertainty.html#cb215-2" aria-hidden="true" tabindex="-1"></a>nodes_missing_at_random_inc_bw <span class="ot">&lt;-</span> <span class="cf">function</span>(net, inc, <span class="at">nsim=</span><span class="dv">1000</span>, <span class="at">props=</span><span class="fu">c</span>(<span class="fl">0.9</span>,<span class="fl">0.8</span>,<span class="fl">0.7</span>,<span class="fl">0.6</span>,<span class="fl">0.5</span>,<span class="fl">0.4</span>,<span class="fl">0.3</span>,<span class="fl">0.2</span>,<span class="fl">0.1</span>), lookup_dat) {</span>
<span id="cb215-3"><a href="quantifying-uncertainty.html#cb215-3" aria-hidden="true" tabindex="-1"></a>  met_orig <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">betweenness</span>(net) <span class="co"># insert measure of interest here</span></span>
<span id="cb215-4"><a href="quantifying-uncertainty.html#cb215-4" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,nsim,<span class="fu">length</span>(props))</span>
<span id="cb215-5"><a href="quantifying-uncertainty.html#cb215-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(output) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(props)</span>
<span id="cb215-6"><a href="quantifying-uncertainty.html#cb215-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(props)) {</span>
<span id="cb215-7"><a href="quantifying-uncertainty.html#cb215-7" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim) {</span>
<span id="cb215-8"><a href="quantifying-uncertainty.html#cb215-8" aria-hidden="true" tabindex="-1"></a>        sub_samp <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(lookup_dat)), <span class="at">size=</span><span class="fu">round</span>(<span class="fu">nrow</span>(lookup_dat)<span class="sc">*</span>props[j], <span class="dv">0</span>)) <span class="co"># removed prob argument</span></span>
<span id="cb215-9"><a href="quantifying-uncertainty.html#cb215-9" aria-hidden="true" tabindex="-1"></a>        sub <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">rownames</span>(bib_dat) <span class="sc">%in%</span> lookup<span class="sc">$</span>Key[sub_samp])</span>
<span id="cb215-10"><a href="quantifying-uncertainty.html#cb215-10" aria-hidden="true" tabindex="-1"></a>        sub_adj <span class="ot">&lt;-</span> <span class="fu">t</span>(inc[sub,]) <span class="sc">%*%</span> inc[sub,]</span>
<span id="cb215-11"><a href="quantifying-uncertainty.html#cb215-11" aria-hidden="true" tabindex="-1"></a>        sub_net <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">graph_from_adjacency_matrix</span>(sub_adj)</span>
<span id="cb215-12"><a href="quantifying-uncertainty.html#cb215-12" aria-hidden="true" tabindex="-1"></a>        temp_stats <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">betweenness</span>(sub_net) <span class="co"># insert measure of interest here (same as above)</span></span>
<span id="cb215-13"><a href="quantifying-uncertainty.html#cb215-13" aria-hidden="true" tabindex="-1"></a>        output[i,j] <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">cor</span>(temp_stats, met_orig, <span class="at">method=</span><span class="st">&#39;spearman&#39;</span>))</span>
<span id="cb215-14"><a href="quantifying-uncertainty.html#cb215-14" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb215-15"><a href="quantifying-uncertainty.html#cb215-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb215-16"><a href="quantifying-uncertainty.html#cb215-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb215-17"><a href="quantifying-uncertainty.html#cb215-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb215-18"><a href="quantifying-uncertainty.html#cb215-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-19"><a href="quantifying-uncertainty.html#cb215-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the function</span></span>
<span id="cb215-20"><a href="quantifying-uncertainty.html#cb215-20" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4363</span>)</span>
<span id="cb215-21"><a href="quantifying-uncertainty.html#cb215-21" aria-hidden="true" tabindex="-1"></a>bib_rand <span class="ot">&lt;-</span> <span class="fu">nodes_missing_at_random_inc_bw</span>(<span class="at">net=</span>bib_net, <span class="at">inc=</span>bib_dat, <span class="at">lookup_dat=</span>lookup, <span class="at">props=</span><span class="fu">c</span>(<span class="fl">0.9</span>,<span class="fl">0.8</span>,<span class="fl">0.7</span>))</span>
<span id="cb215-22"><a href="quantifying-uncertainty.html#cb215-22" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(bib_rand)</span></code></pre></div>
<pre><code>##            0.9       0.8       0.7
## [1,] 0.9805339 0.9474142 0.8404082
## [2,] 0.9551694 0.9539318 0.8840402
## [3,] 0.9582099 0.8897556 0.9311734
## [4,] 0.9763482 0.8442237 0.7942490
## [5,] 0.8576312 0.8242232 0.8278691
## [6,] 1.0000000 0.8433042 0.8883410</code></pre>
<p>Now we can combine the results into a single dataframe and plot them as paired boxplots for comparison.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="quantifying-uncertainty.html#cb217-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">melt</span>(bib_rand) <span class="co"># convert wide data to long format</span></span>
<span id="cb217-2"><a href="quantifying-uncertainty.html#cb217-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">melt</span>(bib_bias) <span class="co"># convert wide data to long format</span></span>
<span id="cb217-3"><a href="quantifying-uncertainty.html#cb217-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-4"><a href="quantifying-uncertainty.html#cb217-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a variable denoting which sample it came from</span></span>
<span id="cb217-5"><a href="quantifying-uncertainty.html#cb217-5" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>Treatment <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;Random&quot;</span>, <span class="fu">nrow</span>(df1))</span>
<span id="cb217-6"><a href="quantifying-uncertainty.html#cb217-6" aria-hidden="true" tabindex="-1"></a>df2<span class="sc">$</span>Treatment <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;Biased&quot;</span>, <span class="fu">nrow</span>(df2))</span>
<span id="cb217-7"><a href="quantifying-uncertainty.html#cb217-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-8"><a href="quantifying-uncertainty.html#cb217-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Bind into a single dataframe, convert sampling faction to factor and change order of levels for plotting</span></span>
<span id="cb217-9"><a href="quantifying-uncertainty.html#cb217-9" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df1,df2)</span>
<span id="cb217-10"><a href="quantifying-uncertainty.html#cb217-10" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Var2 <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>Var2)</span>
<span id="cb217-11"><a href="quantifying-uncertainty.html#cb217-11" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Var2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>Var2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;0.9&quot;</span>, <span class="st">&quot;0.8&quot;</span>, <span class="st">&quot;0.7&quot;</span>))</span>
<span id="cb217-12"><a href="quantifying-uncertainty.html#cb217-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-13"><a href="quantifying-uncertainty.html#cb217-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb217-14"><a href="quantifying-uncertainty.html#cb217-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df) <span class="sc">+</span></span>
<span id="cb217-15"><a href="quantifying-uncertainty.html#cb217-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Var2, <span class="at">y=</span>value, <span class="at">fill=</span>Treatment)) <span class="sc">+</span></span>
<span id="cb217-16"><a href="quantifying-uncertainty.html#cb217-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;gray&quot;</span>)) <span class="sc">+</span></span>
<span id="cb217-17"><a href="quantifying-uncertainty.html#cb217-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Sub-Sample Size as Proportion of Original&quot;</span>) <span class="sc">+</span></span>
<span id="cb217-18"><a href="quantifying-uncertainty.html#cb217-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="st">&quot;Spearman&#39;s&quot;</span><span class="sc">~</span>rho)) <span class="sc">+</span></span>
<span id="cb217-19"><a href="quantifying-uncertainty.html#cb217-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb217-20"><a href="quantifying-uncertainty.html#cb217-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="dv">2</span>)),<span class="at">axis.text.y=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="dv">2</span>)),</span>
<span id="cb217-21"><a href="quantifying-uncertainty.html#cb217-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="dv">2</span>)),<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="dv">2</span>)),</span>
<span id="cb217-22"><a href="quantifying-uncertainty.html#cb217-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="dv">2</span>)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-67-1.png" width="672" /></p>
</div>
<div id="edge-probability-modeling" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> Edge Probability Modeling</h2>
<p>In this section we take inspiration from some recent work in the area of “Dark Networks” (see Everton 2012). In this field, a number of methods have recently been developed that allow us to more directly incorporate our assessments of the reliability of specific edges into our analysis. This can be done in a number of different ways. Perhaps the most common approach for networks based on data gathered from intelligence sources (such as studies of terrorist networks) is to qualitatively assign different levels of confidence to ties between pairs of actors using an ordinal scale determined based on the source of the information (reliable, usually reliable,… unreliable). This ordinal scale of confidence can then be converted into a probability (from 0 to 1) and that probability value could be used to inform the creation of a range of “possible” networks given the underlying data.</p>
<p>We are not aware of any archaeological examples where edges have been formally/qualitatively assigned “confidence levels” in exactly this way, but we think there are potential applications of this method. For example, we could define a network where we assign a low probability of a tie between two archaeological sites if they share an import from a third site/region and a higher probability for a tie between two sites if they share imports from each others region. Importantly, such methods can be used to combine information from different sources into a single assessment of the likelihood of connection.</p>
<p>Since we do not have any data structured in exactly this way, we will again simulate a small example and then analyze it. Let’s create a network with ties associated with “probabilities” and the plot it. We use the “rg_w” function within the tnet package to simulate a random weighted network in this way.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="quantifying-uncertainty.html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create random weighted network edgelist with weights from list</span></span>
<span id="cb218-2"><a href="quantifying-uncertainty.html#cb218-2" aria-hidden="true" tabindex="-1"></a>sim_edge <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">rg_w</span>(<span class="at">nodes=</span><span class="dv">20</span>,<span class="at">arcs=</span><span class="dv">80</span>,<span class="at">weights=</span><span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.6</span>,<span class="fl">0.8</span>,<span class="dv">1</span>),<span class="at">directed=</span>F,<span class="at">seed=</span><span class="dv">41267</span>))</span>
<span id="cb218-3"><a href="quantifying-uncertainty.html#cb218-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-4"><a href="quantifying-uncertainty.html#cb218-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create network object and assign edge weights and node names</span></span>
<span id="cb218-5"><a href="quantifying-uncertainty.html#cb218-5" aria-hidden="true" tabindex="-1"></a>sim_net <span class="ot">&lt;-</span> igraph<span class="sc">::</span> <span class="fu">graph_from_edgelist</span>(sim_edge[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb218-6"><a href="quantifying-uncertainty.html#cb218-6" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(sim_net)<span class="sc">$</span>weight <span class="ot">&lt;-</span> sim_edge[<span class="fu">order</span>(sim_edge[,<span class="dv">3</span>]),<span class="dv">3</span>]</span>
<span id="cb218-7"><a href="quantifying-uncertainty.html#cb218-7" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(sim_net)<span class="sc">$</span>name <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)</span>
<span id="cb218-8"><a href="quantifying-uncertainty.html#cb218-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-9"><a href="quantifying-uncertainty.html#cb218-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create color ramp palette</span></span>
<span id="cb218-10"><a href="quantifying-uncertainty.html#cb218-10" aria-hidden="true" tabindex="-1"></a>edge_cols <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&#39;gray&#39;</span>,<span class="st">&#39;darkblue&#39;</span>))(<span class="dv">5</span>)</span>
<span id="cb218-11"><a href="quantifying-uncertainty.html#cb218-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-12"><a href="quantifying-uncertainty.html#cb218-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the resulting network</span></span>
<span id="cb218-13"><a href="quantifying-uncertainty.html#cb218-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4364672</span>)</span>
<span id="cb218-14"><a href="quantifying-uncertainty.html#cb218-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(sim_net, <span class="at">layout =</span> <span class="st">&quot;fr&quot;</span>) <span class="sc">+</span></span>
<span id="cb218-15"><a href="quantifying-uncertainty.html#cb218-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link0</span>(<span class="fu">aes</span>(<span class="at">width =</span> <span class="fu">E</span>(sim_net)<span class="sc">$</span>weight<span class="sc">*</span><span class="dv">5</span>), <span class="at">edge_colour=</span>edge_cols[<span class="fu">E</span>(sim_net)<span class="sc">$</span>weight<span class="sc">*</span><span class="dv">5</span>], <span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb218-16"><a href="quantifying-uncertainty.html#cb218-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size=</span>igraph<span class="sc">::</span><span class="fu">degree</span>(sim_net)<span class="sc">+</span><span class="dv">3</span>, <span class="at">fill=</span><span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb218-17"><a href="quantifying-uncertainty.html#cb218-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">as.character</span>(name)), <span class="at">col=</span><span class="st">&#39;white&#39;</span>, <span class="at">size=</span><span class="fl">3.5</span>, <span class="at">repel=</span>F) <span class="sc">+</span></span>
<span id="cb218-18"><a href="quantifying-uncertainty.html#cb218-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-68-1.png" width="576" /></p>
<p>In the next chunk of code we define a function that iterates over every edge in the simulated network we just created and defines each edge as either present or absent using a simple random binomial with the probability set by the edge weight as described above. The output of this function (edge_liklihood) is a list object that contains “nsim” igraph network objects that are candidate networks of the original.</p>
<p>Next, in order to extract values of interest from these candidate networks, we created another function called “compile_stat” that could be modified for any measure of interest. This function iterates over all “nsim” networks in the “net_list” list object and calculates “degree” in this case returning the results as a simple matrix. It is then possible to compare things like average degree or the distribution of degree for particular nodes across all of the canddiate networks.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="quantifying-uncertainty.html#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define function for assessing and retaining edges based on edge weight probabilities</span></span>
<span id="cb219-2"><a href="quantifying-uncertainty.html#cb219-2" aria-hidden="true" tabindex="-1"></a>edge_prob <span class="ot">&lt;-</span> <span class="cf">function</span>(net, nsim) {</span>
<span id="cb219-3"><a href="quantifying-uncertainty.html#cb219-3" aria-hidden="true" tabindex="-1"></a>  net_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb219-4"><a href="quantifying-uncertainty.html#cb219-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim) {</span>
<span id="cb219-5"><a href="quantifying-uncertainty.html#cb219-5" aria-hidden="true" tabindex="-1"></a>    sub_set <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb219-6"><a href="quantifying-uncertainty.html#cb219-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ecount</span>(net)) {</span>
<span id="cb219-7"><a href="quantifying-uncertainty.html#cb219-7" aria-hidden="true" tabindex="-1"></a>      temp <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="at">prob=</span>sim_edge[j,<span class="dv">3</span>])</span>
<span id="cb219-8"><a href="quantifying-uncertainty.html#cb219-8" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (temp<span class="sc">==</span><span class="dv">1</span>) {sub_set <span class="ot">&lt;-</span> <span class="fu">c</span>(sub_set,j)}</span>
<span id="cb219-9"><a href="quantifying-uncertainty.html#cb219-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb219-10"><a href="quantifying-uncertainty.html#cb219-10" aria-hidden="true" tabindex="-1"></a>    net_list[[i]] <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">delete_edges</span>(net, <span class="fu">which</span>(<span class="sc">!</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">ecount</span>(net)) <span class="sc">%in%</span> sub_set)))</span>
<span id="cb219-11"><a href="quantifying-uncertainty.html#cb219-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb219-12"><a href="quantifying-uncertainty.html#cb219-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(net_list)</span>
<span id="cb219-13"><a href="quantifying-uncertainty.html#cb219-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb219-14"><a href="quantifying-uncertainty.html#cb219-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-15"><a href="quantifying-uncertainty.html#cb219-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Define function for assessing statistic of interest</span></span>
<span id="cb219-16"><a href="quantifying-uncertainty.html#cb219-16" aria-hidden="true" tabindex="-1"></a>compile_stat <span class="ot">&lt;-</span> <span class="cf">function</span>(net_list, nsim) {</span>
<span id="cb219-17"><a href="quantifying-uncertainty.html#cb219-17" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">length</span>(net_list),nsim)</span>
<span id="cb219-18"><a href="quantifying-uncertainty.html#cb219-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim) {</span>
<span id="cb219-19"><a href="quantifying-uncertainty.html#cb219-19" aria-hidden="true" tabindex="-1"></a>  out[,i] <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">degree</span>(net_list[[i]])} <span class="co"># degree could be changed to any other igraph function that outputs a vector of length vcount</span></span>
<span id="cb219-20"><a href="quantifying-uncertainty.html#cb219-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb219-21"><a href="quantifying-uncertainty.html#cb219-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now we run the edge_prob function for nsim=1000 and display a few candidate networks.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="quantifying-uncertainty.html#cb220-1" aria-hidden="true" tabindex="-1"></a>EL_test <span class="ot">&lt;-</span> <span class="fu">edge_prob</span>(sim_net, <span class="at">nsim=</span><span class="dv">1000</span>)</span>
<span id="cb220-2"><a href="quantifying-uncertainty.html#cb220-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-3"><a href="quantifying-uncertainty.html#cb220-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">9651</span>)</span>
<span id="cb220-4"><a href="quantifying-uncertainty.html#cb220-4" aria-hidden="true" tabindex="-1"></a>comp1 <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(EL_test[[<span class="dv">1</span>]], <span class="at">layout =</span> <span class="st">&quot;fr&quot;</span>) <span class="sc">+</span></span>
<span id="cb220-5"><a href="quantifying-uncertainty.html#cb220-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link0</span>(<span class="fu">aes</span>(<span class="at">width =</span> <span class="fu">E</span>(EL_test[[<span class="dv">1</span>]])<span class="sc">$</span>weight), <span class="at">edge_colour=</span>edge_cols[<span class="fu">E</span>(EL_test[[<span class="dv">1</span>]])<span class="sc">$</span>weight<span class="sc">*</span><span class="dv">5</span>], <span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb220-6"><a href="quantifying-uncertainty.html#cb220-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size=</span>igraph<span class="sc">::</span><span class="fu">degree</span>(sim_net), <span class="at">fill=</span><span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb220-7"><a href="quantifying-uncertainty.html#cb220-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">as.character</span>(name)), <span class="at">col=</span><span class="st">&#39;white&#39;</span>, <span class="at">size=</span><span class="fl">2.5</span>, <span class="at">repel=</span>F) <span class="sc">+</span></span>
<span id="cb220-8"><a href="quantifying-uncertainty.html#cb220-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span>
<span id="cb220-9"><a href="quantifying-uncertainty.html#cb220-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-10"><a href="quantifying-uncertainty.html#cb220-10" aria-hidden="true" tabindex="-1"></a>comp2 <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(EL_test[[<span class="dv">2</span>]], <span class="at">layout =</span> <span class="st">&quot;fr&quot;</span>) <span class="sc">+</span></span>
<span id="cb220-11"><a href="quantifying-uncertainty.html#cb220-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link0</span>(<span class="fu">aes</span>(<span class="at">width =</span> <span class="fu">E</span>(EL_test[[<span class="dv">2</span>]])<span class="sc">$</span>weight), <span class="at">edge_colour=</span>edge_cols[<span class="fu">E</span>(EL_test[[<span class="dv">2</span>]])<span class="sc">$</span>weight<span class="sc">*</span><span class="dv">5</span>], <span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb220-12"><a href="quantifying-uncertainty.html#cb220-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size=</span>igraph<span class="sc">::</span><span class="fu">degree</span>(sim_net), <span class="at">fill=</span><span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb220-13"><a href="quantifying-uncertainty.html#cb220-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">as.character</span>(name)), <span class="at">col=</span><span class="st">&#39;white&#39;</span>, <span class="at">size=</span><span class="fl">2.5</span>, <span class="at">repel=</span>F) <span class="sc">+</span></span>
<span id="cb220-14"><a href="quantifying-uncertainty.html#cb220-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span>
<span id="cb220-15"><a href="quantifying-uncertainty.html#cb220-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-16"><a href="quantifying-uncertainty.html#cb220-16" aria-hidden="true" tabindex="-1"></a>comp3 <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(EL_test[[<span class="dv">3</span>]], <span class="at">layout =</span> <span class="st">&quot;fr&quot;</span>) <span class="sc">+</span></span>
<span id="cb220-17"><a href="quantifying-uncertainty.html#cb220-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link0</span>(<span class="fu">aes</span>(<span class="at">width =</span> <span class="fu">E</span>(EL_test[[<span class="dv">3</span>]])<span class="sc">$</span>weight), <span class="at">edge_colour=</span>edge_cols[<span class="fu">E</span>(EL_test[[<span class="dv">3</span>]])<span class="sc">$</span>weight<span class="sc">*</span><span class="dv">5</span>], <span class="at">show.legend=</span>F) <span class="sc">+</span></span>
<span id="cb220-18"><a href="quantifying-uncertainty.html#cb220-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size=</span>igraph<span class="sc">::</span><span class="fu">degree</span>(sim_net), <span class="at">fill=</span><span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb220-19"><a href="quantifying-uncertainty.html#cb220-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">as.character</span>(name)), <span class="at">col=</span><span class="st">&#39;white&#39;</span>, <span class="at">size=</span><span class="fl">2.5</span>, <span class="at">repel=</span>F) <span class="sc">+</span></span>
<span id="cb220-20"><a href="quantifying-uncertainty.html#cb220-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span>
<span id="cb220-21"><a href="quantifying-uncertainty.html#cb220-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-22"><a href="quantifying-uncertainty.html#cb220-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(comp1, comp2, comp3)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-70-1.png" width="768" /></p>
<p>We then use the compile_stat function to assess degree centrality for one particular node, displaying a histogram of values with mean indicated.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="quantifying-uncertainty.html#cb221-1" aria-hidden="true" tabindex="-1"></a>dg_stat <span class="ot">&lt;-</span> <span class="fu">compile_stat</span>(EL_test, <span class="at">nsim=</span><span class="dv">1000</span>)</span>
<span id="cb221-2"><a href="quantifying-uncertainty.html#cb221-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-3"><a href="quantifying-uncertainty.html#cb221-3" aria-hidden="true" tabindex="-1"></a>dg_20 <span class="ot">&lt;-</span> dg_stat[<span class="dv">20</span>,]</span>
<span id="cb221-4"><a href="quantifying-uncertainty.html#cb221-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-5"><a href="quantifying-uncertainty.html#cb221-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">val =</span> dg_20) <span class="sc">%&gt;%</span></span>
<span id="cb221-6"><a href="quantifying-uncertainty.html#cb221-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ggplot</span>(., <span class="fu">aes</span>(val)) <span class="sc">+</span> </span>
<span id="cb221-7"><a href="quantifying-uncertainty.html#cb221-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb221-8"><a href="quantifying-uncertainty.html#cb221-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">xlab</span>(<span class="st">&quot;Degree Centrality of Node 20&quot;</span>) <span class="sc">+</span></span>
<span id="cb221-9"><a href="quantifying-uncertainty.html#cb221-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(dg_20), <span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-71-1.png" width="672" /></p>
</div>
<div id="small-or-variable-sample-size" class="section level2" number="5.6">
<h2><span class="header-section-number">5.6</span> Small or Variable Sample Size</h2>
<p>This section follows Brughmans and Peeples (2022) Chapter 5.3.5 to provide an example of how you can use the simulation approach outlined here to assess sampling variability in the data underlying archaeological networks. In this example, we use apportioned ceramic frequency data from the Chaco World portion of the Southwest Social Networks database. You can <a href="data/AD1050cer.csv">download the data here</a> to follow along.</p>
<p>The goal of this sub-section is to illustrate how you can use a bootstrappping approach to assess variability in network properties based on sampling error in the raw data underlying archaeological networks. In our example based on ceramic similarity networks here this involves creating a large number of random replicates of each row of our raw ceramic data with sample size held constant (as the observed sample size for that site) and with the probabilities that a given sherd will be a given type determined by the underlying multinomial frequency distribition of types at that site. In other words, we pull a bunch of random samples from the site with the probability that a given sample is a given type determined by the relative frequency of that type in the actual data. Once this procedure has been completed, we can then assess centrality metrics or any other graph, node, or edge level property and determine the degree to which absolute values and relative ranks are potentially influenced by sampling error.</p>
<p>There are many ways to set up such a resampling procedure and many complications (for example, how do we deal with limited diversity of small samples?). For the purposes of illustration here, we will implement a very simple procedure where we simply generate new samples of a fixed size based on our observed data and determine the degree to which our network measures are robust to this perturbation. In the chunk of code below we create 1000 replicates based on our original ceramic data.</p>
<p>The following chunk of code first reads in the ceramic data, converts it to a Brainerd-Robinson similarity matrix and then defines a function called “sampling_error_sim” which creates “nsim” random replciates of the ceramic data, converts them to similarity matrices, and ouputs those results as a list object.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="quantifying-uncertainty.html#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in raw ceramic data </span></span>
<span id="cb222-2"><a href="quantifying-uncertainty.html#cb222-2" aria-hidden="true" tabindex="-1"></a>ceramic <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">&quot;data/AD1050cer.csv&quot;</span>, <span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">row.names=</span><span class="dv">1</span>)</span>
<span id="cb222-3"><a href="quantifying-uncertainty.html#cb222-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to proportion</span></span>
<span id="cb222-4"><a href="quantifying-uncertainty.html#cb222-4" aria-hidden="true" tabindex="-1"></a>ceramic_p <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(<span class="fu">as.matrix</span>(ceramic), <span class="at">margin =</span> <span class="dv">1</span>) </span>
<span id="cb222-5"><a href="quantifying-uncertainty.html#cb222-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to Brainerd-Robinson similarity matrix</span></span>
<span id="cb222-6"><a href="quantifying-uncertainty.html#cb222-6" aria-hidden="true" tabindex="-1"></a>ceramic_BR <span class="ot">&lt;-</span> (<span class="dv">2</span><span class="sc">-</span><span class="fu">as.matrix</span>(vegan<span class="sc">::</span><span class="fu">vegdist</span>(ceramic_p, <span class="at">method=</span><span class="st">&#39;manhattan&#39;</span>)))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb222-7"><a href="quantifying-uncertainty.html#cb222-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-8"><a href="quantifying-uncertainty.html#cb222-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create function for assessing impact of sampling error on weighted degree for similarity network</span></span>
<span id="cb222-9"><a href="quantifying-uncertainty.html#cb222-9" aria-hidden="true" tabindex="-1"></a>sampling_error_sim <span class="ot">&lt;-</span> <span class="cf">function</span>(cer, <span class="at">nsim=</span><span class="dv">1000</span>) {</span>
<span id="cb222-10"><a href="quantifying-uncertainty.html#cb222-10" aria-hidden="true" tabindex="-1"></a>    sim_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb222-11"><a href="quantifying-uncertainty.html#cb222-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim) {</span>
<span id="cb222-12"><a href="quantifying-uncertainty.html#cb222-12" aria-hidden="true" tabindex="-1"></a>    data_sim <span class="ot">&lt;-</span>  <span class="cn">NULL</span></span>
<span id="cb222-13"><a href="quantifying-uncertainty.html#cb222-13" aria-hidden="true" tabindex="-1"></a>      <span class="co"># the for-loop below creates a random multinomial replicate of the ceramic data</span></span>
<span id="cb222-14"><a href="quantifying-uncertainty.html#cb222-14" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(cer)) {</span>
<span id="cb222-15"><a href="quantifying-uncertainty.html#cb222-15" aria-hidden="true" tabindex="-1"></a>        data_sim <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data_sim,<span class="fu">t</span>(<span class="fu">rmultinom</span>(<span class="dv">1</span>,<span class="fu">rowSums</span>(cer)[j],<span class="at">prob=</span>cer[j,])))</span>
<span id="cb222-16"><a href="quantifying-uncertainty.html#cb222-16" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb222-17"><a href="quantifying-uncertainty.html#cb222-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert simulated data to proportion, create similarity matrix, calculate degree, and assess correlation</span></span>
<span id="cb222-18"><a href="quantifying-uncertainty.html#cb222-18" aria-hidden="true" tabindex="-1"></a>    temp_p <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(<span class="fu">as.matrix</span>(data_sim), <span class="at">margin=</span><span class="dv">1</span>)</span>
<span id="cb222-19"><a href="quantifying-uncertainty.html#cb222-19" aria-hidden="true" tabindex="-1"></a>    sim_list[[i]] <span class="ot">&lt;-</span> (<span class="dv">2</span><span class="sc">-</span><span class="fu">as.matrix</span>(vegan<span class="sc">::</span><span class="fu">vegdist</span>(temp_p, <span class="at">method=</span><span class="st">&#39;manhattan&#39;</span>)))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb222-20"><a href="quantifying-uncertainty.html#cb222-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb222-21"><a href="quantifying-uncertainty.html#cb222-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sim_list)</span>
<span id="cb222-22"><a href="quantifying-uncertainty.html#cb222-22" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The following chunk of code runs the “sampling_error_sim” function defined above for our Chaco ceramic data and then defines a new fucntion called “sim_cor” which takes the output of “sampling_error_sim” and the original ceramic similarity matrix (ceramic_BR) and calculates weighted degree centrality and the Speraman’s <span class="math inline">\(\rho\)</span> correlations between the original similarity matrix and each random replicate. This “sim_cor” script could be modified to use any network metric that outputs a vector. Once these results are returned we visualize the results as a histogram.</p>
<p>Note that this could take several seconds to a few minutes depending on your computer.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="quantifying-uncertainty.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4634</span>)</span>
<span id="cb223-2"><a href="quantifying-uncertainty.html#cb223-2" aria-hidden="true" tabindex="-1"></a>sim_nets <span class="ot">&lt;-</span> <span class="fu">sampling_error_sim</span>(<span class="at">cer=</span>ceramic, <span class="at">nsim=</span><span class="dv">1000</span>)</span>
<span id="cb223-3"><a href="quantifying-uncertainty.html#cb223-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-4"><a href="quantifying-uncertainty.html#cb223-4" aria-hidden="true" tabindex="-1"></a>sim_cor <span class="ot">&lt;-</span> <span class="cf">function</span>(sim_nets, sim) {</span>
<span id="cb223-5"><a href="quantifying-uncertainty.html#cb223-5" aria-hidden="true" tabindex="-1"></a>  dg_orig <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(sim) <span class="co"># change this line to use a different metric</span></span>
<span id="cb223-6"><a href="quantifying-uncertainty.html#cb223-6" aria-hidden="true" tabindex="-1"></a>  dg_cor <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb223-7"><a href="quantifying-uncertainty.html#cb223-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sim_nets)) {</span>
<span id="cb223-8"><a href="quantifying-uncertainty.html#cb223-8" aria-hidden="true" tabindex="-1"></a>    dg_temp <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(sim_nets[[i]]) <span class="co"># change this line to use a different metric</span></span>
<span id="cb223-9"><a href="quantifying-uncertainty.html#cb223-9" aria-hidden="true" tabindex="-1"></a>    dg_cor[i] <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">cor</span>(dg_orig, dg_temp, <span class="at">method=</span><span class="st">&quot;spearman&quot;</span>))</span>
<span id="cb223-10"><a href="quantifying-uncertainty.html#cb223-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb223-11"><a href="quantifying-uncertainty.html#cb223-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(dg_cor)</span>
<span id="cb223-12"><a href="quantifying-uncertainty.html#cb223-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb223-13"><a href="quantifying-uncertainty.html#cb223-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-14"><a href="quantifying-uncertainty.html#cb223-14" aria-hidden="true" tabindex="-1"></a>dg_cor <span class="ot">&lt;-</span> <span class="fu">sim_cor</span>(sim_nets, ceramic_BR)</span>
<span id="cb223-15"><a href="quantifying-uncertainty.html#cb223-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-16"><a href="quantifying-uncertainty.html#cb223-16" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(dg_cor)</span>
<span id="cb223-17"><a href="quantifying-uncertainty.html#cb223-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-18"><a href="quantifying-uncertainty.html#cb223-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>dg_cor)) <span class="sc">+</span></span>
<span id="cb223-19"><a href="quantifying-uncertainty.html#cb223-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">100</span>, <span class="at">color=</span><span class="st">&#39;white&#39;</span>,<span class="at">fill=</span><span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb223-20"><a href="quantifying-uncertainty.html#cb223-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb223-21"><a href="quantifying-uncertainty.html#cb223-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name=</span><span class="st">&#39;Correlation in Degree Centraility&#39;</span>,<span class="at">limits=</span><span class="fu">c</span>(<span class="fl">0.9</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb223-22"><a href="quantifying-uncertainty.html#cb223-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.5</span>)),<span class="at">axis.text.y=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.5</span>)),</span>
<span id="cb223-23"><a href="quantifying-uncertainty.html#cb223-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.5</span>)),<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.5</span>)),</span>
<span id="cb223-24"><a href="quantifying-uncertainty.html#cb223-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.5</span>)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-73-1.png" width="672" /></p>
<p>As described in Chapter 5.3.5, in some cases we want to observe patterns of variation due to sampling error for individual sites or sets of sites. In the next chunk of code we illustrate how to produce figure 5.14 from the Brughmans and Peeples (2022) book. Specifically, this plot consists of a series of line plots where the x axis represents each node in the network ordered by degree centrality in the original observed network. For each node there is a vertical line which represents the 95% confidence interval around degree across the “nsim” random replicates produced to evaluate sampling error. The blue line represents degree in the original network and the red line represents median degree in the resampled networks.</p>
<p>To create this plot, we first iterate through every object in “sim_nets” and calculate weighted degree centrality and then add that to a two-column matrix along with a node id. Once we have done this for all simulations, we use the “summarise” function to calculate the Mean and</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="quantifying-uncertainty.html#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame containing degree and site id for nsim random similarity matrices</span></span>
<span id="cb224-2"><a href="quantifying-uncertainty.html#cb224-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="dv">1</span>,<span class="dv">2</span>) <span class="co"># define empty matrix</span></span>
<span id="cb224-3"><a href="quantifying-uncertainty.html#cb224-3" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate degree centrality for each random run and bind in matrix along with id</span></span>
<span id="cb224-4"><a href="quantifying-uncertainty.html#cb224-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sim_nets)) {</span>
<span id="cb224-5"><a href="quantifying-uncertainty.html#cb224-5" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(sim_nets[[i]])),<span class="fu">rowSums</span>(sim_nets[[i]]))</span>
<span id="cb224-6"><a href="quantifying-uncertainty.html#cb224-6" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df,temp)</span>
<span id="cb224-7"><a href="quantifying-uncertainty.html#cb224-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb224-8"><a href="quantifying-uncertainty.html#cb224-8" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(df[<span class="sc">-</span><span class="dv">1</span>,]) <span class="co"># remove first row in initial matrix</span></span>
<span id="cb224-9"><a href="quantifying-uncertainty.html#cb224-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;site&quot;</span>, <span class="st">&quot;degree&quot;</span>) <span class="co"># add column names</span></span>
<span id="cb224-10"><a href="quantifying-uncertainty.html#cb224-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-11"><a href="quantifying-uncertainty.html#cb224-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Use summarise function to create median, confidence intervals, and other statistics for degree by site.</span></span>
<span id="cb224-12"><a href="quantifying-uncertainty.html#cb224-12" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> df<span class="sc">%&gt;%</span></span>
<span id="cb224-13"><a href="quantifying-uncertainty.html#cb224-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(site)<span class="sc">%&gt;%</span> </span>
<span id="cb224-14"><a href="quantifying-uncertainty.html#cb224-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Mean=</span><span class="fu">mean</span>(degree), <span class="at">Median=</span><span class="fu">median</span>(degree), <span class="at">Max=</span><span class="fu">max</span>(degree), <span class="at">Min=</span><span class="fu">min</span>(degree), <span class="at">Conf=</span><span class="fu">sd</span>(degree)<span class="sc">*</span><span class="fl">1.96</span>) </span>
<span id="cb224-15"><a href="quantifying-uncertainty.html#cb224-15" aria-hidden="true" tabindex="-1"></a>out<span class="sc">$</span>site <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(out<span class="sc">$</span>site)</span>
<span id="cb224-16"><a href="quantifying-uncertainty.html#cb224-16" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> out[<span class="fu">order</span>(<span class="fu">rowSums</span>(ceramic_BR)),]</span>
<span id="cb224-17"><a href="quantifying-uncertainty.html#cb224-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-18"><a href="quantifying-uncertainty.html#cb224-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataframe of degree centrality for the original ceramic similarity matrix</span></span>
<span id="cb224-19"><a href="quantifying-uncertainty.html#cb224-19" aria-hidden="true" tabindex="-1"></a>dg_wt <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">rowSums</span>(ceramic_BR))</span>
<span id="cb224-20"><a href="quantifying-uncertainty.html#cb224-20" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dg_wt) <span class="ot">&lt;-</span> <span class="st">&quot;dg.wt&quot;</span></span>
<span id="cb224-21"><a href="quantifying-uncertainty.html#cb224-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-22"><a href="quantifying-uncertainty.html#cb224-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb224-23"><a href="quantifying-uncertainty.html#cb224-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb224-24"><a href="quantifying-uncertainty.html#cb224-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>out, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(site,Median), <span class="at">y=</span>Median, <span class="at">group=</span><span class="dv">1</span>), <span class="at">col=</span><span class="st">&#39;red&#39;</span>, <span class="at">lwd=</span><span class="fl">1.5</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb224-25"><a href="quantifying-uncertainty.html#cb224-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">data=</span>out, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(site,Median), <span class="at">ymin =</span> Median<span class="sc">-</span>Conf, <span class="at">ymax =</span> Median<span class="sc">+</span>Conf)) <span class="sc">+</span></span>
<span id="cb224-26"><a href="quantifying-uncertainty.html#cb224-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data=</span><span class="fu">sort</span>(dg_wt), <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">order</span>(dg.wt), <span class="at">y=</span>dg.wt), <span class="at">col=</span><span class="st">&#39;blue&#39;</span>, <span class="at">lwd=</span><span class="fl">1.5</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb224-27"><a href="quantifying-uncertainty.html#cb224-27" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb224-28"><a href="quantifying-uncertainty.html#cb224-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Degree&#39;</span>) <span class="sc">+</span></span>
<span id="cb224-29"><a href="quantifying-uncertainty.html#cb224-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name=</span><span class="st">&#39;Sites in Rank Order of Degree&#39;</span>) <span class="sc">+</span></span>
<span id="cb224-30"><a href="quantifying-uncertainty.html#cb224-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),<span class="at">axis.ticks.x=</span><span class="fu">element_blank</span>(), <span class="at">axis.text.y=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="dv">2</span>)),</span>
<span id="cb224-31"><a href="quantifying-uncertainty.html#cb224-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="dv">2</span>)),<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="dv">2</span>)),</span>
<span id="cb224-32"><a href="quantifying-uncertainty.html#cb224-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="dv">2</span>)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-74-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="exploratory-network-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="network-visualization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": null,
"position": "static"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
